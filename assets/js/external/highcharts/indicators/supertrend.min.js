"use strict";!function(e){"object"==typeof module&&module.exports?module.exports=e.default=e:"function"==typeof define&&define.amd?define("highcharts/indicators/supertrend",["highcharts","highcharts/modules/stock"],function(o){return e(o),e.Highcharts=o,e}):e("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(o){function e(o,e,t,r){o.hasOwnProperty(e)||(o[e]=r.apply(null,t),"function"==typeof CustomEvent&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:e,module:o[e]}})))}e(o=o?o._modules:{},"Stock/Indicators/Supertrend/SupertrendIndicator.js",[o["Core/Series/SeriesRegistry.js"],o["Core/Utilities.js"],o["Core/Chart/StockChart.js"]],function(o,e,t){function C(o,e,t){return{index:e,close:o.yData[e][t],x:o.xData[e]}}const{atr:T,sma:S}=o.seriesTypes,{addEvent:r,correctFloat:D,isArray:v,extend:n,merge:b,objectEach:j}=e;class i extends S{constructor(){super(...arguments),this.points=this.options=this.linkedParent=this.data=void 0}init(){const o=this,e=(super.init.apply(o,arguments),r(t,"afterLinkSeries",()=>{if(o.options){const e=o.options;e.cropThreshold=o.linkedParent.options.cropThreshold-(e.params.period-1)}e()},{order:1}))}drawGraph(){const t=this,o=t.options,e=t.linkedParent,r=e?e.points:[],n=t.points,i=t.graph;var s=0<(s=r.length-n.length)?s:0;const l={options:{gapSize:o.gapSize}},a={top:[],bottom:[],intersect:[]},p={top:{styles:{lineWidth:o.lineWidth,lineColor:o.fallingTrendColor||o.color,dashStyle:o.dashStyle}},bottom:{styles:{lineWidth:o.lineWidth,lineColor:o.risingTrendColor||o.color,dashStyle:o.dashStyle}},intersect:o.changeTrendLine};let d,c,h,u,g,y,x,f=n.length;for(;f--;){d=n[f],c=n[f-1],h=r[f-1+s],u=r[f-2+s];var m=r[f+s];g=r[f+s+1],y=d.options.color,x={x:d.x,plotX:d.plotX,plotY:d.plotY,isNull:!1},!u&&h&&e.yData[h.index-1]&&(u=C(e,h.index-1,3)),!g&&m&&e.yData[m.index+1]&&(g=C(e,m.index+1,3)),!h&&u&&e.yData[u.index+1]?h=C(e,u.index+1,3):!h&&m&&e.yData[m.index-1]&&(h=C(e,m.index-1,3)),d&&h&&m&&u&&d.x!==h.x&&(d.x===m.x?(u=h,h=m):d.x===u.x?(h=u,u={close:e.yData[h.index-1][3],x:e.xData[h.index-1]}):g&&d.x===g.x&&(h=g,u=m)),c&&u&&h?(m={x:c.x,plotX:c.plotX,plotY:c.plotY,isNull:!1},d.y>=h.close&&c.y>=u.close?(d.color=y||o.fallingTrendColor||o.color,a.top.push(x)):d.y<h.close&&c.y<u.close?(d.color=y||o.risingTrendColor||o.color,a.bottom.push(x)):(a.intersect.push(x),a.intersect.push(m),a.intersect.push(b(m,{isNull:!0})),d.y>=h.close&&c.y<u.close?(d.color=y||o.fallingTrendColor||o.color,c.color=y||o.risingTrendColor||o.color,a.top.push(x),a.top.push(b(m,{isNull:!0}))):d.y<h.close&&c.y>=u.close&&(d.color=y||o.risingTrendColor||o.color,c.color=y||o.fallingTrendColor||o.color,a.bottom.push(x),a.bottom.push(b(m,{isNull:!0}))))):h&&(d.y>=h.close?(d.color=y||o.fallingTrendColor||o.color,a.top.push(x)):(d.color=y||o.risingTrendColor||o.color,a.bottom.push(x)))}j(a,function(o,e){t.points=o,t.options=b(p[e].styles,l),t.graph=t["graph"+e+"Line"],S.prototype.drawGraph.call(t),t["graph"+e+"Line"]=t.graph}),t.points=n,t.options=o,t.graph=i}getValues(o,e){var t=e.period;e=e.multiplier;const r=o.xData,n=o.yData,i=[],s=[],l=[],a=0===t?0:t-1,p=[],d=[];let c,h,u,g,y,x,f,m;if(!(r.length<=t||!v(n[0])||4!==n[0].length||t<0)){for(o=T.prototype.getValues.call(this,o,{period:t}).yData,m=0;m<o.length;m++)f=n[a+m],x=n[a+m-1]||[],u=p[m-1],g=d[m-1],y=l[m-1],0===m&&(u=g=y=0),t=D((f[1]+f[2])/2+e*o[m]),c=D((f[1]+f[2])/2-e*o[m]),p[m]=t<u||x[3]>u?t:u,d[m]=c>g||x[3]<g?c:g,y===u&&f[3]<p[m]||y===g&&f[3]<d[m]?h=p[m]:(y===u&&f[3]>p[m]||y===g&&f[3]>d[m])&&(h=d[m]),i.push([r[a+m],h]),s.push(r[a+m]),l.push(h);return{values:i,xData:s,yData:l}}}}return i.defaultOptions=b(S.defaultOptions,{params:{index:void 0,multiplier:3,period:10},risingTrendColor:"#06b535",fallingTrendColor:"#f21313",changeTrendLine:{styles:{lineWidth:1,lineColor:"#333333",dashStyle:"LongDash"}}}),n(i.prototype,{nameBase:"Supertrend",nameComponents:["multiplier","period"]}),o.registerSeriesType("supertrend",i),i}),e(o,"masters/indicators/supertrend.src.js",[],function(){})});