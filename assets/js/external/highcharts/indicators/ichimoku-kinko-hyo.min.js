!function(t){"object"==typeof module&&module.exports?module.exports=t.default=t:"function"==typeof define&&define.amd?define("highcharts/indicators/ichimoku-kinko-hyo",["highcharts","highcharts/modules/stock"],function(o){return t(o),t.Highcharts=o,t}):t("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(o){function t(o,t,n,e){o.hasOwnProperty(t)||(o[t]=e.apply(null,n),"function"==typeof CustomEvent&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:t,module:o[t]}})))}t(o=o?o._modules:{},"Stock/Indicators/IKH/IKHIndicator.js",[o["Extensions/DataGrouping/ApproximationRegistry.js"],o["Core/Color/Color.js"],o["Core/Series/SeriesRegistry.js"],o["Core/Utilities.js"]],function(i,o,A,t){function m(o){return{high:o.reduce(function(o,t){return Math.max(o,t[1])},-1/0),low:o.reduce(function(o,t){return Math.min(o,t[2])},1/0)}}function C(o){var t=o.indicator;t.points=o.points,t.nextPoints=o.nextPoints,t.color=o.color,t.options=P(o.options.senkouSpan.styles,o.gap),t.graph=o.graph,t.fillGraph=!0,A.seriesTypes.sma.prototype.drawGraph.call(t)}var e,n,p=this&&this.__extends||(e=function(o,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var n in t)t.hasOwnProperty(n)&&(o[n]=t[n])})(o,t)},function(o,t){function n(){this.constructor=o}e(o,t),o.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=o.parse,r=A.seriesTypes.sma,x=t.defined,Y=(o=t.extend,t.isArray),a=t.isNumber,P=t.merge,B=t.objectEach;function l(){var o=null!==n&&n.apply(this,arguments)||this;return o.data=[],o.options={},o.points=[],o.graphCollection=[],o}return p(l,n=r),l.prototype.init=function(){n.prototype.init.apply(this,arguments),this.options=P({tenkanLine:{styles:{lineColor:this.color}},kijunLine:{styles:{lineColor:this.color}},chikouLine:{styles:{lineColor:this.color}},senkouSpanA:{styles:{lineColor:this.color,fill:s(this.color).setOpacity(.5).get()}},senkouSpanB:{styles:{lineColor:this.color,fill:s(this.color).setOpacity(.5).get()}},senkouSpan:{styles:{fill:s(this.color).setOpacity(.2).get()}}},this.options)},l.prototype.toYData=function(o){return[o.tenkanSen,o.kijunSen,o.chikouSpan,o.senkouSpanA,o.senkouSpanB]},l.prototype.translate=function(){A.seriesTypes.sma.prototype.translate.apply(this);for(var o=0,t=this.points;o<t.length;o++)for(var n=t[o],e=0,i=this.pointArrayMap;e<i.length;e++){var p=i[e],s=n[p];a(s)&&(n["plot"+p]=this.yAxis.toPixels(s,!0),n.plotY=n["plot"+p],n.tooltipPos=[n.plotX,n["plot"+p]],n.isNull=!1)}},l.prototype.drawGraph=function(){var n,o,e=this,t=e.points,i=e.options,p=e.graph,s=e.color,r={options:{gapSize:i.gapSize}},a=e.pointArrayMap.length,l=[[],[],[],[],[],[]],h={tenkanLine:l[0],kijunLine:l[1],chikouLine:l[2],senkouSpanA:l[3],senkouSpanB:l[4],senkouSpan:l[5]},u=[],c=(k=e.options.senkouSpan).color||k.styles.fill,f=k.negativeColor,g=[[],[]],d=[[],[]],k=t.length,y=0;for(e.ikhMap=h;k--;){for(var S=t[k],v=0;v<a;v++){var m=e.pointArrayMap[v];x(S[m])&&l[v].push({plotX:S.plotX,plotY:S["plot"+m],isNull:!1})}f&&k!==t.length-1&&(m=h.senkouSpanB.length-1,S=function(o,t,n,e){if(o&&t&&n&&e){var i=t.plotX-o.plotX,p=(t=t.plotY-o.plotY,e.plotX-n.plotX),s=(e=e.plotY-n.plotY,o.plotX-n.plotX),r=o.plotY-n.plotY;if(n=(-t*s+i*r)/(-p*t+i*e),p=(p*r-e*s)/(-p*t+i*e),0<=n&&n<=1&&0<=p&&p<=1)return{plotX:o.plotX+p*i,plotY:o.plotY+p*t}}}(h.senkouSpanA[m-1],h.senkouSpanA[m],h.senkouSpanB[m-1],h.senkouSpanB[m]))&&(S={plotX:S.plotX,plotY:S.plotY,isNull:!1,intersectPoint:!0},h.senkouSpanA.splice(m,0,S),h.senkouSpanB.splice(m,0,S),u.push(m))}if(B(h,function(o,t){i[t]&&"senkouSpan"!==t&&(e.points=l[y],e.options=P(i[t].styles,r),e.graph=e["graph"+t],e.fillGraph=!1,e.color=s,A.seriesTypes.sma.prototype.drawGraph.call(e),e["graph"+t]=e.graph),y++}),e.graphCollection)for(a=0,k=e.graphCollection;a<k.length;a++)m=k[a],e[m].destroy(),delete e[m];if(e.graphCollection=[],f&&h.senkouSpanA[0]&&h.senkouSpanB[0]){for(u.unshift(0),u.push(h.senkouSpanA.length-1),k=0;k<u.length-1;k++){if(m=u[k],S=u[k+1],a=h.senkouSpanB.slice(m,S+1),m=h.senkouSpanA.slice(m,S+1),1<=Math.floor(a.length/2))if(a[S=Math.floor(a.length/2)].plotY===m[S].plotY){for(o=v=S=0;o<a.length;o++)S+=a[o].plotY,v+=m[o].plotY;S=v<S?0:1}else S=a[S].plotY>m[S].plotY?0:1;else S=a[0].plotY>m[0].plotY?0:1;g[S]=g[S].concat(a),d[S]=d[S].concat(m)}["graphsenkouSpanColor","graphsenkouSpanNegativeColor"].forEach(function(o,t){g[t].length&&d[t].length&&(n=0===t?c:f,C({indicator:e,points:g[t],nextPoints:d[t],color:n,options:i,gap:r,graph:e[o]}),e[o]=e.graph,e.graphCollection.push(o))})}else C({indicator:e,points:h.senkouSpanB,nextPoints:h.senkouSpanA,color:c,options:i,gap:r,graph:e.graphsenkouSpan}),e.graphsenkouSpan=e.graph;delete e.nextPoints,delete e.fillGraph,e.points=t,e.options=i,e.graph=p,e.color=s},l.prototype.getGraphPath=function(o){var t=[];if(o=o||this.points,this.fillGraph&&this.nextPoints){if((n=A.seriesTypes.sma.prototype.getGraphPath.call(this,this.nextPoints))&&n.length){n[0][0]="L";for(var n,t=A.seriesTypes.sma.prototype.getGraphPath.call(this,o),e=(n=n.slice(0,t.length)).length-1;0<=e;e--)t.push(n[e])}}else t=A.seriesTypes.sma.prototype.getGraphPath.apply(this,arguments);return t},l.prototype.getValues=function(o,t){var n,e,i,p,s=t.period,r=t.periodTenkan,a=(t=t.periodSenkouSpanB,o.xData),l=o.yData,h=l&&l.length||0,u=(o.xAxis.series.forEach(function(o){if(o.xData)for(i=o.xData,p=o.xIncrement?1:i.length-1;0<p;p--)e=i[p]-i[p-1],(void 0===n||e<n)&&(n=e)}),o=n,[]),c=[];if(!(a.length<=s)&&Y(l[0])&&4===l[0].length){for(var f=a[0]-s*o,g=0;g<s;g++)c.push(f+g*o);for(g=0;g<h;g++){r<=g&&(d=((d=m(d=l.slice(g-r,g))).high+d.low)/2),s<=g&&(y=(d+(k=((k=m(k=l.slice(g-s,g))).high+k.low)/2))/2),t<=g&&(S=((S=m(S=l.slice(g-t,g))).high+S.low)/2),f=l[g][3];var d,k,y,S,v=a[g];void 0===u[g]&&(u[g]=[]),void 0===u[g+s-1]&&(u[g+s-1]=[]),u[g+s-1][0]=d,u[g+s-1][1]=k,(u[g+s-1][2]=void 0)===u[g+1]&&(u[g+1]=[]),u[g+1][2]=f,g<=s&&(u[g+s-1][3]=void 0,u[g+s-1][4]=void 0),void 0===u[g+2*s-2]&&(u[g+2*s-2]=[]),u[g+2*s-2][3]=y,u[g+2*s-2][4]=S,c.push(v)}for(g=1;g<=s;g++)c.push(v+g*o);return{values:u,xData:c,yData:u}}},l.defaultOptions=P(r.defaultOptions,{params:{index:void 0,period:26,periodTenkan:9,periodSenkouSpanB:52},marker:{enabled:!1},tooltip:{pointFormat:'<span style="color:{point.color}">‚óè</span> <b> {series.name}</b><br/>TENKAN SEN: {point.tenkanSen:.3f}<br/>KIJUN SEN: {point.kijunSen:.3f}<br/>CHIKOU SPAN: {point.chikouSpan:.3f}<br/>SENKOU SPAN A: {point.senkouSpanA:.3f}<br/>SENKOU SPAN B: {point.senkouSpanB:.3f}<br/>'},tenkanLine:{styles:{lineWidth:1,lineColor:void 0}},kijunLine:{styles:{lineWidth:1,lineColor:void 0}},chikouLine:{styles:{lineWidth:1,lineColor:void 0}},senkouSpanA:{styles:{lineWidth:1,lineColor:void 0}},senkouSpanB:{styles:{lineWidth:1,lineColor:void 0}},senkouSpan:{styles:{fill:"rgba(255, 0, 0, 0.5)"}},dataGrouping:{approximation:"ichimoku-averages"}}),o((t=l).prototype,{pointArrayMap:["tenkanSen","kijunSen","chikouSpan","senkouSpanA","senkouSpanB"],pointValKey:"tenkanSen",nameComponents:["periodSenkouSpanB","period","periodTenkan"]}),i["ichimoku-averages"]=function(){var n,e=[];return[].forEach.call(arguments,function(o,t){e.push(i.average(o)),n=!n&&void 0===e[t]}),n?void 0:e},A.registerSeriesType("ikh",t),t}),t(o,"masters/indicators/ichimoku-kinko-hyo.src.js",[],function(){})});