!function(t){"object"==typeof module&&module.exports?module.exports=t.default=t:"function"==typeof define&&define.amd?define("highcharts/modules/sankey",["highcharts"],function(e){return t(e),t.Highcharts=e,t}):t("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(e){"use strict";e=e?e._modules:{};function t(e,t,o,i){e.hasOwnProperty(t)||(e[t]=i.apply(null,o),"function"==typeof CustomEvent&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:t,module:e[t]}})))}t(e,"Series/NodesComposition.js",[e["Core/Series/SeriesRegistry.js"],e["Core/Utilities.js"]],function(e,t){var o;let{prototype:i,prototype:{pointClass:{prototype:a}}}=e["series"],{defined:s,extend:r,find:l,merge:d,pick:h}=t;return(e=o=o||{}).compose=function(e,t){let o=e.prototype,i=t.prototype;return o.setNodeState=c,o.setState=c,o.update=u,i.destroy=n,i.setData=p,t},e.createNode=function(e){let t=this.pointClass,o=(e,t)=>l(e,e=>e.id===t),i=o(this.nodes,e),n;if(!i){n=this.options.nodes&&o(this.options.nodes,e);let s=new t(this,r({className:"highcharts-node",isNode:!0,id:e,y:1},n));s.linksTo=[],s.linksFrom=[],s.getSum=function(){let t=0,o=0;return s.linksTo.forEach(e=>{t+=e.weight||0}),s.linksFrom.forEach(e=>{o+=e.weight||0}),Math.max(t,o)},s.offset=function(t,o){let i=0;for(let e=0;e<s[o].length;e++){if(s[o][e]===t)return i;i+=s[o][e].weight}},s.hasShape=function(){let t=0;return s.linksTo.forEach(e=>{e.outgoing&&t++}),!s.linksTo.length||t!==s.linksTo.length},s.index=this.nodes.push(s)-1,i=s}return i.formatPrefix="node",i.name=i.name||i.options.id||"",i.mass=h(i.options.mass,i.options.marker&&i.options.marker.radius,this.options.marker&&this.options.marker.radius,4),i},e.destroy=n,e.generatePoints=function(){let t=this.chart,o={};i.generatePoints.call(this),this.nodes||(this.nodes=[]),this.colorCounter=0,this.nodes.forEach(e=>{e.linksFrom.length=0,e.linksTo.length=0,e.level=e.options.level}),this.points.forEach(e=>{s(e.from)&&(o[e.from]||(o[e.from]=this.createNode(e.from)),o[e.from].linksFrom.push(e),e.fromNode=o[e.from],t.styledMode?e.colorIndex=h(e.options.colorIndex,o[e.from].colorIndex):e.color=e.options.color||o[e.from].color),s(e.to)&&(o[e.to]||(o[e.to]=this.createNode(e.to)),o[e.to].linksTo.push(e),e.toNode=o[e.to]),e.name=e.name||e.id},this),this.nodeLookup=o},e.setNodeState=c,e.updateNode=u,o;function n(){return this.data=[].concat(this.points||[],this.nodes),i.destroy.apply(this,arguments)}function p(){this.nodes&&(this.nodes.forEach(e=>{e.destroy()}),this.nodes.length=0),i.setData.apply(this,arguments)}function c(e){let t=arguments,o=this.isNode?this.linksTo.concat(this.linksFrom):[this.fromNode,this.toNode];"select"!==e&&o.forEach(e=>{e&&e.series&&(a.setState.apply(e,t),e.isNode||(e.fromNode.graphic&&a.setState.apply(e.fromNode,t),e.toNode&&e.toNode.graphic&&a.setState.apply(e.toNode,t)))}),a.setState.apply(this,t)}function u(e,t,o,i){let s=this.series.options.nodes,n=this.series.options.data,r=n&&n.length||0,l=n&&n[this.index];a.update.call(this,e,!this.isNode&&t,o,i),this.isNode&&(e=(s||[]).reduce((e,t,o)=>this.id===t.id?o:e,-1),i=d(s&&s[e]||{},n&&n[this.index]||{}),n&&(l?n[this.index]=l:n.length=r),s?0<=e?s[e]=i:s.push(i):this.series.options.nodes=[i],h(t,!0)&&this.series.chart.redraw(o))}}),t(e,"Series/Sankey/SankeyPoint.js",[e["Core/Series/Point.js"],e["Core/Series/SeriesRegistry.js"],e["Core/Utilities.js"]],function(o,e,t){let i=e.seriesTypes["column"],s=t["defined"];class n extends i.prototype.pointClass{applyOptions(e,t){return o.prototype.applyOptions.call(this,e,t),s(this.options.level)&&(this.options.column=this.column=this.options.level),this}getClassName(){return(this.isNode?"highcharts-node ":"highcharts-link ")+o.prototype.getClassName.call(this)}getFromNode(){let t=-1,o;for(let e=0;e<this.linksTo.length;e++){var i=this.linksTo[e];i.fromNode.column>t&&i.fromNode!==this&&(t=(o=i.fromNode).column)}return{fromNode:o,fromColumn:t}}setNodeColumn(){s(this.options.column)||(0===this.linksTo.length?this.column=0:this.column=this.getFromNode().fromColumn+1)}isValid(){return this.isNode||"number"==typeof this.weight}}return n}),t(e,"Series/Sankey/SankeySeriesDefaults.js",[],function(){return{borderWidth:0,colorByPoint:!0,curveFactor:.33,dataLabels:{enabled:!0,backgroundColor:"none",crop:!1,nodeFormat:void 0,nodeFormatter:function(){return this.point.name},format:void 0,formatter:function(){},inside:!0},inactiveOtherPoints:!0,linkColorMode:"from",linkOpacity:.5,opacity:1,minLinkWidth:0,nodeAlignment:"center",nodeWidth:20,nodePadding:10,nodeDistance:30,showInLegend:!1,states:{hover:{linkOpacity:1,opacity:1},inactive:{linkOpacity:.1,opacity:.1,animation:{duration:50}}},tooltip:{followPointer:!0,headerFormat:'<span style="font-size: 0.8em">{series.name}</span><br/>',pointFormat:"{point.fromNode.name} â†’ {point.toNode.name}: <b>{point.weight}</b><br/>",nodeFormat:"{point.name}: <b>{point.sum}</b><br/>"}}}),t(e,"Series/Sankey/SankeyColumnComposition.js",[e["Core/Utilities.js"]],function(e){var t;let{defined:c,relativeLength:u}=e;{(e=t=t||{}).compose=function(e,t){return e.sankeyColumn=new o(e,t),e};class o{constructor(e,t){this.points=e,this.series=t}getTranslationFactor(e){let t=this.points,o=t.slice(),i=e.chart,s=e.options.minLinkWidth||0,n,r=0,l,a=(i.plotSizeY||0)-(e.options.borderWidth||0)-(t.length-1)*e.nodePadding;for(;t.length;){for(r=a/t.sankeyColumn.sum(),n=!1,l=t.length;l--;)t[l].getSum()*r<s&&(t.splice(l,1),a=Math.max(0,a-s),n=!0);if(!n)break}for(var d of(t.length=0,o))t.push(d);return r}top(o){let i=this.series,s=i.nodePadding,e=this.points.reduce((e,t)=>(0<e&&(e+=s),e+=Math.max(t.getSum()*o,i.options.minLinkWidth||0)),0);return{top:0,center:.5,bottom:1}[i.options.nodeAlignment||"center"]*((i.chart.plotSizeY||0)-e)}left(o){let i=this.series,e=i.chart,s=i.options.equalNodes,n=e.inverted?e.plotHeight:e.plotWidth,r=i.nodePadding,t=this.points.reduce((e,t)=>(0<e&&(e+=r),e+=s?n/t.series.nodes.length-r:Math.max(t.getSum()*o,i.options.minLinkWidth||0)),0);return((e.plotSizeX||0)-Math.round(t))/2}sum(){return this.points.reduce((e,t)=>e+t.getSum(),0)}offset(t,o){let i=this.points,s=this.series,n=s.nodePadding,r=0,l;if(s.is("organization")&&t.hangsFrom)return{absoluteTop:t.hangsFrom.nodeY};for(let e=0;e<i.length;e++){var a=i[e].getSum(),d=Math.max(a*o,s.options.minLinkWidth||0),h=t.options[s.chart.inverted?"offsetHorizontal":"offsetVertical"],p=t.options.offset||0;if(l=a?d+n:0,i[e]===t)return{relativeTop:r+(c(h)?u(h,d):u(p,l))};r+=l}}}e.SankeyColumnAdditions=o}return t}),t(e,"Series/TreeUtilities.js",[e["Core/Color/Color.js"],e["Core/Utilities.js"]],function(v,e){let{extend:c,isArray:a,isNumber:d,isObject:h,merge:p,pick:k,relativeLength:s}=e;return{getColor:function(e,t){let o,i,s,n,r,l,a=t.index,d=t.mapOptionsToLevel,h=t.parentColor,p=t.parentColorIndex,c=t.series,u=t.colors,m=t.siblings,f=c.points,g=c.chart.options.chart;return e&&(o=f[e.i],i=d[e.level]||{},o&&i.colorByPoint&&(n=o.index%(u?u.length:g.colorCount),s=u&&u[n]),c.chart.styledMode||(r=k(o&&o.options.color,i&&i.color,s,h&&(e=h,(y=i&&i.colorVariation)&&"brightness"===y.key&&a&&m?v.parse(e).brighten(y.to*(a/m)).get():e),c.color)),l=k(o&&o.options.colorIndex,i&&i.colorIndex,n,p,t.colorIndex)),{color:r,colorIndex:l};var y},getLevelOptions:function(e){let n,t,o,r,i,s,l={};if(h(e))for(r=d(e.from)?e.from:1,s=e.levels,t={},n=h(e.defaults)?e.defaults:{},a(s)&&(t=s.reduce((e,t)=>{let o,i,s;return h(t)&&d(t.level)&&(i=k((s=p({},t)).levelIsConstant,n.levelIsConstant),delete s.levelIsConstant,delete s.level,h(e[o=t.level+(i?0:r-1)])?p(!0,e[o],s):e[o]=s),e},{})),i=d(e.to)?e.to:1,o=0;o<=i;o++)l[o]=p({},n,h(t[o])?t[o]:{});return l},getNodeWidth:function(e,t){var{chart:e,options:o}=e,{nodeDistance:o=0,nodeWidth:i=0}=o,{plotSizeX:e=1}=e;if("auto"!==i)return s(i,e);if("string"==typeof o&&/%$/.test(o))return e/(t+parseFloat(o)/100*(t-1));i=Number(o);return(e+i)/(t||1)-i},setTreeValues:function i(s,n){let e=n.before,t=n.idRoot,o=n.mapIdToNode[t],r=!1!==n.levelIsConstant,l=n.points[s.i],a=l&&l.options||{},d=[],h=0;s.levelDynamic=s.level-(r?0:o.level),s.name=k(l&&l.name,""),s.visible=t===s.id||!0===n.visible,(s="function"==typeof e?e(s,n):s).children.forEach((e,t)=>{var o=c({},n);c(o,{index:t,siblings:s.children.length,visible:s.visible}),e=i(e,o),d.push(e),e.visible&&(h+=e.val)});var p=k(a.value,h);return s.visible=0<=p&&(0<h||s.visible),s.children=d,s.childrenTotal=h,s.isLeaf=s.visible&&!h,s.val=p,s},updateRootId:function(e){let t,o;return h(e)&&(o=h(e.options)?e.options:{},t=k(e.rootNode,o.rootId,""),h(e.userOptions)&&(e.userOptions.rootId=t),e.rootNode=t),t}}}),t(e,"Series/Sankey/SankeySeries.js",[e["Core/Globals.js"],e["Series/NodesComposition.js"],e["Series/Sankey/SankeyPoint.js"],e["Series/Sankey/SankeySeriesDefaults.js"],e["Core/Series/SeriesRegistry.js"],e["Series/Sankey/SankeyColumnComposition.js"],e["Core/Color/Color.js"],e["Series/TreeUtilities.js"],e["Core/Utilities.js"]],function(e,t,o,i,s,n,d,r,l){let{column:a,line:h}=s.seriesTypes,Y=d["parse"],{getLevelOptions:p,getNodeWidth:c}=r,{clamp:u,crisp:m,extend:f,isObject:g,merge:y,pick:X,relativeLength:v,stableSort:k}=l;class C extends a{static getDLOptions(e){var t=g(e.optionsPoint)?e.optionsPoint.dataLabels:{};return y({style:{}},g(e.level)?e.level.dataLabels:{},t)}createNodeColumns(){let t=[];for(var e of this.nodes)e.setNodeColumn(),t[e.column]||(t[e.column]=n.compose([],this)),t[e.column].push(e);for(let e=0;e<t.length;e++)void 0===t[e]&&(t[e]=n.compose([],this));return t}order(e,t){if(void 0===e.level)for(var o of(e.level=t,e.linksFrom))o.toNode&&this.order(o.toNode,t+1)}generatePoints(){if(t.generatePoints.apply(this,arguments),this.orderNodes){for(var e of this.nodes)0===e.linksTo.length&&this.order(e,0);k(this.nodes,(e,t)=>e.level-t.level)}}getNodePadding(){let e=this.options.nodePadding||0;var t;return e=this.nodeColumns&&(t=this.nodeColumns.reduce((e,t)=>Math.max(e,t.length),0))*e>this.chart.plotSizeY?this.chart.plotSizeY/t:e}hasData(){return!!this.processedXData.length}pointAttribs(e,t){if(!e)return{};let o=this,i=(e.isNode?e:e.fromNode).level,s=o.mapOptionsToLevel[i||0]||{},n=e.options,r=s.states&&s.states[t||""]||{},l=["colorByPoint","borderColor","borderWidth","linkOpacity","opacity"].reduce((e,t)=>(e[t]=X(r[t],n[t],s[t],o.options[t]),e),{}),a=X(r.color,n.color,(l.colorByPoint?e:s).color);return e.isNode?{fill:a,stroke:l.borderColor,"stroke-width":l.borderWidth,opacity:l.opacity}:{fill:d.parse(a).setOpacity(l.linkOpacity).get()}}drawTracker(){a.prototype.drawTracker.call(this,this.points),a.prototype.drawTracker.call(this,this.nodes)}drawPoints(){a.prototype.drawPoints.call(this,this.points),a.prototype.drawPoints.call(this,this.nodes)}drawDataLabels(){a.prototype.drawDataLabels.call(this,this.points),a.prototype.drawDataLabels.call(this,this.nodes)}translate(){this.processedXData||this.processData(),this.generatePoints(),this.nodeColumns=this.createNodeColumns();let o=this,e=this.chart,t=this.options,i=this.nodeColumns,s=i.length;for(var n of(this.nodeWidth=c(this,s),this.nodePadding=this.getNodePadding(),this.translationFactor=i.reduce((e,t)=>Math.min(e,t.sankeyColumn.getTranslationFactor(o)),1/0),this.colDistance=(e.plotSizeX-this.nodeWidth-t.borderWidth)/Math.max(1,i.length-1),o.mapOptionsToLevel=p({from:1,levels:t.levels,to:i.length-1,defaults:{borderColor:t.borderColor,borderRadius:t.borderRadius,borderWidth:t.borderWidth,color:o.color,colorByPoint:t.colorByPoint,levelIsConstant:!0,linkColor:t.linkColor,linkLineWidth:t.linkLineWidth,linkOpacity:t.linkOpacity,states:t.states}}),i))for(var r of n)o.translateNode(r,n);for(var l of this.nodes)for(var a of l.linksFrom)(a.weight||a.isNull)&&a.to&&(o.translateLink(a),a.allowShadow=!1)}translateLink(o){let e=(e,t)=>{t=e.offset(o,t)*r;return Math.min(e.nodeY+t,e.nodeY+(e.shapeArgs&&e.shapeArgs.height||0)-c)},t=o.fromNode,i=o.toNode,s=this.chart,n=s["inverted"],r=this.translationFactor,l=this.options,a=X(o.linkColorMode,l.linkColorMode),d=(s.inverted?-this.colDistance:this.colDistance)*l.curveFactor,h=t.nodeX,p=i.nodeX,I=o.outgoing,c=Math.max(o.weight*r,this.options.minLinkWidth),u=e(t,"linksFrom"),m=e(i,"linksTo"),f=this.nodeWidth,g=p>h+f;var y,v,k,C,S,N,b,x,L,T,P,w,j,O,W,F,M,D,z;s.inverted&&(u=s.plotSizeY-u,m=(s.plotSizeY||0)-m,f=-f,c=-c,g=p<h),o.shapeType="path",o.linkBase=[u,u+c,m,m+c],g&&"number"==typeof m?o.shapeArgs={d:[["M",h+f,u],["C",h+f+d,u,p-d,m,p,m],["L",p+(I?f:0),m+c/2],["L",p,m+c],["C",p-d,m+c,h+f+d,u+c,h+f,u+c],["Z"]]}:"number"==typeof m&&(x=s.plotHeight-u-c,y=p-20-c,v=p-20,S=(C=(k=h+f)+20)+c,T=(L=(x=(b=(N=(D=u)+c)+20)+x)+20)+c,j=(w=(P=m)+c)+20,z=N-.7*c,O=L+.7*c,W=w-.7*c,F=p-.7*c,M=k+.7*c,o.shapeArgs={d:[["M",k,D],["C",M,D,S,z,S,b],["L",S,x],["C",S,O,M,T,k,T],["L",p,T],["C",F,T,y,O,y,x],["L",y,j],["C",y,W,F,P,p,P],["L",p,w],["C",v,w,v,w,v,j],["L",v,x],["C",v,L,v,L,p,L],["L",k,L],["C",C,L,C,L,C,x],["L",C,b],["C",C,N,C,N,k,N],["Z"]]}),o.dlBox={x:h+(p-h+f)/2,y:u+(m-u)/2,height:c,width:0},o.tooltipPos=s.inverted?[s.plotSizeY-o.dlBox.y-c/2,s.plotSizeX-o.dlBox.x]:[o.dlBox.x,o.dlBox.y+c/2],o.y=o.plotY=1,o.x=o.plotX=1,o.options.color||("from"===a?o.color=t.color:"to"===a?o.color=i.color:"gradient"===a&&(D=Y(t.color).get(),z=Y(i.color).get(),o.color={linearGradient:{x1:1,x2:0,y1:0,y2:0},stops:[[0,n?D:z],[1,n?z:D]]}))}translateNode(n,r){var e=this.translationFactor,l=this.chart,a=this.options,{borderRadius:d,borderWidth:t=0}=a,o=n.getSum(),h=Math.max(Math.round(o*e),this.options.minLinkWidth),p=Math.round(this.nodeWidth),c=r.sankeyColumn.offset(n,e),r=m(X(c.absoluteTop,r.sankeyColumn.top(e)+c.relativeTop),t),e=m(this.colDistance*n.column+t/2,t)+v(n.options[l.inverted?"offsetVertical":"offsetHorizontal"]||0,p),c=l.inverted?l.plotSizeX-e:e;if(n.sum=o){n.shapeType="roundedRect";let e=n.nodeX=c,t=n.nodeY=r,o=n.options.width||a.width||p,i=n.options.height||a.height||h,s=u(v("object"==typeof d?d.radius:d||0,o),0,h/2);l.inverted&&(e=c-p,t=l.plotSizeY-r-h,o=n.options.height||a.height||p,i=n.options.width||a.width||h),n.dlOptions=C.getDLOptions({level:this.mapOptionsToLevel[n.level],optionsPoint:n.options}),n.plotX=1,n.plotY=1,n.tooltipPos=l.inverted?[l.plotSizeY-t-i/2,l.plotSizeX-e-o/2]:[e+o/2,t+i/2],n.shapeArgs={x:e,y:t,width:o,height:i,r:s,display:n.hasShape()?"":"none"}}else n.dlOptions={enabled:!1}}}return C.defaultOptions=y(a.defaultOptions,i),t.compose(o,C),f(C.prototype,{animate:h.prototype.animate,createNode:t.createNode,forceDL:!0,invertible:!0,isCartesian:!1,orderNodes:!0,noSharedTooltip:!0,pointArrayMap:["from","to","weight"],pointClass:o,searchPoint:e.noop}),s.registerSeriesType("sankey",C),C}),t(e,"masters/modules/sankey.src.js",[e["Core/Globals.js"]],function(e){return e})});