!function(t){"object"==typeof module&&module.exports?module.exports=t.default=t:"function"==typeof define&&define.amd?define("highcharts/modules/treegraph",["highcharts","highcharts/modules/treemap"],function(e){return t(e),t.Highcharts=e,t}):t("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(e){"use strict";e=e?e._modules:{};function t(e,t,i,s){e.hasOwnProperty(t)||(e[t]=s.apply(null,i),"function"==typeof CustomEvent&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:t,module:e[t]}})))}t(e,"Series/PathUtilities.js",[],function(){function h(t,i){let s=[];for(let e=0;e<t.length;e++){var o,r,a,l,n,h,d=t[e][1],p=t[e][2];"number"==typeof d&&"number"==typeof p&&(0===e?s.push(["M",d,p]):e!==t.length-1&&i?(r=t[e-1],l=t[e+1],r&&l&&(o=r[1],r=r[2],a=l[1],l=l[2],"number"==typeof o&&"number"==typeof a&&"number"==typeof r&&"number"==typeof l&&o!==a&&r!==l&&(n=o<a?1:-1,h=r<l?1:-1,s.push(["L",d-n*Math.min(Math.abs(d-o),i),p-h*Math.min(Math.abs(p-r),i)],["C",d,p,d,p,d+n*Math.min(Math.abs(d-a),i),p+h*Math.min(Math.abs(p-l),i)])))):s.push(["L",d,p]))}return s}return{applyRadius:h,getLinkPath:{default:function(e){var{x1:e,y1:t,x2:i,y2:s,width:o=0,inverted:r=!1,radius:a,parentVisible:l}=e,n=[["M",e,t],["L",e,t],["C",e,t,e,s,e,s],["L",e,s],["C",e,t,e,s,e,s],["L",e,s]];return l?h([["M",e,t],["L",e+o*(r?-.5:.5),t],["L",e+o*(r?-.5:.5),s],["L",i,s]],a):n},straight:function(e){var{x1:e,y1:t,x2:i,y2:s,width:o=0,inverted:r=!1,parentVisible:a}=e;return a?[["M",e,t],["L",e+o*(r?-1:1),s],["L",i,s]]:[["M",e,t],["L",e,s],["L",e,s]]},curved:function(e){var{x1:e,y1:t,x2:i,y2:s,offset:o=0,width:r=0,inverted:a=!1,parentVisible:l}=e;return l?[["M",e,t],["C",e+o,t,e-o+r*(a?-1:1),s,e+r*(a?-1:1),s],["L",i,s]]:[["M",e,t],["C",e,t,e,s,e,s],["L",i,s]]}}}}),t(e,"Series/Treegraph/TreegraphNode.js",[e["Core/Series/SeriesRegistry.js"]],function(e){var{prototype:{NodeClass:e}}=e["seriesTypes"]["treemap"];return class extends e{constructor(){super(...arguments),this.mod=0,this.shift=0,this.change=0,this.children=[],this.preX=0,this.hidden=!1,this.wasVisited=!1,this.collapsed=!1}nextLeft(){return this.getLeftMostChild()||this.thread}nextRight(){return this.getRightMostChild()||this.thread}getAncestor(e,t){return e.ancestor.children[0]===this.children[0]?e.ancestor:t}getLeftMostSibling(){var e=this.getParent();if(e)for(var t of e.children)if(t&&t.point.visible)return t}hasChildren(){var t=this.children;for(let e=0;e<t.length;e++)if(t[e].point.visible)return!0;return!1}getLeftSibling(){var e=this.getParent();if(e){var t=e.children;for(let e=this.relativeXPosition-1;0<=e;e--)if(t[e]&&t[e].point.visible)return t[e]}}getLeftMostChild(){var t=this.children;for(let e=0;e<t.length;e++)if(t[e].point.visible)return t[e]}getRightMostChild(){var t=this.children;for(let e=t.length-1;0<=e;e--)if(t[e].point.visible)return t[e]}getParent(){return this.parentNode}getFirstChild(){var t=this.children;for(let e=0;e<t.length;e++)if(t[e].point.visible)return t[e]}}}),t(e,"Series/Treegraph/TreegraphPoint.js",[e["Core/Series/Point.js"],e["Core/Series/SeriesRegistry.js"],e["Core/Utilities.js"]],function(e,t,i){let{treemap:{prototype:{pointClass:s}}}=t["seriesTypes"],{addEvent:o,fireEvent:r,merge:u}=i;class a extends s{constructor(){super(...arguments),this.dataLabelOnHidden=!0,this.isLink=!1,this.setState=e.prototype.setState}draw(){super.draw.apply(this,arguments);let e=this.graphic;e&&e.animate({visibility:this.visible?"inherit":"hidden"}),this.renderCollapseButton()}renderCollapseButton(){let e=this.series,t=this.graphic&&this.graphic.parentGroup,i=e.mapOptionsToLevel[this.node.level||0]||{},s=u(e.options.collapseButton,i.collapseButton,this.options.collapseButton),{width:o,height:r,shape:a,style:l}=s,n=this.series.chart,h=!this.visible||!this.collapsed&&s.onlyOnHover&&"hover"!==this.state?0:1;var d,p,c;this.shapeArgs&&(this.collapseButtonOptions=s,this.collapseButton?this.node.children.length&&s.enabled?({x:d,y:p}=this.getCollapseBtnPosition(s),this.collapseButton.attr({text:this.collapsed?"+":"-",rotation:n.inverted?90:0,rotationOriginX:o/2,rotationOriginY:r/2,visibility:this.visible?"inherit":"hidden"}).animate({x:d,y:p,opacity:h})):(this.collapseButton.destroy(),delete this.collapseButton):this.node.children.length&&s.enabled&&({x:d,y:p}=this.getCollapseBtnPosition(s),c=s.fillColor||this.color||"#cccccc",this.collapseButton=n.renderer.label(this.collapsed?"+":"-",d,p,a).attr({height:r-4,width:o-4,padding:2,fill:c,rotation:n.inverted?90:0,rotationOriginX:o/2,rotationOriginY:r/2,stroke:s.lineColor||"#ffffff","stroke-width":s.lineWidth,"text-align":"center",align:"center",zIndex:1,opacity:h,visibility:this.visible?"inherit":"hidden"}).addClass("highcharts-tracker").addClass("highcharts-collapse-button").removeClass("highcharts-no-tooltip").css(u({color:"string"==typeof c?n.renderer.getContrast(c):"#333333"},l)).add(t),this.collapseButton.element.point=this))}toggleCollapse(e){let t=this.series;this.update({collapsed:e??!this.collapsed},!1,void 0,!1),r(t,"toggleCollapse"),t.redraw()}destroy(){this.collapseButton&&(this.collapseButton.destroy(),delete this.collapseButton,this.collapseButton=void 0),this.linkToParent&&(this.linkToParent.destroy(),delete this.linkToParent),super.destroy.apply(this,arguments)}getCollapseBtnPosition(e){var t=this.series.chart.inverted,i=e.width,s=e.height,{x:o=0,y:r=0,width:a=0,height:l=0}=this.shapeArgs||{};return{x:o+e.x+(t?-.3*s:a+-.3*i),y:r+l/2-s/2+e.y}}}return o(a,"mouseOut",function(){let e=this.collapseButton,t=this.collapseButtonOptions;e&&t?.onlyOnHover&&!this.collapsed&&e.animate({opacity:0})}),o(a,"mouseOver",function(){this.collapseButton&&this.visible&&this.collapseButton.animate({opacity:1},this.series.options.states?.hover?.animation)}),o(a,"click",function(){this.toggleCollapse()}),a}),t(e,"Series/Treegraph/TreegraphLink.js",[e["Core/Series/Point.js"],e["Core/Utilities.js"],e["Core/Series/SeriesRegistry.js"]],function(r,e,t){let{pick:a,extend:l}=e,{column:{prototype:{pointClass:i}}}=t["seriesTypes"];return class extends i{constructor(e,t,i,s){super(e,t,i),this.dataLabelOnNull=!0,this.formatPrefix="link",this.isLink=!0,this.node={},this.formatPrefix="link",this.dataLabelOnNull=!0,s&&(this.fromNode=s.node.parentNode.point,this.visible=s.visible,this.toNode=s,this.id=this.toNode.id+"-"+this.fromNode.id)}update(e,t,i,s){var o={id:this.id,formatPrefix:this.formatPrefix};r.prototype.update.call(this,e,!this.isLink&&t,i,s),this.visible=this.toNode.visible,l(this,o),a(t,!0)&&this.series.chart.redraw(i)}}}),t(e,"Series/Treegraph/TreegraphLayout.js",[e["Series/Treegraph/TreegraphNode.js"]],function(o){class s{static createDummyNode(e,t,i){let s=new o;return s.id=e.id+"-"+i,s.ancestor=e,s.children.push(t),s.parent=e.id,s.parentNode=e,s.point=t.point,s.level=t.level-i,s.relativeXPosition=t.relativeXPosition,s.visible=t.visible,e.children[t.relativeXPosition]=s,t.oldParentNode=e,t.relativeXPosition=0,t.parentNode=s,t.parent=s.id,s}calculatePositions(e){var t=e.nodeList,e=(this.resetValues(t),e.tree);e&&(this.calculateRelativeX(e,0),this.beforeLayout(t),this.firstWalk(e),this.secondWalk(e,-e.preX),this.afterLayout(t))}beforeLayout(e){for(var t of e)for(var i of t.children)if(i&&1<i.level-t.level){let e=i.level-t.level-1;for(;0<e;)i=s.createDummyNode(t,i,e),e--}}resetValues(e){for(var t of e)t.mod=0,t.ancestor=t,t.shift=0,t.thread=void 0,t.change=0,t.preX=0}calculateRelativeX(e,t){var i=e.children;for(let e=0,t=i.length;e<t;++e)this.calculateRelativeX(i[e],e);e.relativeXPosition=t}firstWalk(t){let i;if(t.hasChildren()){let e=t.getLeftMostChild();for(var s of t.children)this.firstWalk(s),e=this.apportion(s,e);this.executeShifts(t);var o=t.getLeftMostChild(),r=t.getRightMostChild(),o=(o.preX+r.preX)/2;(i=t.getLeftSibling())?(t.preX=i.preX+1,t.mod=t.preX-o):t.preX=o}else(i=t.getLeftSibling())?(t.preX=i.preX+1,t.mod=t.preX):t.preX=0}secondWalk(e,t){for(var i of(e.yPosition=e.preX+t,e.xPosition=e.level,e.children))this.secondWalk(i,t+e.mod)}executeShifts(i){let s=0,o=0;for(let t=i.children.length-1;0<=t;t--){let e=i.children[t];e.preX+=s,e.mod+=s,o+=e.change,s+=e.shift+o}}apportion(n,h){var d=n.getLeftSibling();if(d){let e=n,t=n,i=d,s=e.getLeftMostSibling(),o=e.mod,r=t.mod,a=i.mod,l=s.mod;for(;i&&i.nextRight()&&e&&e.nextLeft();){i=i.nextRight(),s=s.nextLeft(),e=e.nextLeft(),(t=t.nextRight()).ancestor=n;var p=i.preX+a-(e.preX+o)+1;0<p&&(this.moveSubtree(n.getAncestor(i,h),n,p),o+=p,r+=p),a+=i.mod,o+=e.mod,l+=s.mod,r+=t.mod}i&&i.nextRight()&&!t.nextRight()&&(t.thread=i.nextRight(),t.mod+=a-r),e&&e.nextLeft()&&!s.nextLeft()&&(s.thread=e.nextLeft(),s.mod+=o-l),h=n}return h}moveSubtree(e,t,i){var s=t.relativeXPosition-e.relativeXPosition;t.change-=i/s,t.shift+=i,t.preX+=i,t.mod+=i,e.change+=i/s}afterLayout(e){for(var t of e)t.oldParentNode&&(t.relativeXPosition=t.parentNode.relativeXPosition,t.parent=t.oldParentNode.parent,t.parentNode=t.oldParentNode,delete t.oldParentNode.children[t.relativeXPosition],t.oldParentNode.children[t.relativeXPosition]=t,t.oldParentNode=void 0)}}return s}),t(e,"Series/Treegraph/TreegraphSeriesDefaults.js",[],function(){return{reversed:!1,marker:{radius:10,lineWidth:0,symbol:"circle",fillOpacity:1,states:{}},link:{color:"#666666",lineWidth:1,radius:10,cursor:"default",type:"curved"},collapseButton:{onlyOnHover:!0,enabled:!0,lineWidth:1,x:0,y:0,height:18,width:18,shape:"circle",style:{cursor:"pointer",fontWeight:"bold",fontSize:"1em"}},fillSpace:!1,tooltip:{linkFormat:"{point.fromNode.id} â†’ {point.toNode.id}",pointFormat:"{point.id}"},dataLabels:{defer:!0,linkTextPath:{attributes:{startOffset:"50%"}},enabled:!0,linkFormatter:()=>"",style:{textOverflow:"none"}},nodeDistance:30,nodeWidth:void 0}}),t(e,"Series/Treegraph/TreegraphSeries.js",[e["Series/PathUtilities.js"],e["Core/Series/SeriesRegistry.js"],e["Core/Renderer/SVG/SVGRenderer.js"],e["Series/Treegraph/TreegraphNode.js"],e["Series/Treegraph/TreegraphPoint.js"],e["Series/TreeUtilities.js"],e["Core/Utilities.js"],e["Series/Treegraph/TreegraphLink.js"],e["Series/Treegraph/TreegraphLayout.js"],e["Series/Treegraph/TreegraphSeriesDefaults.js"]],function(e,t,i,s,o,r,a,l,n,h){let u=e["getLinkPath"],{series:{prototype:d},seriesTypes:{treemap:p,column:c}}=t,{symbols:S}=i["prototype"],{getLevelOptions:g,getNodeWidth:L}=r,{arrayMax:x,crisp:f,extend:C,merge:w,pick:X,relativeLength:P,splat:v}=a;class y extends p{constructor(){super(...arguments),this.nodeList=[],this.links=[]}init(){super.init.apply(this,arguments),this.layoutAlgorythm=new n}getLayoutModifiers(){let e=this.chart,h=this,d=e.plotSizeX,p=e.plotSizeY,c=x(this.points.map(e=>e.node.xPosition)),u=1/0,g=-1/0,f=1/0,v=-1/0,y=0,m=0,b=0,k=0;this.points.forEach(n=>{if(!this.options.fillSpace||n.visible){let e=n.node,t=h.mapOptionsToLevel[n.node.level]||{},i=w(this.options.marker,t.marker,n.options.marker),s=i.width??L(this,c),o=P(i.radius||0,Math.min(d,p)),r=i.symbol,a="circle"!==r&&i.height?P(i.height,p):2*o,l="circle"!==r&&s?P(s,d):2*o;e.nodeSizeX=l,e.nodeSizeY=a,e.xPosition<=u&&(u=e.xPosition,m=Math.max(l+(i.lineWidth||0),m)),e.xPosition>=g&&(g=e.xPosition,y=Math.max(l+(i.lineWidth||0),y)),e.yPosition<=f&&(f=e.yPosition,k=Math.max(a+(i.lineWidth||0),k)),e.yPosition>=v&&(v=e.yPosition,b=Math.max(a+(i.lineWidth||0),b))}});var t=v===f?1:(p-(k+b)/2)/(v-f),i=v===f?p/2:-t*f+k/2,s=g===u?1:(d-(y+y)/2)/(g-u);return{ax:s,bx:g===u?d/2:-s*u+m/2,ay:t,by:i}}getLinks(){let i=this,s=[];return this.data.forEach(e=>{var t=i.mapOptionsToLevel[e.node.level||0]||{};e.node.parent?(t=w(t,e.options),!e.linkToParent||e.linkToParent.destroyed?(t=new i.LinkClass(i,t,void 0,e),e.linkToParent=t):(e.collapsed=X(e.collapsed,(this.mapOptionsToLevel[e.node.level]||{}).collapsed),e.linkToParent.visible=e.linkToParent.toNode.visible),e.linkToParent.index=s.push(e.linkToParent)-1):e.linkToParent&&(i.links.splice(e.linkToParent.index),e.linkToParent.destroy(),delete e.linkToParent)}),s}buildTree(e,t,i,s,o){var r=this.points[t];return i=r&&r.level||i,super.buildTree.call(this,e,t,i,s,o)}markerAttribs(){return{}}setCollapsedStatus(e,t){let i=e.point;i&&(i.collapsed=X(i.collapsed,(this.mapOptionsToLevel[e.level]||{}).collapsed),t=!1!==(i.visible=t)&&!i.collapsed),e.children.forEach(e=>{this.setCollapsedStatus(e,t)})}drawTracker(){c.prototype.drawTracker.apply(this,arguments),c.prototype.drawTracker.call(this,this.links)}translate(){let e=this.options,t=r.updateRootId(this),i;d.translate.call(this);var s=this.tree=this.getTree();i=this.nodeMap[t],""===t||i&&i.children.length||(this.setRootNode("",!1),t=this.rootNode,i=this.nodeMap[t]),this.mapOptionsToLevel=g({from:i.level+1,levels:e.levels,to:s.height,defaults:{levelIsConstant:this.options.levelIsConstant,colorByPoint:e.colorByPoint}}),this.setCollapsedStatus(s,!0),this.links=this.getLinks(),this.setTreeValues(s),this.layoutAlgorythm.calculatePositions(this),this.layoutModifier=this.getLayoutModifiers(),this.points.forEach(e=>{this.translateNode(e)}),this.points.forEach(e=>{e.linkToParent&&this.translateLink(e.linkToParent)}),e.colorByPoint||this.setColorRecursive(this.tree)}translateLink(a){var l=a.fromNode,n=a.toNode,h=this.options.link?.lineWidth||0,d=X(this.options.link?.curveFactor,.5),p=X(a.options.link?.type,this.options.link?.type,"default");if(l.shapeArgs&&n.shapeArgs){let e=l.shapeArgs.width||0,t=this.chart.inverted,i=f((l.shapeArgs.y||0)+(l.shapeArgs.height||0)/2,h),s=f((n.shapeArgs.y||0)+(n.shapeArgs.height||0)/2,h),o=f((l.shapeArgs.x||0)+e,h),r=f(n.shapeArgs.x||0,h);t&&(o-=e,r+=n.shapeArgs.width||0);var l=n.node.xPosition-l.node.xPosition,l=(a.shapeType="path",(Math.abs(r-o)+e)/l-e),c=f((r+o)/2,h);a.plotX=c,a.plotY=s,a.shapeArgs={d:u[p]({x1:o,y1:i,x2:r,y2:s,width:l,offset:l*d*(t?-1:1),inverted:t,parentVisible:n.visible,radius:this.options.link?.radius})},a.dlBox={x:(o+r)/2,y:(i+s)/2,height:h,width:0},a.tooltipPos=t?[(this.chart.plotSizeY||0)-a.dlBox.y,(this.chart.plotSizeX||0)-a.dlBox.x]:[a.dlBox.x,a.dlBox.y]}}drawNodeLabels(e){let t,i;var s,o=this.mapOptionsToLevel;for(s of e)i=o[s.node.level],t={style:{}},i&&i.dataLabels&&(t=w(t,i.dataLabels),this.hasDataLabels=()=>!0),s.shapeArgs&&!v(this.options.dataLabels)[0].style.width&&(t.style.width=s.shapeArgs.width,s.dataLabel&&s.dataLabel.css({width:s.shapeArgs.width+"px"})),s.dlOptions=w(t,s.options.dataLabels);d.drawDataLabels.call(this,e)}alignDataLabel(e,t){let i=e.visible;e.visible=!0,super.alignDataLabel.apply(this,arguments),t.animate({opacity:!1===i?0:1},void 0,function(){i||t.hide()}),e.visible=i}drawDataLabels(){this.options.dataLabels&&(this.options.dataLabels=v(this.options.dataLabels),this.drawNodeLabels(this.points),d.drawDataLabels.call(this,this.links))}destroy(){if(this.links){for(var e of this.links)e.destroy();this.links.length=0}return d.destroy.apply(this,arguments)}pointAttribs(e,t){var i=e&&this.mapOptionsToLevel[e.node.level||0]||{},s=e&&e.options,o=i.states&&i.states[t]||{};e&&(e.options.marker=w(this.options.marker,i.marker,e.options.marker));let r=X(o&&o.link&&o.link.color,s&&s.link&&s.link.color,i&&i.link&&i.link.color,this.options.link&&this.options.link.color),a=X(o&&o.link&&o.link.lineWidth,s&&s.link&&s.link.lineWidth,i&&i.link&&i.link.lineWidth,this.options.link&&this.options.link.lineWidth),l=d.pointAttribs.call(this,e,t);return e&&(e.isLink&&(l.stroke=r,l["stroke-width"]=a,delete l.fill),e.visible||(l.opacity=0)),l}drawPoints(){p.prototype.drawPoints.apply(this,arguments),c.prototype.drawPoints.call(this,this.links)}translateNode(e){let t=this.chart,i=e.node,s=t.plotSizeY,o=t.plotSizeX,{ax:r,bx:a,ay:l,by:n}=this.layoutModifier,h=r*i.xPosition+a,d=l*i.yPosition+n,p=this.mapOptionsToLevel[i.level]||{},c=w(this.options.marker,p.marker,e.options.marker).symbol,u=i.nodeSizeY,g=i.nodeSizeX,f=this.options.reversed,v=i.x=t.inverted?o-g/2-h:h-g/2,y=i.y=f?d-u/2:s-d-u/2,m=X(e.options.borderRadius,p.borderRadius,this.options.borderRadius),b=S[c||"circle"];var k,L,x,P,T;void 0===b?(e.hasImage=!0,e.shapeType="image",e.imageUrl=c.match(/^url\((.*?)\)$/)[1]):e.shapeType="path",!e.visible&&e.linkToParent?(k=e.linkToParent.fromNode)&&({x:L=0,y:x=0,width:P=0,height:T=0}=k.shapeArgs||{},e.shapeArgs||(e.shapeArgs={}),e.hasImage||C(e.shapeArgs,{d:b(L,x,P,T,m?{r:m}:void 0)}),C(e.shapeArgs,{x:L,y:x}),e.plotX=k.plotX,e.plotY=k.plotY):(e.plotX=v,e.plotY=y,e.shapeArgs={x:v,y:y,width:g,height:u,cursor:e.node.isLeaf?"default":"pointer"},e.hasImage||(e.shapeArgs.d=b(v,y,g,u,m?{r:m}:void 0))),e.tooltipPos=t.inverted?[s-y-u/2,o-v-g/2]:[v+g/2,y]}}return y.defaultOptions=w(p.defaultOptions,h),C(y.prototype,{pointClass:o,NodeClass:s,LinkClass:l}),t.registerSeriesType("treegraph",y),y}),t(e,"masters/modules/treegraph.src.js",[e["Core/Globals.js"]],function(e){return e})});