"use strict";!function(e){"object"==typeof module&&module.exports?module.exports=e.default=e:"function"==typeof define&&define.amd?define("highcharts/modules/series-label",["highcharts"],function(t){return e(t),e.Highcharts=t,e}):e("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(t){function e(t,e,o,r){t.hasOwnProperty(e)||(t[e]=r.apply(null,o),"function"==typeof CustomEvent&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:e,module:t[e]}})))}e(t=t?t._modules:{},"Extensions/SeriesLabel/SeriesLabelDefaults.js",[],function(){return{enabled:!0,connectorAllowed:!1,connectorNeighbourDistance:24,format:void 0,formatter:void 0,minFontSize:null,maxFontSize:null,onArea:null,style:{fontSize:"0.8em",fontWeight:"bold"},useHTML:!1,boxesToAvoid:[]}}),e(t,"Extensions/SeriesLabel/SeriesLabelUtilities.js",[],function(){function h(t,e,o,r,i,a){return 0<(t=(a-e)*(o-t)-(r-e)*(i-t))||!(t<0)}function l(t,e,o,r,i,a,n,s){return h(t,e,i,a,n,s)!==h(o,r,i,a,n,s)&&h(t,e,o,r,i,a)!==h(t,e,o,r,n,s)}return{boxIntersectLine:function(t,e,o,r,i,a,n,s){return l(t,e,t+o,e,i,a,n,s)||l(t+o,e,t+o,e+r,i,a,n,s)||l(t,e+r,t+o,e+r,i,a,n,s)||l(t,e,t,e+r,i,a,n,s)},intersectRect:function(t,e){return!(e.left>t.right||e.right<t.left||e.top>t.bottom||e.bottom<t.top)}}}),e(t,"Extensions/SeriesLabel/SeriesLabel.js",[t["Core/Animation/AnimationUtilities.js"],t["Core/Chart/Chart.js"],t["Core/FormatUtilities.js"],t["Core/Defaults.js"],t["Extensions/SeriesLabel/SeriesLabelDefaults.js"],t["Extensions/SeriesLabel/SeriesLabelUtilities.js"],t["Core/Utilities.js"]],function(t,o,e,r,i,a,s){function X(t,e,o,r,i){var a,n=t.chart,s=t.options.label||{},h=A(s.onArea,!!t.area),l=h||s.connectorAllowed,c=n.boxesToAvoid;let p=Number.MAX_VALUE,d=Number.MAX_VALUE,u,f,x;for(x=0;c&&x<c.length;x+=1)if(Y(c[x],{left:e,right:e+r.width,top:o,bottom:o+r.height}))return!1;for(x=0;x<n.series.length;x+=1){var b=n.series[x],c=b.interpolatedPoints&&[...b.interpolatedPoints];if(b.visible&&c){for(var m=n.plotHeight/10,g=n.plotTop;g<=n.plotTop+n.plotHeight;g+=m)c.unshift({chartX:n.plotLeft,chartY:g}),c.push({chartX:n.plotLeft+n.plotWidth,chartY:g});for(m=1;m<c.length;m+=1){if(c[m].chartX>=e-16&&c[m-1].chartX<=e+r.width+16){if(y(e,o,r.width,r.height,c[m-1].chartX,c[m-1].chartY,c[m].chartX,c[m].chartY))return!1;t===b&&!a&&i&&(a=y(e-16,o-16,r.width+32,r.height+32,c[m-1].chartX,c[m-1].chartY,c[m].chartX,c[m].chartY))}!l&&!a||t===b&&!h||(g=e+r.width/2-c[m].chartX,f=o+r.height/2-c[m].chartY,p=Math.min(p,g*g+f*f))}if(!h&&l&&t===b&&(i&&!a||p<Math.pow(s.connectorNeighbourDistance||1,2))){for(m=1;m<c.length;m+=1)(a=Math.min(Math.pow(e+r.width/2-c[m].chartX,2)+Math.pow(o+r.height/2-c[m].chartY,2),Math.pow(e-c[m].chartX,2)+Math.pow(o-c[m].chartY,2),Math.pow(e+r.width-c[m].chartX,2)+Math.pow(o-c[m].chartY,2),Math.pow(e+r.width-c[m].chartX,2)+Math.pow(o+r.height-c[m].chartY,2),Math.pow(e-c[m].chartX,2)+Math.pow(o+r.height-c[m].chartY,2)))<d&&(d=a,u=c[m]);a=!0}}}return!(i&&!a)&&{x:e,y:o,weight:p-(u?d:0),connectorPoint:u}}function h(Y){Y.boxesToAvoid=[];const t=Y.labelSeries||[],a=Y.boxesToAvoid;Y.series.forEach(i=>(i.points||[]).forEach(t=>(t.dataLabels||[]).forEach(t=>{var{width:e,height:o}=t.getBBox(),r=t.translateX+(i.xAxis?i.xAxis.pos:i.chart.plotLeft);t=t.translateY+(i.yAxis?i.yAxis.pos:i.chart.plotTop),a.push({left:r,top:t,right:r+e,bottom:t+o})}))),t.forEach(function(t){var e=t.options.label||{};t.interpolatedPoints=function(t){function e(t){var e=Math.round((t.plotX||0)/8)+","+Math.round((t.plotY||0)/8);p[e]||(p[e]=1,r.push(t))}if(t.xAxis||t.yAxis){var o=t.points,r=[],i=t.graph||t.area,a=i&&i.element,n=t.chart.inverted,s=t.xAxis,h=t.yAxis,l=(n?h:s).pos,c=(n=(n?s:h).pos,s=A((t.options.label||{}).onArea,!!t.area),h.getThreshold(t.options.threshold)),p={};if(t.getPointSpline&&a&&a.getPointAtLength&&!s&&o.length<(t.chart.plotSizeX||0)/16){var d=i.toD&&i.attr("d");for(i.toD&&i.attr({d:i.toD}),h=a.getTotalLength(),t=0;t<h;t+=16)s=a.getPointAtLength(t),e({chartX:l+s.x,chartY:n+s.y,plotX:s.x,plotY:s.y});d&&i.attr({d:d}),o=o[o.length-1],e({chartX:l+(o.plotX||0),chartY:n+(o.plotY||0)})}else for(h=o.length,t=0;t<h;t+=1){const{plotX:r,plotY:h,plotHigh:p}=a=o[t];if(f(r)&&f(h)){if(i={plotX:r,plotY:h,chartX:l+r,chartY:n+h},s&&(p&&(i.plotY=p,i.chartY=n+p),i.chartCenterY=n+((p||h)+A(a.yBottom,c))/2),d){a=Math.abs(i.chartX-d.chartX);var u=Math.abs(i.chartY-d.chartY);if(16<(a=Math.max(a,u)))for(a=Math.ceil(a/16),u=1;u<a;u+=1)e({chartX:d.chartX+u/a*(i.chartX-d.chartX),chartY:d.chartY+u/a*(i.chartY-d.chartY),chartCenterY:(d.chartCenterY||0)+u/a*((i.chartCenterY||0)-(d.chartCenterY||0)),plotX:(d.plotX||0)+u/a*(r-(d.plotX||0)),plotY:(d.plotY||0)+u/a*(h-(d.plotY||0))})}e(i),d=i}}return r}}(t),a.push(...e.boxesToAvoid||[])}),Y.series.forEach(function(e){function t(t,e,o){var r=Math.max(p,A(a,-1/0)),i=Math.min(p+u,A(n,1/0));return r<t&&t<=i-o.width&&d<=e&&e<=d+f-o.height}var o=e.options.label;if(o&&(e.xAxis||e.yAxis)){var r,a,n,i="highcharts-color-"+A(e.colorIndex,"none"),s=!e.labelBySeries,h=o.minFontSize,l=o.maxFontSize,c=Y.inverted,p=(c?e.yAxis:e.xAxis).pos,d=(c?e.xAxis:e.yAxis).pos,u=(Y.inverted?e.yAxis:e.xAxis).len,f=(Y.inverted?e.xAxis:e.yAxis).len,x=e.interpolatedPoints,b=A(o.onArea,!!e.area),m=[],g=e.xData||[],y=e.labelBySeries;if(b&&!c&&(c=[e.xAxis.toPixels(g[0]),e.xAxis.toPixels(g[g.length-1])],a=Math.min.apply(Math,c),n=Math.max.apply(Math,c)),e.visible&&!e.boosted&&x){for(y||(y=e.name,"string"==typeof o.format?y=w(o.format,e,Y):o.formatter&&(y=o.formatter.call(e)),e.labelBySeries=y=Y.renderer.label(y,0,0,"connector",0,0,o.useHTML).addClass("highcharts-series-label highcharts-series-label-"+e.index+" "+(e.options.className||"")+" "+i),Y.renderer.styledMode||(i="string"==typeof e.color?e.color:"#666666",y.css(M({color:b?Y.renderer.getContrast(i):i},o.style||{})),y.attr({opacity:Y.renderer.forExport?1:0,stroke:e.color,"stroke-width":1})),h&&l&&y.css({fontSize:h+(e.sum||0)/(e.chart.labelSeriesMaxSum||0)*(l-h)+"px"}),y.attr({padding:0,zIndex:3}).add()),(h=y.getBBox()).width=Math.round(h.width),c=x.length-1;0<c;--c)b?t(l=x[c].chartX-h.width/2,i=(x[c].chartCenterY||0)-h.height/2,h)&&(r=X(e,l,i,h)):((r=t(l=x[c].chartX+3,i=x[c].chartY-h.height-3,h)?X(e,l,i,h,!0):r)&&m.push(r),(r=t(l=x[c].chartX+3,i=x[c].chartY+3,h)?X(e,l,i,h,!0):r)&&m.push(r),(r=t(l=x[c].chartX-h.width-3,i=x[c].chartY+3,h)?X(e,l,i,h,!0):r)&&m.push(r),t(l=x[c].chartX-h.width-3,i=x[c].chartY-h.height-3,h)&&(r=X(e,l,i,h,!0))),r&&m.push(r);if(o.connectorAllowed&&!m.length&&!b)for(l=p+u-h.width;p<=l;l-=16)for(i=d;i<d+f-h.height;i+=16)(r=X(e,l,i,h,!0))&&m.push(r);if(m.length){if(m.sort((t,e)=>e.weight-t.weight),r=m[0],(Y.boxesToAvoid||[]).push({left:r.x,right:r.x+h.width,top:r.y,bottom:r.y+h.height}),(m=Math.sqrt(Math.pow(Math.abs(r.x-(y.x||0)),2)+Math.pow(Math.abs(r.y-(y.y||0)),2)))&&e.labelBySeries){o={opacity:Y.renderer.forExport?1:0,x:r.x,y:r.y},x={opacity:1},m<=10&&(x={x:o.x,y:o.y},o={});let t;s&&((t=S(e.options.animation)).duration*=.2),e.labelBySeries.attr(M(o,{anchorX:r.connectorPoint&&(r.connectorPoint.plotX||0)+p,anchorY:r.connectorPoint&&(r.connectorPoint.plotY||0)+d})).animate(x,t),e.options.kdNow=!0,e.buildKDTree(),(e=e.searchPoint({chartX:r.x,chartY:r.y},!0))&&(y.closest=[e,r.x-(e.plotX||0),r.y-(e.plotY||0)])}}else y&&(e.labelBySeries=y.destroy())}else y&&(e.labelBySeries=y.destroy())}}),d(Y,"afterDrawSeriesLabels")}function n(a){if(this.renderer){const n=this;let i=S(n.renderer.globalAnimation).duration;n.labelSeries=[],n.labelSeriesMaxSum=0,n.seriesLabelTimer&&s.clearTimeout(n.seriesLabelTimer),n.series.forEach(function(t){const e=t.options.label||{},o=t.labelBySeries,r=o&&o.closest;e.enabled&&t.visible&&(t.graph||t.area)&&!t.boosted&&n.labelSeries&&(n.labelSeries.push(t),e.minFontSize&&e.maxFontSize&&t.yData&&(t.sum=t.yData.reduce((t,e)=>(t||0)+(e||0),0),n.labelSeriesMaxSum=Math.max(n.labelSeriesMaxSum||0,t.sum||0)),"load"===a.type&&(i=Math.max(i,S(t.options.animation).duration)),r&&(void 0!==r[0].plotX?o.animate({x:r[0].plotX+r[1],y:r[0].plotY+r[2]}):o.attr({opacity:0})))}),n.seriesLabelTimer=u(function(){n.series&&n.labelSeries&&h(n)},n.renderer.forExport||!i?0:i)}}function l(t,e,o,r,i){var a=i&&i.anchorX;i=i&&i.anchorY;let n,s,h=o/2;return f(a)&&f(i)&&(n=[["M",a,i]],(s=(s=e-i)<0?-r-s:s)<o&&(h=a<t+o/2?s:o-s),e+r<i?n.push(["L",t+h,e+r]):i<e?n.push(["L",t+h,e]):a<t?n.push(["L",t,e+r/2]):t+o<a&&n.push(["L",t+o,e+r/2])),n||[]}const S=t["animObject"],w=e["format"],c=r["setOptions"],{boxIntersectLine:y,intersectRect:Y}=a,{addEvent:p,extend:M,fireEvent:d,isNumber:f,pick:A,syncTimeout:u}=s,x=[];return{compose:function(t,e){s.pushUnique(x,t)&&(p(o,"load",n),p(o,"redraw",n)),s.pushUnique(x,e)&&(e.prototype.symbols.connector=l),s.pushUnique(x,c)&&c({plotOptions:{series:{label:i}}})}}}),e(t,"masters/modules/series-label.src.js",[t["Core/Globals.js"],t["Extensions/SeriesLabel/SeriesLabel.js"]],function(t,e){e.compose(t.Chart,t.SVGRenderer)})});