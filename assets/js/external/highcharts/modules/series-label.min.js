!function(e){"object"==typeof module&&module.exports?module.exports=e.default=e:"function"==typeof define&&define.amd?define("highcharts/modules/series-label",["highcharts"],function(t){return e(t),e.Highcharts=t,e}):e("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(i){"use strict";var t=i?i._modules:{};function e(t,e,o,r){t.hasOwnProperty(e)||(t[e]=r.apply(null,o),"function"==typeof CustomEvent&&i.win.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:e,module:t[e]}})))}e(t,"Extensions/SeriesLabel/SeriesLabelDefaults.js",[],function(){return{enabled:!0,connectorAllowed:!1,connectorNeighbourDistance:24,format:void 0,formatter:void 0,minFontSize:null,maxFontSize:null,onArea:null,style:{fontSize:"0.8em",fontWeight:"bold"},useHTML:!1,boxesToAvoid:[]}}),e(t,"Extensions/SeriesLabel/SeriesLabelUtilities.js",[],function(){function h(t,e,o,r,i,a){a=(a-e)*(o-t)-(r-e)*(i-t);return 0<a||!(a<0)}function l(t,e,o,r,i,a,n,s){return h(t,e,i,a,n,s)!==h(o,r,i,a,n,s)&&h(t,e,o,r,i,a)!==h(t,e,o,r,n,s)}return{boxIntersectLine:function(t,e,o,r,i,a,n,s){return l(t,e,t+o,e,i,a,n,s)||l(t+o,e,t+o,e+r,i,a,n,s)||l(t,e+r,t+o,e+r,i,a,n,s)||l(t,e,t,e+r,i,a,n,s)},intersectRect:function(t,e){return!(e.left>t.right||e.right<t.left||e.top>t.bottom||e.bottom<t.top)}}}),e(t,"Extensions/SeriesLabel/SeriesLabel.js",[t["Core/Animation/AnimationUtilities.js"],t["Core/Templating.js"],t["Core/Defaults.js"],t["Core/Globals.js"],t["Extensions/SeriesLabel/SeriesLabelDefaults.js"],t["Extensions/SeriesLabel/SeriesLabelUtilities.js"],t["Core/Utilities.js"]],function(t,e,o,r,i,a,s){let T=t["animObject"],C=e["format"],n=o["setOptions"],h=r["composed"],{boxIntersectLine:S,intersectRect:Y}=a,{addEvent:l,extend:P,fireEvent:c,isNumber:w,pick:j,pushUnique:p,syncTimeout:d}=s;function B(o,r,i,a,n){let s=o.chart,h=o.options.label||{},l=j(h.onArea,!!o.area),c=l||h.connectorAllowed,t=s.boxesToAvoid,p=Number.MAX_VALUE,d=Number.MAX_VALUE,u,f,x,b,m,g,y;for(g=0;t&&g<t.length;g+=1)if(Y(t[g],{left:r,right:r+a.width,top:i,bottom:i+a.height}))return!1;for(g=0;g<s.series.length;g+=1){let t=s.series[g],e=t.interpolatedPoints&&[...t.interpolatedPoints];if(t.visible&&e){var X=s.plotHeight/10;for(let t=s.plotTop;t<=s.plotTop+s.plotHeight;t+=X)e.unshift({chartX:s.plotLeft,chartY:t}),e.push({chartX:s.plotLeft+s.plotWidth,chartY:t});for(y=1;y<e.length;y+=1){if(e[y].chartX>=r-16&&e[y-1].chartX<=r+a.width+16){if(S(r,i,a.width,a.height,e[y-1].chartX,e[y-1].chartY,e[y].chartX,e[y].chartY))return!1;o===t&&!x&&n&&(x=S(r-16,i-16,a.width+32,a.height+32,e[y-1].chartX,e[y-1].chartY,e[y].chartX,e[y].chartY))}!c&&!x||o===t&&!l||(p=Math.min(p,(b=r+a.width/2-e[y].chartX)*b+(m=i+a.height/2-e[y].chartY)*m))}if(!l&&c&&o===t&&(n&&!x||p<Math.pow(h.connectorNeighbourDistance||1,2))){for(y=1;y<e.length;y+=1)(u=Math.min(Math.pow(r+a.width/2-e[y].chartX,2)+Math.pow(i+a.height/2-e[y].chartY,2),Math.pow(r-e[y].chartX,2)+Math.pow(i-e[y].chartY,2),Math.pow(r+a.width-e[y].chartX,2)+Math.pow(i-e[y].chartY,2),Math.pow(r+a.width-e[y].chartX,2)+Math.pow(i+a.height-e[y].chartY,2),Math.pow(r-e[y].chartX,2)+Math.pow(i+a.height-e[y].chartY,2)))<d&&(d=u,f=e[y]);x=!0}}}return(!n||!!x)&&{x:r,y:i,weight:p-(f?d:0),connectorPoint:f}}function u(n){if(this.renderer){let i=this,a=T(i.renderer.globalAnimation).duration;i.labelSeries=[],i.labelSeriesMaxSum=0,i.seriesLabelTimer&&s.clearTimeout(i.seriesLabelTimer),i.series.forEach(function(t){let e=t.options.label||{},o=t.labelBySeries,r=o&&o.closest;e.enabled&&t.visible&&(t.graph||t.area)&&!t.boosted&&i.labelSeries&&(i.labelSeries.push(t),e.minFontSize&&e.maxFontSize&&t.yData&&(t.sum=t.yData.reduce((t,e)=>(t||0)+(e||0),0),i.labelSeriesMaxSum=Math.max(i.labelSeriesMaxSum||0,t.sum||0)),"load"===n.type&&(a=Math.max(a,T(t.options.animation).duration)),r&&(void 0!==r[0].plotX?o.animate({x:r[0].plotX+r[1],y:r[0].plotY+r[2]}):o.attr({opacity:0})))}),i.seriesLabelTimer=d(function(){if(i.series&&i.labelSeries){var E=i;E.boxesToAvoid=[];let t=E.labelSeries||[],a=E.boxesToAvoid;E.series.forEach(i=>(i.points||[]).forEach(t=>(t.dataLabels||[]).forEach(t=>{var{width:e,height:o}=t.getBBox(),r=(t.translateX||0)+(i.xAxis?i.xAxis.pos:i.chart.plotLeft),t=(t.translateY||0)+(i.yAxis?i.yAxis.pos:i.chart.plotTop);a.push({left:r,top:t,right:r+e,bottom:t+o})}))),t.forEach(function(t){var e=t.options.label||{};t.interpolatedPoints=function(x){let b,m,g,y,X;if(x.xAxis||x.yAxis){let t=x.points,o=[],e=x.graph||x.area,r=e&&e.element,n=x.chart.inverted,i=x.xAxis,a=x.yAxis,s=(n?a:i).pos,h=(n?i:a).pos,l=(n?i:a).len,c=(n?a:i).len,p=j((x.options.label||{}).onArea,!!x.area),d=a.getThreshold(x.options.threshold),u={},f=n?"chartCenterX":"chartCenterY";if(x.getPointSpline&&r&&r.getPointAtLength&&!p&&t.length<(x.chart.plotSizeX||0)/16){x=e.toD&&e.attr("d");for(e.toD&&e.attr({d:e.toD}),g=r.getTotalLength(),b=0;b<g;b+=16){var S=r.getPointAtLength(b),Y=n?c-S.y:S.x,S=n?l-S.x:S.y;M({chartX:s+Y,chartY:h+S,plotX:Y,plotY:S})}x&&e.attr({d:x});x=t[t.length-1].pos();M({chartX:s+(x?.[0]||0),chartY:h+(x?.[1]||0)})}else{let a;for(b=0,g=t.length;b<g;b+=1){let e=t[b],[o,r]=e.pos()||[],i=e["plotHigh"];if(w(o)&&w(r)){let t={plotX:o,plotY:r,chartX:s+o,chartY:h+r};if(p&&(i&&(t.plotY=i,t.chartY=h+i),n?t.chartCenterX=s+c-((i||e.plotY||0)+j(e.yBottom,d))/2:t.chartCenterY=h+((i||r)+j(e.yBottom,d))/2),a&&16<(m=Math.max(Math.abs(t.chartX-a.chartX),Math.abs(t.chartY-a.chartY))))for(X=1,y=Math.ceil(m/16);X<y;X+=1)M({chartX:a.chartX+(t.chartX-a.chartX)*(X/y),chartY:a.chartY+(t.chartY-a.chartY)*(X/y),[f]:(a[f]||0)+((t[f]||0)-(a[f]||0))*(X/y),plotX:(a.plotX||0)+(o-(a.plotX||0))*(X/y),plotY:(a.plotY||0)+(r-(a.plotY||0))*(X/y)});M(t),a=t}}}return o;function M(t){var e=Math.round((t.plotX||0)/8)+","+Math.round((t.plotY||0)/8);u[e]||(u[e]=1,o.push(t))}}}(t),a.push(...e.boxesToAvoid||[])}),E.series.forEach(function(M){let w=M.options.label;if(w&&(M.xAxis||M.yAxis)){let e="highcharts-color-"+j(M.colorIndex,"none"),r=!M.labelBySeries,o=w.minFontSize,i=w.maxFontSize,t=E.inverted,a=(t?M.yAxis:M.xAxis).pos,n=(t?M.xAxis:M.yAxis).pos,s=(E.inverted?M.yAxis:M.xAxis).len,h=(E.inverted?M.xAxis:M.yAxis).len,l=M.interpolatedPoints,c=j(w.onArea,!!M.area),p=[],d=M.xData||[],u,f,x,b,m,g,y=M.labelBySeries,X,S,Y;if(c&&!t&&(X=[M.xAxis.toPixels(d[0]),M.xAxis.toPixels(d[d.length-1])],S=Math.min.apply(Math,X),Y=Math.max.apply(Math,X)),M.visible&&!M.boosted&&l){if(!y){let t=M.name;"string"==typeof w.format?t=C(w.format,M,E):w.formatter&&(t=w.formatter.call(M)),M.labelBySeries=y=E.renderer.label(t,0,0,"connector",0,0,w.useHTML).addClass("highcharts-series-label highcharts-series-label-"+M.index+" "+(M.options.className||"")+" "+e),E.renderer.styledMode||(A="string"==typeof M.color?M.color:"#666666",y.css(P({color:c?E.renderer.getContrast(A):A},w.style||{})),y.attr({opacity:E.renderer.forExport?1:0,stroke:M.color,"stroke-width":1})),o&&i&&y.css({fontSize:o+(M.sum||0)/(M.chart.labelSeriesMaxSum||0)*(i-o)+"px"}),y.attr({padding:0,zIndex:3}).add()}for((u=y.getBBox()).width=Math.round(u.width),m=l.length-1;0<m;--m)c?L(f=(l[m].chartCenterX??l[m].chartX)-u.width/2,x=(l[m].chartCenterY??l[m].chartY)-u.height/2,u)&&(g=B(M,f,x,u)):((g=L(f=l[m].chartX+3,x=l[m].chartY-u.height-3,u)?B(M,f,x,u,!0):g)&&p.push(g),(g=L(f=l[m].chartX+3,x=l[m].chartY+3,u)?B(M,f,x,u,!0):g)&&p.push(g),(g=L(f=l[m].chartX-u.width-3,x=l[m].chartY+3,u)?B(M,f,x,u,!0):g)&&p.push(g),L(f=l[m].chartX-u.width-3,x=l[m].chartY-u.height-3,u)&&(g=B(M,f,x,u,!0))),g&&p.push(g);if(w.connectorAllowed&&!p.length&&!c)for(f=a+s-u.width;f>=a;f-=16)for(x=n;x<n+h-u.height;x+=16)(b=B(M,f,x,u,!0))&&p.push(b);if(p.length){p.sort((t,e)=>e.weight-t.weight),g=p[0],(E.boxesToAvoid||[]).push({left:g.x,right:g.x+u.width,top:g.y,bottom:g.y+u.height});var A=Math.sqrt(Math.pow(Math.abs(g.x-(y.x||0)),2)+Math.pow(Math.abs(g.y-(y.y||0)),2));if(A&&M.labelBySeries){let t,e={opacity:E.renderer.forExport?1:0,x:g.x,y:g.y},o={opacity:1};A<=10&&(o={x:e.x,y:e.y},e={}),r&&((t=T(M.options.animation)).duration*=.2),M.labelBySeries.attr(P(e,{anchorX:g.connectorPoint&&(g.connectorPoint.plotX||0)+a,anchorY:g.connectorPoint&&(g.connectorPoint.plotY||0)+n})).animate(o,t),M.options.kdNow=!0,M.buildKDTree();A=M.searchPoint({chartX:g.x,chartY:g.y},!0);A&&(y.closest=[A,g.x-(A.plotX||0),g.y-(A.plotY||0)])}}else v()}else v();function L(t,e,o){var r=Math.max(a,j(S,-1/0)),i=Math.min(a+s,j(Y,1/0));return r<t&&t<=i-o.width&&e>=n&&e<=n+h-o.height}function v(){y&&(M.labelBySeries=y.destroy())}}}),c(E,"afterDrawSeriesLabels")}},i.renderer.forExport||!a?0:a)}}function f(t,e,o,r,i){let a=i&&i.anchorX,n=i&&i.anchorY,s,h,l=o/2;return w(a)&&w(n)&&(s=[["M",a,n]],(h=(h=e-n)<0?-r-h:h)<o&&(l=a<t+o/2?h:o-h),e+r<n?s.push(["L",t+l,e+r]):n<e?s.push(["L",t+l,e]):a<t?s.push(["L",t,e+r/2]):t+o<a&&s.push(["L",t+o,e+r/2])),s||[]}return{compose:function(t,e){p(h,"SeriesLabel")&&(l(t,"load",u),l(t,"redraw",u),e.prototype.symbols.connector=f,n({plotOptions:{series:{label:i}}}))}}}),e(t,"masters/modules/series-label.src.js",[t["Core/Globals.js"],t["Extensions/SeriesLabel/SeriesLabel.js"]],function(t,e){return e.compose(t.Chart,t.SVGRenderer),t})});