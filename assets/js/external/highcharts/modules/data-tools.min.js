!function(t){"object"==typeof module&&module.exports?module.exports=t.default=t:"function"==typeof define&&define.amd?define("highcharts/modules/data-tools",["highcharts"],function(e){return t(e),t.Highcharts=e,t}):t("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(o){"use strict";var e=o?o._modules:{};function t(e,t,r,s){e.hasOwnProperty(t)||(e[t]=s.apply(null,r),"function"==typeof CustomEvent&&o.win.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:t,module:e[t]}})))}t(e,"Data/Modifiers/DataModifier.js",[e["Core/Utilities.js"]],function(e){var r;let{addEvent:s,fireEvent:t,merge:a}=e;class o{benchmark(e,t){let r=[],s=this,o=()=>{s.modifyTable(e),s.emit({type:"afterBenchmarkIteration"})},n=a({iterations:1},t)["iterations"],i=(s.on("afterBenchmarkIteration",()=>{r.length===n?s.emit({type:"afterBenchmark",results:r}):o()}),{startTime:0,endTime:0});return s.on("modify",()=>{i.startTime=window.performance.now()}),s.on("afterModify",()=>{i.endTime=window.performance.now(),r.push(i.endTime-i.startTime)}),o(),r}emit(e){t(this,e.type,e)}modify(r,s){let o=this;return new Promise((e,t)=>{r.modified===r&&(r.modified=r.clone(!1,s));try{e(o.modifyTable(r,s))}catch(e){o.emit({type:"error",detail:s,table:r}),t(e)}})}modifyCell(e,t,r,s,o){return this.modifyTable(e)}modifyColumns(e,t,r,s){return this.modifyTable(e)}modifyRows(e,t,r,s){return this.modifyTable(e)}on(e,t){return s(this,e,t)}}return(r=o=o||{}).types={},r.registerType=function(e,t){return!!e&&!r.types[e]&&!!(r.types[e]=t)},o}),t(e,"Data/DataTable.js",[e["Core/Utilities.js"]],function(e){let{addEvent:r,fireEvent:t,uniqueKey:m}=e;class h{static isNull(r){if(r===h.NULL)return!0;if(r instanceof Array){if(!r.length)return!1;for(let e=0,t=r.length;e<t;++e)if(null!==r[e])return!1}else{var s=Object.keys(r);if(!s.length)return!1;for(let e=0,t=s.length;e<t;++e)if(null!==r[s[e]])return!1}return!0}constructor(e={}){this.aliases=e.aliases?JSON.parse(JSON.stringify(e.aliases)):{},this.autoId=!e.id,this.columns={},this.id=e.id||m(),(this.modified=this).rowCount=0,this.versionTag=m(),this.rowKeysId=e.rowKeysId;let o=e.columns||{},n=Object.keys(o),i=this.columns,a=0;for(let e=0,t=n.length,r,s;e<t;++e)r=o[s=n[e]].slice(),i[s]=r,a=Math.max(a,r.length);for(let e=0,t=n.length;e<t;++e)i[n[e]].length=a;this.rowCount=a;let s=e.aliases||{},l=Object.keys(s),u=this.aliases;for(let e=0,t=l.length,r;e<t;++e)u[r=l[e]]=s[r];this.setRowKeysColumn(a)}clone(e,t){let r={},s=(this.emit({type:"cloneTable",detail:t}),e||(r.aliases=this.aliases,r.columns=this.columns),this.autoId||(r.id=this.id),this.rowKeysId&&(r.rowKeysId=this.rowKeysId),new h(r));return e||(s.versionTag=this.versionTag),this.emit({type:"afterCloneTable",detail:t,tableClone:s}),s}deleteColumnAlias(e){let t=this.aliases[e],r=this.modifier;return t&&(delete this.aliases[e],r&&r.modifyColumns(this,{[t]:Array(this.rowCount)},0)),t}deleteColumns(o,t){let n=this.columns,i={},a={},r=this.modifier,l=this.rowCount;if((o=o||Object.keys(n)).length){this.emit({type:"deleteColumns",columnNames:o,detail:t});for(let e=0,t=o.length,r,s;e<t;++e)(r=n[s=o[e]])&&(i[s]=r,a[s]=Array(l)),delete n[s];let e=Object.keys(n).length;return this.rowKeysId&&1===e&&(delete n[this.rowKeysId],e=0),e||(this.rowCount=0),r&&r.modifyColumns(this,a,0,t),this.emit({type:"afterDeleteColumns",columns:i,columnNames:o,detail:t}),i}}deleteRows(i,a=1,e){let l=[],u=[],t=this.modifier;if(this.emit({type:"deleteRows",detail:e,rowCount:a,rowIndex:i||0}),void 0===i&&(i=0,a=this.rowCount),0<a&&i<this.rowCount){let o=this.columns,n=Object.keys(o);for(let r=0,e=n.length,t,s;r<e;++r){s=(t=o[n[r]]).splice(i,a),r||(this.rowCount=t.length);for(let e=0,t=s.length;e<t;++e)l[e]=l[e]||[],l[e][r]=s[e];u.push(Array(e))}}return t&&t.modifyRows(this,u,i||0,e),this.emit({type:"afterDeleteRows",detail:e,rowCount:a,rowIndex:i||0,rows:l}),l}emit(e){switch(e.type){case"afterDeleteColumns":case"afterDeleteRows":case"afterSetCell":case"afterSetColumns":case"afterSetRows":this.versionTag=m()}t(this,e.type,e)}getCell(e,t){e=this.aliases[e]||e;e=this.columns[e];if(e)return e[t]}getCellAsBoolean(e,t){e=this.aliases[e]||e;e=this.columns[e];return!(!e||!e[t])}getCellAsNumber(e,t,r){e=this.aliases[e]||e;let s=this.columns[e],o=s&&s[t];switch(typeof o){case"boolean":return o?1:0;case"number":return isNaN(o)&&!r?null:o}return isNaN(o=parseFloat(""+(o??"")))&&!r?null:o}getCellAsString(e,t){e=this.aliases[e]||e;e=this.columns[e];return""+(e&&e[t])}getColumn(e,t){return this.getColumns([e],t)[e]}getColumnAsNumbers(t,e){let r=this.columns[t=this.aliases[t]||t],s=[];if(r){var o=r.length;if(e)for(let e=0;e<o;++e)s.push(this.getCellAsNumber(t,e,!0));else{for(let e=0,t;e<o;++e){if("number"==typeof(t=r[e]))return r.slice();if(null!=t)break}for(let e=0;e<o;++e)s.push(this.getCellAsNumber(t,e))}}return s}getColumnNames(){var e=Object.keys(this.columns);return this.removeRowKeysColumn(e),e}getColumns(o,n){let i=this.aliases,a=this.columns,l={};o=o||Object.keys(a),this.removeRowKeysColumn(o);for(let e=0,t=o.length,r,s;e<t;++e)(r=a[i[s=o[e]]||s])&&(l[s]=n?r:r.slice());return l}getModifier(){return this.modifier}getRow(e,t){return this.getRows(e,1,t)[0]}getRowCount(){return this.rowCount}getRowIndexBy(e,t,r){e=this.aliases[e]||e;let s=this.columns[e];if(s){e=s.indexOf(t,r);if(-1!==e)return e}}getRowObject(e,t){return this.getRowObjects(e,1,t)[0]}getRowObjects(n=0,i=this.rowCount-n,a){let l=this.aliases,u=this.columns,m=Array(i);a=a||Object.keys(u),this.removeRowKeysColumn(a);for(let e=n,t=0,r=Math.min(this.rowCount,n+i),s,o;e<r;++e,++t)for(var h of(o=m[t]={},a))s=u[l[h]||h],o[h]=s?s[e]:void 0;return m}getRows(n=0,i=this.rowCount-n,a){let l=this.aliases,u=this.columns,m=Array(i);a=a||Object.keys(u);for(let e=n,t=0,r=Math.min(this.rowCount,n+i),s,o;e<r;++e,++t)for(var h of(o=m[t]=[],a))s=u[l[h]||h],o.push(s?s[e]:void 0);return m}getVersionTag(){return this.versionTag}hasColumns(s){var o=this.aliases,n=this.columns;for(let e=0,t=s.length,r;e<t;++e)if(!n[r=s[e]]&&!o[r])return!1;return!0}hasRowWith(e,t){e=this.aliases[e]||e;let r=this.columns[e];return!!r&&-1!==r.indexOf(t)}on(e,t){return r(this,e,t)}renameColumn(t,r){let s=this.columns;if(s[t]){if(t!==r){let e=this.aliases;e[r]&&delete e[r],s[r]=s[t],delete s[t],this.rowKeysId&&this.moveRowKeysColumnToLast(s,this.rowKeysId)}return!0}return!1}setCell(e,t,r,s){let o=this.columns,n=this.modifier,i=o[e=this.aliases[e]||e];i&&i[t]===r||(this.emit({type:"setCell",cellValue:r,columnName:e,detail:s,rowIndex:t}),i=i||(o[e]=Array(this.rowCount)),t>=this.rowCount&&(this.rowCount=t+1),i[t]=r,n&&n.modifyCell(this,e,t,r),this.emit({type:"afterSetCell",cellValue:r,columnName:e,detail:s,rowIndex:t}))}setColumn(e,t=[],r=0,s){this.setColumns({[e]:t},r,s)}setColumns(r,n,e){let i=this.columns,t=this.modifier,a=void 0===n,l=Object.keys(r);this.emit({type:"setColumns",columns:r,columnNames:l,detail:e,rowIndex:n});for(let e=0,t=l.length,s,o;e<t;++e)if(s=r[o=l[e]],o=this.aliases[o]||o,a)i[o]=s.slice(),this.rowCount=s.length;else{let r=i[o]||(i[o]=Array(this.rowCount));for(let e=n||0,t=s.length;e<t;++e)r[e]=s[e];this.rowCount=Math.max(this.rowCount,r.length)}var s=Object.keys(i);for(let e=0,t=s.length;e<t;++e)i[s[e]].length=this.rowCount;t&&t.modifyColumns(this,r,n||0),this.rowKeysId&&this.moveRowKeysColumnToLast(i,this.rowKeysId),this.emit({type:"afterSetColumns",columns:r,columnNames:l,detail:e,rowIndex:n})}setRowKeysColumn(r){var s=this.rowKeysId;if(s){this.columns[s]=[];let t=this.columns[s];for(let e=0;e<r;e++)t.push(s+"_"+e)}}getRowKeysColumn(){var e=this.rowKeysId;if(e)return this.columns[e]}getRowIndexOriginal(e){var t=this.rowKeysId;return t?(""+this.columns[t][e]).split("_")[1]:String(e)}setModifier(t,r){let s=this;return s.emit({type:"setModifier",detail:r,modifier:t,modified:s.modified}),(((s.modified=s).modifier=t)?t.modify(s):Promise.resolve(s)).then(e=>(e.emit({type:"afterSetModifier",detail:r,modifier:t,modified:e.modified}),e)).catch(e=>{throw s.emit({type:"setModifierError",error:e,modifier:t,modified:s.modified}),e})}setRow(e,t,r){this.setRows([e],t,r)}setRows(t,r=this.rowCount,e){let n=this.aliases,i=this.columns,a=Object.keys(i),s=this.modifier,l=t.length;this.emit({type:"setRows",detail:e,rowCount:l,rowIndex:r,rows:t});for(let e=0,s=r,o;e<l;++e,++s)if((o=t[e])===h.NULL)for(let e=0,t=a.length;e<t;++e)i[a[e]][s]=null;else if(o instanceof Array)for(let e=0,t=a.length;e<t;++e)i[a[e]][s]=o[e];else{var u=Object.keys(o);for(let e=0,t=u.length,r;e<t;++e)i[r=n[r=u[e]]||r]||(i[r]=Array(s+1)),i[r][s]=o[r]}var o=r+l;if(o>this.rowCount){this.rowCount=o;for(let e=0,t=a.length;e<t;++e)i[a[e]].length=o}this.rowKeysId&&!a.includes(this.rowKeysId)&&this.setRowKeysColumn(l),s&&s.modifyRows(this,t,r),this.emit({type:"afterSetRows",detail:e,rowCount:l,rowIndex:r,rows:t})}moveRowKeysColumnToLast(e,t){var r=e[t];delete e[t],e[t]=r}removeRowKeysColumn(e){this.rowKeysId&&-1!==e.indexOf(this.rowKeysId)&&e.pop()}}return h.NULL={},h.version="1.0.0",h}),t(e,"Data/Connectors/DataConnector.js",[e["Data/Modifiers/DataModifier.js"],e["Data/DataTable.js"],e["Core/Utilities.js"]],function(r,t,e){var s;let{addEvent:o,fireEvent:n,merge:i,pick:a}=e;class l{constructor(e={}){this.table=new t(e.dataTable),this.metadata=e.metadata||{columns:{}}}get polling(){return!!this.polling}describeColumn(e,t){let r=this.metadata.columns;r[e]=i(r[e]||{},t)}describeColumns(e){var t;let r=Object.keys(e);for(;"string"==typeof(t=r.pop());)this.describeColumn(t,e[t])}emit(e){n(this,e.type,e)}getColumnOrder(e){let r=this.metadata.columns,t=Object.keys(r||{});if(t.length)return t.sort((e,t)=>a(r[e].index,0)-a(r[t].index,0))}getSortedColumns(e){return this.table.getColumns(this.getColumnOrder(e))}load(){return n(this,"afterLoad",{table:this.table}),Promise.resolve(this)}on(e,t){return o(this,e,t)}save(){return n(this,"saveError",{table:this.table}),Promise.reject(Error("Not implemented"))}setColumnOrder(r){for(let e=0,t=r.length;e<t;++e)this.describeColumn(r[e],{index:e})}setModifierOptions(e){let t=e&&r.types[e.type];return this.table.setModifier(t?new t(e):void 0).then(()=>this)}startPolling(e=1e3){let t=this;window.clearTimeout(t._polling),t._polling=window.setTimeout(()=>t.load().catch(e=>t.emit({type:"loadError",error:e,table:t.table})).then(()=>{t._polling&&t.startPolling(e)}),e)}stopPolling(){window.clearTimeout(this._polling),delete this._polling}whatIs(e){return this.metadata.columns[e]}}return(s=l=l||{}).types={},s.registerType=function(e,t){return!!e&&!s.types[e]&&!!(s.types[e]=t)},l}),t(e,"Data/Converters/DataConverter.js",[e["Data/DataTable.js"],e["Core/Utilities.js"]],function(e,t){let{addEvent:r,fireEvent:s,isNumber:l,merge:o}=t;class n{constructor(e){this.dateFormats={"YYYY/mm/dd":{regex:/^(\d{4})([\-\.\/])(\d{1,2})\2(\d{1,2})$/,parser:function(e){return e?Date.UTC(+e[1],e[3]-1,+e[4]):NaN}},"dd/mm/YYYY":{regex:/^(\d{1,2})([\-\.\/])(\d{1,2})\2(\d{4})$/,parser:function(e){return e?Date.UTC(+e[4],e[3]-1,+e[1]):NaN},alternative:"mm/dd/YYYY"},"mm/dd/YYYY":{regex:/^(\d{1,2})([\-\.\/])(\d{1,2})\2(\d{4})$/,parser:function(e){return e?Date.UTC(+e[4],e[1]-1,+e[3]):NaN}},"dd/mm/YY":{regex:/^(\d{1,2})([\-\.\/])(\d{1,2})\2(\d{2})$/,parser:function(e){let t=new Date;if(!e)return NaN;let r=+e[4];return r>t.getFullYear()-2e3?r+=1900:r+=2e3,Date.UTC(r,e[3]-1,+e[1])},alternative:"mm/dd/YY"},"mm/dd/YY":{regex:/^(\d{1,2})([\-\.\/])(\d{1,2})\2(\d{2})$/,parser:function(e){return e?Date.UTC(+e[4]+2e3,e[1]-1,+e[3]):NaN}}};let t=o(n.defaultOptions,e),r=t.decimalPoint;"."!==r&&","!==r||(r="."===r?"\\.":",",this.decimalRegExp=RegExp("^(-?[0-9]+)"+r+"([0-9]+)$")),this.options=t}asBoolean(e){return"boolean"==typeof e?e:"string"==typeof e?""!==e&&"0"!==e&&"false"!==e:!!this.asNumber(e)}asDate(e){let t;if("string"==typeof e)t=this.parseDate(e);else if("number"==typeof e)t=e;else{if(e instanceof Date)return e;t=this.parseDate(this.asString(e))}return new Date(t)}asGuessedType(e){return{number:this.asNumber,Date:this.asDate,string:this.asString}[this.guessType(e)].call(this,e)}asNumber(t){if("number"==typeof t)return t;if("boolean"==typeof t)return t?1:0;if("string"!=typeof t)return t instanceof Date?t.getDate():t?t.getRowCount():NaN;{let e=this.decimalRegExp;if(-1<t.indexOf(" ")&&(t=t.replace(/\s+/g,"")),e){if(!e.test(t))return NaN;t=t.replace(e,"$1.$2")}return parseFloat(t)}}asString(e){return""+e}deduceDateFormat(e,t,r){let s=[],o=[],n="YYYY/mm/dd",i,a=[],l=0,u=!1,m,h;for((!t||t>e.length)&&(t=e.length);l<t;l++)if(void 0!==e[l]&&e[l]&&e[l].length)for(h=0,i=e[l].trim().replace(/[\-\.\/]/g," ").split(" "),a=["","",""];h<i.length;h++)h<a.length&&(m=parseInt(i[h],10))&&(o[h]=!o[h]||o[h]<m?m:o[h],void 0!==s[h]?s[h]!==m&&(s[h]=!1):s[h]=m,31<m?m<100?a[h]="YY":a[h]="YYYY":12<m&&m<=31?(a[h]="dd",u=!0):a[h].length||(a[h]="mm"));if(u){for(h=0;h<s.length;h++)!1!==s[h]?12<o[h]&&"YY"!==a[h]&&"YYYY"!==a[h]&&(a[h]="YY"):12<o[h]&&"mm"===a[h]&&(a[h]="dd");3===a.length&&"dd"===a[1]&&"dd"===a[2]&&(a[2]="YY"),n=a.join("/")}return r&&(this.options.dateFormat=n),n}emit(e){s(this,e.type,e)}export(e,t){throw this.emit({type:"exportError",columns:[],headers:[]}),Error("Not implemented")}getTable(){throw Error("Not implemented")}guessType(s){let o="string";if("string"==typeof s){let e=this.trim(""+s),t=this.decimalRegExp,r=this.trim(e,!0);t&&(r=t.test(r)?r.replace(t,"$1.$2"):"");var n=parseFloat(r);+r===n?s=n:o=l(this.parseDate(s))?"Date":"string"}return o="number"==typeof s?31536e6<s?"Date":"number":o}on(e,t){return r(this,e,t)}parse(e){throw this.emit({type:"parseError",columns:[],headers:[]}),Error("Not implemented")}parseDate(e,t){let r=this.options,s=t||r.dateFormat,o=NaN,n,i,a;if(r.parseDate)o=r.parseDate(e);else{if(s)(i=this.dateFormats[s])||(i=this.dateFormats["YYYY/mm/dd"]),(a=e.match(i.regex))&&(o=i.parser(a));else for(n in this.dateFormats)if(i=this.dateFormats[n],a=e.match(i.regex)){s=n,o=i.parser(a);break}a||("object"==typeof(a=Date.parse(e))&&null!==a&&a.getTime?o=a.getTime()-6e4*a.getTimezoneOffset():l(a)&&(o=a-6e4*new Date(a).getTimezoneOffset(),-1===e.indexOf("2001")&&2001===new Date(o).getFullYear()&&(o=NaN)))}return o}trim(e,t){return"string"==typeof e&&(e=e.replace(/^\s+|\s+$/g,""),t&&/^[\d\s]+$/.test(e)&&(e=e.replace(/\s/g,""))),e}}return n.defaultOptions={dateFormat:"",alternativeFormat:"",startColumn:0,endColumn:Number.MAX_VALUE,startRow:0,endRow:Number.MAX_VALUE,firstRowAsNames:!0,switchRowsAndColumns:!1},(n=n||{}).getTableFromColumns=function(r=[],s=[]){let o=new e;for(let e=0,t=Math.max(s.length,r.length);e<t;++e)o.setColumn(s[e]||""+e,r[e]);return o},n}),t(e,"Data/DataCursor.js",[],function(){class h{constructor(e={}){this.emittingRegister=[],this.listenerMap={},this.stateMap=e}addListener(e,t,r){let s=this.listenerMap[e]=this.listenerMap[e]||{};return(s[t]=s[t]||[]).push(r),this}buildEmittingTag(e){return("position"===e.cursor.type?[e.table.id,e.cursor.column,e.cursor.row,e.cursor.state,e.cursor.type]:[e.table.id,e.cursor.columns,e.cursor.firstRow,e.cursor.lastRow,e.cursor.state,e.cursor.type]).join("\0")}emitCursor(n,i,a,l){let u=n.id,e=i.state,m=this.listenerMap[u]&&this.listenerMap[u][e];if(m){let e=this.stateMap[u]=this.stateMap[u]??{},t=e[i.state]||[],r=(l&&(t.length||(e[i.state]=t),-1===h.getIndex(i,t)&&t.push(i)),{cursor:i,cursors:t,table:n}),s=(a&&(r.event=a),this.emittingRegister),o=this.buildEmittingTag(r);if(0<=s.indexOf(o))return this;try{this.emittingRegister.push(o);for(let e=0,t=m.length;e<t;++e)m[e].call(this,r)}finally{l=this.emittingRegister.indexOf(o);0<=l&&this.emittingRegister.splice(l,1)}}return this}remitCursor(e,t){let r=this.stateMap[e]&&this.stateMap[e][t.state];return r&&0<=(e=h.getIndex(t,r))&&r.splice(e,1),this}removeListener(e,t,r){let s=this.listenerMap[e]&&this.listenerMap[e][t];return s&&0<=(e=s.indexOf(r))&&s.splice(e,1),this}}return h.version="1.0.0",(e=h=h||{}).getIndex=function(s,o){if("position"===s.type){for(let e,t=0,r=o.length;t<r;++t)if("position"===(e=o[t]).type&&e.state===s.state&&e.column===s.column&&e.row===s.row)return t}else{var n=JSON.stringify(s.columns);for(let e,t=0,r=o.length;t<r;++t)if("range"===(e=o[t]).type&&e.state===s.state&&e.firstRow===s.firstRow&&e.lastRow===s.lastRow&&JSON.stringify(e.columns)===n)return t}return-1},e.isEqual=function(e,t){return"position"===e.type&&"position"===t.type?e.column===t.column&&e.row===t.row&&e.state===t.state:"range"===e.type&&"range"===t.type&&e.firstRow===t.firstRow&&e.lastRow===t.lastRow&&JSON.stringify(e.columns)===JSON.stringify(t.columns)},e.isInRange=function(e,t){"position"===t.type&&(t=o(t));let r=(e="position"===e.type?o(e,t):e).columns,s=t.columns;return e.firstRow>=t.firstRow&&e.lastRow<=t.lastRow&&(!r||!s||r.every(e=>0<=s.indexOf(e)))},e.toPositions=function(t){if("position"===t.type)return[t];let s=t.columns||[],o=[],n=t.state;for(let r=t.firstRow,e=t.lastRow;r<e;++r)if(s.length)for(let e=0,t=s.length;e<t;++e)o.push({type:"position",column:s[e],row:r,state:n});else o.push({type:"position",row:r,state:n});return o},e.toRange=o,h;function o(e,t){if("range"===e.type)return e;let r={type:"range",firstRow:e.row??(t&&t.firstRow)??0,lastRow:e.row??(t&&t.lastRow)??Number.MAX_VALUE,state:e.state};return void 0!==e.column&&(r.columns=[e.column]),r}var e}),t(e,"Data/DataPoolDefaults.js",[],function(){return{connectors:[]}}),t(e,"Data/DataPool.js",[e["Data/Connectors/DataConnector.js"],e["Data/DataPoolDefaults.js"],e["Core/Utilities.js"]],function(o,t,r){class e{constructor(e=t){e.connectors=e.connectors||[],this.connectors={},this.options=e,this.waiting={}}emit(e){r.fireEvent(this,e.type,e)}getConnector(e){var t=this.connectors[e];if(t)return Promise.resolve(t);let s=this.waiting[e];if(!s){s=this.waiting[e]=[];t=this.getConnectorOptions(e);if(!t)throw Error(`Connector '${e}' not found.`);this.loadConnector(t).then(r=>{delete this.waiting[e];for(let e=0,t=s.length;e<t;++e)s[e][0](r)}).catch(r=>{delete this.waiting[e];for(let e=0,t=s.length;e<t;++e)s[e][1](r)})}return new Promise((e,t)=>{s.push([e,t])})}getConnectorIds(){let r=this.options.connectors,s=[];for(let e=0,t=r.length;e<t;++e)s.push(r[e].id);return s}getConnectorOptions(r){var s=this.options.connectors;for(let e=0,t=s.length;e<t;++e)if(s[e].id===r)return s[e]}getConnectorTable(e){return this.getConnector(e).then(e=>e.table)}isNewConnector(e){return!this.connectors[e]}loadConnector(s){return new Promise((t,e)=>{this.emit({type:"load",options:s});let r=o.types[s.type];if(!r)throw Error(`Connector type not found. (${s.type})`);new r(s.options).load().then(e=>{this.connectors[s.id]=e,this.emit({type:"afterLoad",options:s}),t(e)}).catch(e)})}on(e,t){return r.addEvent(this,e,t)}setConnectorOptions(r){let s=this.options.connectors,e=this.connectors;this.emit({type:"setConnectorOptions",options:r});for(let e=0,t=s.length;e<t;++e)if(s[e].id===r.id){s.splice(e,1);break}e[r.id]&&(e[r.id].stopPolling(),delete e[r.id]),s.push(r),this.emit({type:"afterSetConnectorOptions",options:r})}}return e.version="1.0.0",e}),t(e,"Data/Formula/FormulaParser.js",[],function(){let t=/^(?:FALSE|TRUE)/,l=/^[+\-]?\d+(?:\.\d+)?(?:e[+\-]\d+)?/,u=/^[+\-]?\d+(?:,\d+)?(?:e[+\-]\d+)?/,m=/^([A-Z][A-Z\d\.]*)\(/,h=/^(?:[+\-*\/^<=>]|<=|=>)/,r=/^(\$?[A-Z]+)(\$?\d+)\:(\$?[A-Z]+)(\$?\d+)/,s=/^R(\d*|\[\d+\])C(\d*|\[\d+\])\:R(\d*|\[\d+\])C(\d*|\[\d+\])/,c=/^(\$?[A-Z]+)(\$?\d+)(?![\:C])/,f=/^R(\d*|\[\d+\])C(\d*|\[\d+\])(?!\:)/;function d(o){let n=0;for(let e=0,t=o.length,r,s=1;e<t;++e)if("("===(r=o[e]))n||(s=e+1),++n;else if(")"===r&&!--n)return o.substring(s,e);if(0<n){let e=Error("Incomplete parantheses.");throw e.name="FormulaParseError",e}return""}function g(o){let n=-1;for(let e=0,t=o.length,r,s=!1;e<t;++e)if("\\"===(r=o[e]))s=!s;else if(s)s=!1;else if('"'===r){if(!(n<0))return o.substring(n+1,e);n=e}let e=Error("Incomplete string.");throw e.name="FormulaParseError",e}function p(e,t){let n;if(n=e.match(s)){let e=""===n[2]||"["===n[2][0],t=""===n[1]||"["===n[1][0],r=""===n[4]||"["===n[4][0],s=""===n[3]||"["===n[3][0],o={type:"range",beginColumn:e?parseInt(n[2].substring(1,-1)||"0",10):parseInt(n[2],10)-1,beginRow:t?parseInt(n[1].substring(1,-1)||"0",10):parseInt(n[1],10)-1,endColumn:r?parseInt(n[4].substring(1,-1)||"0",10):parseInt(n[4],10)-1,endRow:s?parseInt(n[3].substring(1,-1)||"0",10):parseInt(n[3],10)-1};return e&&(o.beginColumnRelative=!0),t&&(o.beginRowRelative=!0),r&&(o.endColumnRelative=!0),s&&(o.endRowRelative=!0),o}if(n=e.match(r)){let e="$"!==n[1][0],t="$"!==n[2][0],r="$"!==n[3][0],s="$"!==n[4][0],o={type:"range",beginColumn:C(e?n[1]:n[1].substring(1))-1,beginRow:parseInt(t?n[2]:n[2].substring(1),10)-1,endColumn:C(r?n[3]:n[3].substring(1))-1,endRow:parseInt(s?n[4]:n[4].substring(1),10)-1};return e&&(o.beginColumnRelative=!0),t&&(o.beginRowRelative=!0),r&&(o.endColumnRelative=!0),s&&(o.endRowRelative=!0),o}e=y(e,t);return 1===e.length&&"string"!=typeof e[0]?e[0]:e}function y(r,s){let e=s?u:l,o=[],n,i=("="===r[0]?r.substring(1):r).trim();for(;i;)if(n=i.match(f)){let e=""===n[2]||"["===n[2][0],t=""===n[1]||"["===n[1][0],r={type:"reference",column:e?parseInt(n[2].substring(1,-1)||"0",10):parseInt(n[2],10)-1,row:t?parseInt(n[1].substring(1,-1)||"0",10):parseInt(n[1],10)-1};e&&(r.columnRelative=!0),t&&(r.rowRelative=!0),o.push(r),i=i.substring(n[0].length).trim()}else if(n=i.match(c)){let e="$"!==n[1][0],t="$"!==n[2][0],r={type:"reference",column:C(e?n[1]:n[1].substring(1))-1,row:parseInt(t?n[2]:n[2].substring(1),10)-1};e&&(r.columnRelative=!0),t&&(r.rowRelative=!0),o.push(r),i=i.substring(n[0].length).trim()}else if(n=i.match(h))o.push(n[0]),i=i.substring(n[0].length).trim();else if(n=i.match(t))o.push("TRUE"===n[0]),i=i.substring(n[0].length).trim();else if(n=i.match(e))o.push(parseFloat(n[0])),i=i.substring(n[0].length).trim();else if('"'===i[0]){let e=g(i);o.push(e.substring(1,-1)),i=i.substring(e.length+2).trim()}else{if(!(n=i.match(m))){if("("===i[0]){var a=d(i);if(a){o.push(y(a,s)),i=i.substring(a.length+2).trim();continue}}let e=r.length-i.length,t=Error("Unexpected character `"+r.substring(e,1+e)+"` at position "+(1+e)+". (`..."+r.substring(e-5,6+e)+"...`)");throw t.name="FormulaParseError",t}a=d(i=i.substring(n[1].length).trim());o.push({type:"function",name:n[1],args:function(s,o){let n=[],i=o?";":",",a=0,l="";for(let e=0,t=s.length,r;e<t;++e){var u;(r=s[e])===i&&!a&&l?(n.push(p(l,o)),l=""):'"'!==r||a||l?" "!==r&&(l+=r,"("===r?++a:")"===r&&--a):(u=g(s.substring(e)),n.push(u),e+=u.length+1)}return!a&&l&&n.push(p(l,o)),n}(a,s)}),i=i.substring(a.length+2).trim()}return o}function C(o){let n=0;for(let e=0,t=o.length,r,s=o.length-1;e<t;++e)65<=(r=o.charCodeAt(e))&&r<=90&&(n+=(r-64)*Math.pow(26,s)),--s;return n}return{parseFormula:y}}),t(e,"Data/Formula/FormulaTypes.js",[],function(){let t=["+","-","*","/","^","=","<","<=",">",">="];return{isFormula:function(e){return e instanceof Array},isFunction:function(e){return"object"==typeof e&&!(e instanceof Array)&&"function"===e.type},isOperator:function(e){return"string"==typeof e&&0<=t.indexOf(e)},isRange:function(e){return"object"==typeof e&&!(e instanceof Array)&&"range"===e.type},isReference:function(e){return"object"==typeof e&&!(e instanceof Array)&&"reference"===e.type},isValue:function(e){return"boolean"==typeof e||"number"==typeof e||"string"==typeof e}}}),t(e,"Data/Formula/FormulaProcessor.js",[e["Data/Formula/FormulaTypes.js"]],function(e){let{isFormula:m,isFunction:h,isOperator:c,isRange:a,isReference:f,isValue:d}=e,t=/ */,r=Number.MAX_VALUE/1.000000000001,s=Number.MAX_VALUE/1.000000000002,o=Number.MAX_VALUE,g={"^":3,"*":2,"/":2,"+":1,"-":1,"=":0,"<":0,"<=":0,">":0,">=":0},n={},i=/^[A-Z][A-Z\.]*$/;function l(e){switch(typeof e){case"boolean":return e?o:r;case"string":return s;case"number":return e;default:return NaN}}function u(e){return"string"==typeof e?e.toLowerCase().replace(t,"\0"):e}function p(e){switch(typeof e){case"boolean":return e?1:0;case"string":return parseFloat(e.replace(",","."));case"number":return e;default:return NaN}}function y(e,t,r){let s;switch(e){case"=":return u(t)===u(r);case"<":return typeof t==typeof r?u(t)<u(r):l(t)<l(r);case"<=":return typeof t==typeof r?u(t)<=u(r):l(t)<=l(r);case">":return typeof t==typeof r?u(t)>u(r):l(t)>l(r);case">=":return typeof t==typeof r?u(t)>=u(r):l(t)>=l(r)}switch(t=p(t),r=p(r),e){case"+":s=t+r;break;case"-":s=t-r;break;case"*":s=t*r;break;case"/":s=t/r;break;case"^":s=Math.pow(t,r);break;default:return NaN}return s%1?Math.round(1e9*s)/1e9:s}function C(e,t){return d(e)?e:a(e)?t&&b(e,t)||[]:h(e)?v(e,t):D(m(e)?e:[e],t)}function b(o,n){let i=n.getColumnNames().slice(o.beginColumn,o.endColumn+1),a=[];for(let r=0,e=i.length,s;r<e;++r){var l=n.getColumn(i[r],!0)||[];for(let e=o.beginRow,t=o.endRow+1;e<t;++e)"string"==typeof(s=l[e])&&"="===s[0]&&n!==n.modified&&(s=n.modified.getCell(i[r],e)),a.push(d(s)?s:NaN)}return a}function w(e,t){var r,s=t.getColumnNames()[e.column];return s?"string"==typeof(r=t.getCell(s,e.row))&&"="===r[0]&&t!==t.modified?(t=t.modified.getCell(s,e.row),d(t)?t:NaN):d(r)?r:NaN:NaN}function D(i,a){let l;for(let e=0,t=i.length,r,s,o,n;e<t;++e)if(c(r=i[e]))s=r;else if(d(r)?n=r:m(r)?n=D(i,a):h(r)?n=d(o=v(r,a))?o:NaN:f(r)&&(n=a&&w(r,a)),void 0!==n){if(void 0===l)l=s?y(s,0,n):n;else{if(!s)return NaN;var u=i[e+1];c(u)&&g[u]>g[s]&&(n=y(u,n,D(i.slice(e+2))),e=t),l=y(s,l,n)}s=void 0,n=void 0}return d(l)?l:NaN}function v(e,t){let r=n[e.name];if(r)try{return r(e.args,t)}catch{return NaN}let s=Error(`Function "${e.name}" not found.`);throw s.name="FormulaProcessError",s}return{asNumber:p,getArgumentValue:C,getArgumentsValues:function(r,s){let o=[];for(let e=0,t=r.length;e<t;++e)o.push(C(r[e],s));return o},getRangeValues:b,getReferenceValue:w,processFormula:D,processorFunctions:n,registerProcessorFunction:function(e,t){return i.test(e)&&!n[e]&&!!(n[e]=t)},translateReferences:function s(o,n=0,i=0){for(let e=0,t=o.length,r;e<t;++e)(r=o[e])instanceof Array?s(r,n,i):h(r)?s(r.args,n,i):a(r)?(r.beginColumnRelative&&(r.beginColumn+=n),r.beginRowRelative&&(r.beginRow+=i),r.endColumnRelative&&(r.endColumn+=n),r.endRowRelative&&(r.endRow+=i)):f(r)&&(r.columnRelative&&(r.column+=n),r.rowRelative&&(r.row+=i));return o}}}),t(e,"Data/Formula/Functions/ABS.js",[e["Data/Formula/FormulaProcessor.js"]],function(e){let r=e["getArgumentValue"];function t(e,t){var o=r(e[0],t);switch(typeof o){case"number":return Math.abs(o);case"object":{let s=[];for(let e=0,t=o.length,r;e<t;++e){if("number"!=typeof(r=o[e]))return NaN;s.push(Math.abs(r))}return s}default:return NaN}}return e.registerProcessorFunction("ABS",t),t}),t(e,"Data/Formula/Functions/AND.js",[e["Data/Formula/FormulaProcessor.js"]],function(e){let n=e["getArgumentValue"];function i(s,o){for(let e=0,t=s.length,r;e<t;++e)if(!(r=n(s[e],o))||"object"==typeof r&&!i(r,o))return!1;return!0}return e.registerProcessorFunction("AND",i),i}),t(e,"Data/Formula/Functions/AVERAGE.js",[e["Data/Formula/FormulaProcessor.js"]],function(e){let s=e["getArgumentsValues"];function t(e,t){let r=s(e,t),o=0,n=0;for(let e=0,t=r.length,s;e<t;++e)switch(typeof(s=r[e])){case"number":isNaN(s)||(++o,n+=s);break;case"object":for(let e=0,t=s.length,r;e<t;++e)"number"!=typeof(r=s[e])||isNaN(r)||(++o,n+=r)}return o?n/o:0}return e.registerProcessorFunction("AVERAGE",t),t}),t(e,"Data/Formula/Functions/AVERAGEA.js",[e["Data/Formula/FormulaProcessor.js"]],function(e){let a=e["getArgumentValue"];function t(r,o){let n=0,i=0;for(let e=0,t=r.length,s;e<t;++e)switch(typeof(s=a(r[e],o))){case"boolean":++n,i+=s?1:0;continue;case"number":isNaN(s)||(++n,i+=s);continue;case"string":++n;continue;default:for(let e=0,t=s.length,r;e<t;++e)switch(typeof(r=s[e])){case"boolean":++n,i+=r?1:0;continue;case"number":isNaN(r)||(++n,i+=r);continue;case"string":++n;continue}continue}return n?i/n:0}return e.registerProcessorFunction("AVERAGEA",t),t}),t(e,"Data/Formula/Functions/COUNT.js",[e["Data/Formula/FormulaProcessor.js"]],function(t){function i(e,s){let o=t.getArgumentsValues(e,s),n=0;for(let e=0,t=o.length,r;e<t;++e)switch(typeof(r=o[e])){case"number":isNaN(r)||++n;break;case"object":n+=i(r,s)}return n}return t.registerProcessorFunction("COUNT",i),i}),t(e,"Data/Formula/Functions/COUNTA.js",[e["Data/Formula/FormulaProcessor.js"]],function(t){function i(e,s){let o=t.getArgumentsValues(e,s),n=0;for(let e=0,t=o.length,r;e<t;++e){switch(typeof(r=o[e])){case"number":if(isNaN(r))continue;break;case"object":n+=i(r,s);continue;case"string":if(!r)continue}++n}return n}return t.registerProcessorFunction("COUNTA",i),i}),t(e,"Data/Formula/Functions/IF.js",[e["Data/Formula/FormulaProcessor.js"]],function(e){let r=e["getArgumentValue"];function t(e,t){return r(e[0],t)?r(e[1],t):r(e[2],t)}return e.registerProcessorFunction("IF",t),t}),t(e,"Data/Formula/Functions/ISNA.js",[e["Data/Formula/FormulaProcessor.js"]],function(e){let r=e["getArgumentValue"];function t(e,t){e=r(e[0],t);return"number"!=typeof e||isNaN(e)}return e.registerProcessorFunction("ISNA",t),t}),t(e,"Data/Formula/Functions/MAX.js",[e["Data/Formula/FormulaProcessor.js"]],function(e){let r=e["getArgumentsValues"];function n(e,t){let s=r(e,t),o=Number.NEGATIVE_INFINITY;for(let e=0,t=s.length,r;e<t;++e)switch(typeof(r=s[e])){case"number":r>o&&(o=r);break;case"object":(r=n(r))>o&&(o=r)}return isFinite(o)?o:0}return e.registerProcessorFunction("MAX",n),n}),t(e,"Data/Formula/Functions/MEDIAN.js",[e["Data/Formula/FormulaProcessor.js"]],function(s){function e(e,t){let o=[],r=s.getArgumentsValues(e,t);for(let e=0,t=r.length,s;e<t;++e)switch(typeof(s=r[e])){case"number":isNaN(s)||o.push(s);break;case"object":for(let e=0,t=s.length,r;e<t;++e)"number"!=typeof(r=s[e])||isNaN(r)||o.push(r)}e=o.length;if(!e)return NaN;t=Math.floor(e/2);return e%2?o[t]:(o[t-1]+o[t])/2}return s.registerProcessorFunction("MEDIAN",e),e}),t(e,"Data/Formula/Functions/MIN.js",[e["Data/Formula/FormulaProcessor.js"]],function(e){let r=e["getArgumentsValues"];function n(e,t){let s=r(e,t),o=Number.POSITIVE_INFINITY;for(let e=0,t=s.length,r;e<t;++e)switch(typeof(r=s[e])){case"number":r<o&&(o=r);break;case"object":(r=n(r))<o&&(o=r)}return isFinite(o)?o:0}return e.registerProcessorFunction("MIN",n),n}),t(e,"Data/Formula/Functions/MOD.js",[e["Data/Formula/FormulaProcessor.js"]],function(e){let o=e["getArgumentValue"];function t(e,t){let r=o(e[0],t),s=o(e[1],t);return"object"==typeof r&&(r=r[0]),"object"==typeof s&&(s=s[0]),"number"!=typeof r||"number"!=typeof s||0===s?NaN:r%s}return e.registerProcessorFunction("MOD",t),t}),t(e,"Data/Formula/Functions/MODE.js",[e["Data/Formula/FormulaProcessor.js"]],function(s){function r(e,t){let o={},r=s.getArgumentsValues(e,t);for(let e=0,t=r.length,s;e<t;++e)switch(typeof(s=r[e])){case"number":isNaN(s)||(o[s]=(o[s]||0)+1);break;case"object":for(let e=0,t=s.length,r;e<t;++e)"number"!=typeof(r=s[e])||isNaN(r)||(o[r]=(o[r]||0)+1)}return o}function e(e,t){var o=r(e,t),n=Object.keys(o);if(!n.length)return NaN;let i=[parseFloat(n[0])],a=o[n[0]];for(let e=1,t=n.length,r,s;e<t;++e)a<(s=o[r=n[e]])?(i=[parseFloat(r)],a=s):a===s&&i.push(parseFloat(r));return 1<a?i:NaN}function t(e,t){var n=r(e,t),i=Object.keys(n);if(!i.length)return NaN;let a=parseFloat(i[0]),l=n[i[0]];for(let e=1,t=i.length,r,s,o;e<t;++e)l<(o=n[r=i[e]])?(a=parseFloat(r),l=o):l===o&&a>(s=parseFloat(r))&&(a=s,l=o);return 1<l?a:NaN}return s.registerProcessorFunction("MODE",t),s.registerProcessorFunction("MODE.MULT",e),s.registerProcessorFunction("MODE.SNGL",t),{MULT:e,SNGL:t}}),t(e,"Data/Formula/Functions/NOT.js",[e["Data/Formula/FormulaProcessor.js"]],function(e){let s=e["getArgumentValue"];function t(e,t){let r=s(e[0],t);switch(typeof(r="object"==typeof r?r[0]:r)){case"boolean":case"number":return!r}return NaN}return e.registerProcessorFunction("NOT",t),t}),t(e,"Data/Formula/Functions/OR.js",[e["Data/Formula/FormulaProcessor.js"]],function(e){let n=e["getArgumentValue"];function i(s,o){for(let e=0,t=s.length,r;e<t;++e)if("object"==typeof(r=n(s[e],o))){if(i(r,o))return!0}else if(r)return!0;return!1}return e.registerProcessorFunction("OR",i),i}),t(e,"Data/Formula/Functions/PRODUCT.js",[e["Data/Formula/FormulaProcessor.js"]],function(e){let t=e["getArgumentsValues"];function a(e,s){let o=t(e,s),n=1,i=!1;for(let e=0,t=o.length,r;e<t;++e)switch(typeof(r=o[e])){case"number":isNaN(r)||(i=!0,n*=r);break;case"object":i=!0,n*=a(r,s)}return i?n:0}return e.registerProcessorFunction("PRODUCT",a),a}),t(e,"Data/Formula/Functions/SUM.js",[e["Data/Formula/FormulaProcessor.js"]],function(t){function i(e,s){let o=t.getArgumentsValues(e,s),n=0;for(let e=0,t=o.length,r;e<t;++e)switch(typeof(r=o[e])){case"number":isNaN(r)||(n+=r);break;case"object":n+=i(r,s)}return n}return t.registerProcessorFunction("SUM",i),i}),t(e,"Data/Formula/Functions/XOR.js",[e["Data/Formula/FormulaProcessor.js"]],function(e){let i=e["getArgumentValue"];function t(r,n){for(let e=0,t=r.length,s,o;e<t;++e)switch(typeof(o=i(r[e],n))){case"boolean":case"number":if(void 0===s)s=!!o;else if(!!o!==s)return!0;break;case"object":for(let e=0,t=o.length,r;e<t;++e)switch(typeof(r=o[e])){case"boolean":case"number":if(void 0===s)s=!!r;else if(!!r!==s)return!0}}return!1}return e.registerProcessorFunction("XOR",t),t}),t(e,"Data/Formula/Formula.js",[e["Data/Formula/FormulaParser.js"],e["Data/Formula/FormulaProcessor.js"],e["Data/Formula/FormulaTypes.js"]],function(e,t,r){return{...e,...t,...r}}),t(e,"Data/Converters/CSVConverter.js",[e["Data/Converters/DataConverter.js"],e["Core/Utilities.js"]],function(e,t){let d=t["merge"];class r extends e{constructor(e){e=d(r.defaultOptions,e);super(e),this.columns=[],this.headers=[],this.dataTypes=[],this.options=e}export(e,t=this.options){let{useLocalDecimalPoint:r,lineDelimiter:s}=t,o=!1!==this.options.firstRowAsNames,{decimalPoint:n,itemDelimiter:i}=t,a=(n=n||(","!==i&&r?1.1.toLocaleString()[1]:"."),i=i||(","===n?";":","),e.getSortedColumns(t.usePresentationOrder)),l=Object.keys(a),u=[],m=l.length,h=[];o&&u.push(l.map(e=>`"${e}"`).join(i));for(let s=0;s<m;s++){let r;var c=l[s],f=a[c],d=f.length,c=e.whatIs(c);c&&(r=c.dataType);for(let t=0;t<d;t++){let e=f[t];if(h[t]||(h[t]=[]),"string"===r?e='"'+e+'"':"number"==typeof e?e=String(e).replace(".",n):"string"==typeof e&&(e=`"${e}"`),h[t][s]=e,s===m-1){let e=s;for(;2<h[t].length&&void 0===h[t][e];)h[t].pop(),e--;u.push(h[t].join(i))}}}return u.join(s)}parse(e,t){let r=this.dataTypes,s=d(this.options,e),{beforeParse:o,lineDelimiter:n,firstRowAsNames:i,itemDelimiter:a}=s,l,u=0,{csv:m,startRow:h,endRow:c}=s,f;if(this.columns=[],this.emit({type:"parse",columns:this.columns,detail:t,headers:this.headers}),m=m&&o?o(m):m){if(l=m.replace(/\r\n|\r/g,"\n").split(n||"\n"),(!h||h<0)&&(h=0),(!c||c>=l.length)&&(c=l.length-1),a||(this.guessedItemDelimiter=this.guessDelimiter(l)),i){let t=l[0].split(a||this.guessedItemDelimiter||",");for(let e=0;e<t.length;e++)t[e]=t[e].trim().replace(/^["']|["']$/g,"");this.headers=t,h++}let e=0;for(u=h;u<=c;u++)"#"===l[u][0]?e++:this.parseCSVRow(l[u],u-h-e);r.length&&r[0].length&&"date"===r[0][1]&&!this.options.dateFormat&&this.deduceDateFormat(this.columns[0],null,!0);for(let r=0,e=this.columns.length;r<e;++r)for(let t=0,e=(f=this.columns[r]).length;t<e;++t)if(f[t]&&"string"==typeof f[t]){let e=this.asGuessedType(f[t]);e instanceof Date&&(e=e.getTime()),this.columns[r][t]=e}}this.emit({type:"afterParse",columns:this.columns,detail:t,headers:this.headers})}parseCSVRow(t,r){let s=this,o=s.columns||[],n=s.dataTypes,{startColumn:i,endColumn:a}=s.options,e=s.options.itemDelimiter||s.guessedItemDelimiter,l=s.options["decimalPoint"],u=(l&&l!==e||(l=s.guessedDecimalPoint||"."),0),m="",h="",c=0,f=0,d=e=>{m=t[e]},g=e=>{n.length<f+1&&n.push([e]),n[f][n[f].length-1]!==e&&n[f].push(e)},p=()=>{if(i>c||c>a)return++c,void(h="");var e;"string"==typeof h?!isNaN(parseFloat(h))&&isFinite(h)?(h=parseFloat(h),g("number")):isNaN(Date.parse(h))?g("string"):(h=h.replace(/\//g,"-"),g("date")):g("number"),o.length<f+1&&o.push([]),"number"!=typeof h&&"number"!==s.guessType(h)&&l&&(h=(e=h).replace(l,"."),"number"!==s.guessType(h)&&(h=e)),o[f][r]=h,h="",++f,++c};if(t.trim().length&&"#"!==t.trim()[0]){for(;u<t.length;u++){if(d(u),"#"===m&&!/^#[A-F\d]{3,3}|[A-F\d]{6,6}/i.test(t.substring(u)))return void p();if('"'===m)for(d(++u);u<t.length&&'"'!==m;)h+=m,d(++u);else m===e?p():h+=m}p()}}guessDelimiter(i){let a=0,l=0,e,u={",":0,";":0,"\t":0},t=i.length;for(let e=0;e<t;e++){let t=!1,r,s,o,n="";if(13<e)break;var m=i[e];for(let e=0;e<m.length&&(r=m[e],s=m[e+1],o=m[e-1],"#"!==r);e++){if('"'===r)if(t){if('"'!==o&&'"'!==s){for(;" "===s&&e<m.length;)s=m[++e];void 0!==u[s]&&u[s]++,t=!1}}else t=!0;else void 0!==u[r]?(isNaN(Date.parse(n=n.trim()))&&!isNaN(Number(n))&&isFinite(Number(n))||u[r]++,n=""):n+=r;","===r&&l++,"."===r&&a++}}return e=u[";"]>u[","]?";":(u[","],u[";"],","),a>l?this.guessedDecimalPoint=".":this.guessedDecimalPoint=",",e}getTable(){return e.getTableFromColumns(this.columns,this.headers)}}return r.defaultOptions={...e.defaultOptions,lineDelimiter:"\n"},r}),t(e,"Data/Connectors/CSVConnector.js",[e["Data/Converters/CSVConverter.js"],e["Data/Connectors/DataConnector.js"],e["Core/Utilities.js"]],function(t,e,r){let s=r["merge"];class o extends e{constructor(e){e=s(o.defaultOptions,e);super(e),this.converter=new t(e),(this.options=e).enablePolling&&this.startPolling(1e3*Math.max(e.dataRefreshRate||0,1))}load(t){let r=this,s=r.converter,o=r.table,{csv:e,csvURL:n,dataModifier:i}=r.options;return r.emit({type:"load",csv:e,detail:t,table:o}),Promise.resolve(n?fetch(n).then(e=>e.text()):e||"").then(e=>(e&&(o.deleteColumns(),s.parse({csv:e}),o.setColumns(s.getTable().getColumns())),r.setModifierOptions(i).then(()=>e))).then(e=>(r.emit({type:"afterLoad",csv:e,detail:t,table:o}),r)).catch(e=>{throw r.emit({type:"loadError",detail:t,error:e,table:o}),e})}}return o.defaultOptions={csv:"",csvURL:"",enablePolling:!1,dataRefreshRate:1,firstRowAsNames:!0},e.registerType("CSV",o),o}),t(e,"Data/Converters/JSONConverter.js",[e["Data/Converters/DataConverter.js"],e["Data/DataTable.js"],e["Core/Utilities.js"]],function(e,t,r){let{error:l,isArray:u,merge:m,objectEach:h}=r;class s extends e{constructor(e){e=m(s.defaultOptions,e);super(e),this.columns=[],this.headers=[],this.options=e,this.table=new t}parse(e,t){let{beforeParse:r,orientation:s,firstRowAsNames:o,columnNames:n}=e=m(this.options,e),i=e.data;if(i){if(this.columns=[],this.emit({type:"parse",columns:this.columns,detail:t,headers:this.headers}),i=(i=r?r(i):i).slice(),"columns"===s)for(let t=0,e=i.length;t<e;t++){let e=i[t];if(!(e instanceof Array))return;this.headers instanceof Array?(o?this.headers.push(""+e.shift()):n&&n instanceof Array&&this.headers.push(n[t]),this.table.setColumn(this.headers[t]||t.toString(),e)):l("JSONConverter: Invalid `columnNames` option.",!1)}else if("rows"===s){o?this.headers=i.shift():n&&(this.headers=n);for(let e=0,t=i.length;e<t;e++){let s=i[e];if(u(s))for(let e=0,t=s.length;e<t;e++)this.columns.length<e+1&&this.columns.push([]),this.columns[e].push(s[e]),this.headers instanceof Array?this.table.setColumn(this.headers[e]||e.toString(),this.columns[e]):l("JSONConverter: Invalid `columnNames` option.",!1);else{var a=this.headers;if(a&&!(a instanceof Array)){let r={};h(a,(e,t)=>{r[t]=e.reduce((e,t)=>e[t],s)}),s=r}this.table.setRows([s],e)}}}this.emit({type:"afterParse",columns:this.columns,detail:t,headers:this.headers})}}getTable(){return this.table}}return s.defaultOptions={...e.defaultOptions,data:[],orientation:"rows"},s}),t(e,"Data/Connectors/JSONConnector.js",[e["Data/Connectors/DataConnector.js"],e["Core/Utilities.js"],e["Data/Converters/JSONConverter.js"]],function(e,t,r){let s=t["merge"];class o extends e{constructor(e){e=s(o.defaultOptions,e);super(e),this.converter=new r(e),(this.options=e).enablePolling&&this.startPolling(1e3*Math.max(e.dataRefreshRate||0,1))}load(t){let r=this,s=r.converter,o=r.table,{data:e,dataUrl:n,dataModifier:i}=r.options;return r.emit({type:"load",data:e,detail:t,table:o}),Promise.resolve(n?fetch(n).then(e=>e.json()):e||[]).then(e=>(e&&(o.deleteColumns(),s.parse({data:e}),o.setColumns(s.getTable().getColumns()),o.setRowKeysColumn(e.length)),r.setModifierOptions(i).then(()=>e))).then(e=>(r.emit({type:"afterLoad",data:e,detail:t,table:o}),r)).catch(e=>{throw r.emit({type:"loadError",detail:t,error:e,table:o}),e})}}return o.defaultOptions={data:[],enablePolling:!1,dataRefreshRate:0,firstRowAsNames:!0,orientation:"rows"},e.registerType("JSON",o),o}),t(e,"Data/Converters/GoogleSheetsConverter.js",[e["Data/Converters/DataConverter.js"],e["Core/Utilities.js"]],function(e,t){let{merge:a,uniqueKey:l}=t;class r extends e{constructor(e){e=a(r.defaultOptions,e);super(e),this.columns=[],this.header=[],this.options=e}parse(e,t){let s,o=a(this.options,e),n=(o.json?.values||[]).map(e=>e.slice());if(0===n.length)return!1;this.header=[],this.columns=[],this.emit({type:"parse",columns:this.columns,detail:t,headers:this.header});let{beforeParse:r,json:i}=o;r&&i&&(n=r(i.values));for(let r=0,e=(this.columns=n).length;r<e;r++){s=n[r],this.header[r]=o.firstRowAsNames?""+s.shift():l();for(let t=0,e=s.length;t<e;++t)if(s[t]&&"string"==typeof s[t]){let e=this.asGuessedType(s[t]);e instanceof Date&&(e=e.getTime()),this.columns[r][t]=e}}this.emit({type:"afterParse",columns:this.columns,detail:t,headers:this.header})}getTable(){return e.getTableFromColumns(this.columns,this.header)}}return r.defaultOptions={...e.defaultOptions},r}),t(e,"Data/Connectors/GoogleSheetsConnector.js",[e["Data/Connectors/DataConnector.js"],e["Data/Converters/GoogleSheetsConverter.js"],e["Core/Utilities.js"]],function(e,t,r){let{merge:s,pick:i}=r;class h extends e{constructor(e){e=s(h.defaultOptions,e);super(e),this.converter=new t(e),this.options=e}load(t){let r=this,s=r.converter,o=r.table,{dataModifier:n,dataRefreshRate:e,enablePolling:i,firstRowAsNames:a,googleAPIKey:l,googleSpreadsheetKey:u}=r.options,m=h.buildFetchURL(l,u,r.options);return r.emit({type:"load",detail:t,table:o,url:m}),fetch(m).then(e=>e.json()).then(e=>{if("object"==typeof e&&e&&"object"==typeof e.error&&e.error&&"number"==typeof e.error.code&&"string"==typeof e.error.message&&"string"==typeof e.error.status)throw Error(e.error.message);return s.parse({firstRowAsNames:a,json:e}),o.deleteColumns(),o.setColumns(s.getTable().getColumns()),r.setModifierOptions(n)}).then(()=>(r.emit({type:"afterLoad",detail:t,table:o,url:m}),i&&setTimeout(()=>r.load(),1e3*Math.max(e||0,1)),r)).catch(e=>{throw r.emit({type:"loadError",detail:t,error:e,table:o}),e})}}h.defaultOptions={googleAPIKey:"",googleSpreadsheetKey:"",worksheet:1,enablePolling:!1,dataRefreshRate:2,firstRowAsNames:!0};{r=h=h||{};let n="ABCDEFGHIJKLMNOPQRSTUVWXYZ";function o(e={}){var{endColumn:e,endRow:t,googleSpreadsheetRange:r,startColumn:s,startRow:o}=e;return r||(n[s||0]||"A")+(Math.max(o||0,0)+1)+":"+(n[i(e,25)]||"Z")+(t?Math.max(t,0):"Z")}r.buildFetchURL=function(e,t,r={}){return`https://sheets.googleapis.com/v4/spreadsheets/${t}/values/`+(r.onlyColumnNames?"A1:Z1":o(r))+"?alt=json"+(r.onlyColumnNames?"":"&dateTimeRenderOption=FORMATTED_STRING&majorDimension=COLUMNS&valueRenderOption=UNFORMATTED_VALUE")+"&prettyPrint=false&key="+e},r.buildQueryRange=o}return e.registerType("GoogleSheets",h),h}),t(e,"Data/Converters/HTMLTableConverter.js",[e["Data/Converters/DataConverter.js"],e["Core/Utilities.js"]],function(e,t){let r=t["merge"];class s extends e{constructor(e){e=r(s.defaultOptions,e);super(e),this.columns=[],this.headers=[],(this.options=e).tableElement&&(this.tableElement=e.tableElement,this.tableElementID=e.tableElement.id)}export(e,t=this.options){let r=!1!==t.firstRowAsNames,s=t.useMultiLevelHeaders,o=e.getSortedColumns(t.usePresentationOrder),n=Object.keys(o),i=[],a=n.length,l=[],u="";if(r){let e=[];if(s){for(var m of n){m=(o[m].shift()||"").toString();e.push(m)}u=this.getTableHeaderHTML(n,e,t)}else u=this.getTableHeaderHTML(void 0,n,t)}for(let r=0;r<a;r++){var h=o[n[r]],c=h.length;for(let t=0;t<c;t++){let e=h[t];l[t]||(l[t]=[]),"string"!=typeof e&&"number"!=typeof e&&void 0!==e&&(e=(e||"").toString()),l[t][r]=this.getCellHTMLFromValue(r?"td":"th",null,r?"":'scope="row"',e),r===a-1&&i.push("<tr>"+l[t].join("")+"</tr>")}}let f="";return"<table>"+(f=t.tableCaption?'<caption class="highcharts-table-caption">'+t.tableCaption+"</caption>":f)+u+"<tbody>"+i.join("")+"</tbody></table>"}getCellHTMLFromValue(e,t,r,s,o){let n=s,i="text"+(t?" "+t:"");return"number"==typeof n?(n=n.toString(),","===o&&(n=n.replace(".",o)),i="number"):s||(n="",i="empty"),"<"+e+(r?" "+r:"")+' class="'+i+'">'+n+"</"+e+">"}getTableHeaderHTML(e=[],t=[],r=this.options){let{useMultiLevelHeaders:s,useRowspanHeaders:o}=r,n="<thead>",i=0,a=t&&t.length,l,u=0,m;if(s&&e&&t&&!function(e,t){let r=e.length;if(t.length===r){for(;--r;)if(e[r]!==t[r])return;return 1}}(e,t)){for(n+="<tr>";i<a;++i)(l=e[i])===e[i+1]?++u:u?(n+=this.getCellHTMLFromValue("th","highcharts-table-topheading",'scope="col" colspan="'+(u+1)+'"',l),u=0):(l===t[i]?o?(m=2,delete t[i]):(m=1,t[i]=""):m=1,n+=this.getCellHTMLFromValue("th","highcharts-table-topheading",'scope="col"'+(1<m?' valign="top" rowspan="'+m+'"':""),l));n+="</tr>"}if(t){for(n+="<tr>",i=0,a=t.length;i<a;++i)void 0!==t[i]&&(n+=this.getCellHTMLFromValue("th",null,'scope="col"',t[i]));n+="</tr>"}return n+"</thead>"}parse(e,t){let l=[],s=[],o=r(this.options,e),{endRow:u,startColumn:m,endColumn:h,firstRowAsNames:c}=o,f=o.tableElement||this.tableElement;if(f instanceof HTMLElement){this.tableElement=f,this.tableElementID=f.id,this.emit({type:"parse",columns:this.columns,detail:t,headers:this.headers});let r=f.getElementsByTagName("tr"),e=r.length,n=0,i,a=o["startRow"];if(c&&e){var d=r[0].children,g=d.length;for(let e=m;e<g&&!(e>h);e++)"TD"!==(i=d[e]).tagName&&"TH"!==i.tagName||s.push(i.innerHTML);a++}for(;n<e;){if(n>=a&&n<=u){let e=r[n].children,t=e.length,o=0;for(;o<t;){let r=o-m,s=l[r];if(("TD"===(i=e[o]).tagName||"TH"===i.tagName)&&o>=m&&o<=h){l[r]||(l[r]=[]);let e=this.asGuessedType(i.innerHTML),t=(e instanceof Date&&(e=e.getTime()),l[r][n-a]=e,1);for(;n-a>=t&&void 0===s[n-a-t];)s[n-a-t]=null,t++}o++}}n++}this.columns=l,this.headers=s,this.emit({type:"afterParse",columns:l,detail:t,headers:s})}else this.emit({type:"parseError",columns:l,detail:t,headers:s,error:"Not a valid HTML Table"})}getTable(){return e.getTableFromColumns(this.columns,this.headers)}}return s.defaultOptions={...e.defaultOptions,useRowspanHeaders:!0,useMultiLevelHeaders:!0},s}),t(e,"Data/Connectors/HTMLTableConnector.js",[e["Data/Connectors/DataConnector.js"],e["Core/Globals.js"],e["Data/Converters/HTMLTableConverter.js"],e["Core/Utilities.js"]],function(e,t,r,s){let l=t["win"],u=s["merge"];class o extends e{constructor(e){e=u(o.defaultOptions,e);super(e),this.converter=new r(e),this.options=e}load(e){let t,r=this,s=r.converter,o=r.table,{dataModifier:n,table:i}=r.options;var a;return r.emit({type:"load",detail:e,table:o,tableElement:r.tableElement}),"string"==typeof i?(r.tableID=i,t=l.document.getElementById(i)):(t=i,r.tableID=t.id),r.tableElement=t||void 0,r.tableElement?(s.parse(u({tableElement:r.tableElement},r.options),e),o.deleteColumns(),o.setColumns(s.getTable().getColumns()),r.setModifierOptions(n).then(()=>(r.emit({type:"afterLoad",detail:e,table:o,tableElement:r.tableElement}),r))):(r.emit({type:"loadError",detail:e,error:a="HTML table not provided, or element with ID not found",table:o}),Promise.reject(Error(a)))}}return o.defaultOptions={table:""},e.registerType("HTMLTable",o),o}),t(e,"Data/Modifiers/ChainModifier.js",[e["Data/Modifiers/DataModifier.js"],e["Core/Utilities.js"]],function(i,e){let t=e["merge"];class r extends i{constructor(e,...o){super(),this.chain=o,this.options=t(r.defaultOptions,e);var n=this.options.chain||[];for(let e=0,t=n.length,r,s;e<t;++e)(r=n[e]).type&&(s=i.types[r.type])&&o.push(new s(r))}add(e,t){this.emit({type:"addModifier",detail:t,modifier:e}),this.chain.push(e),this.emit({type:"addModifier",detail:t,modifier:e})}clear(e){this.emit({type:"clearChain",detail:e}),this.chain.length=0,this.emit({type:"afterClearChain",detail:e})}modify(t,r){var s=this.options.reverse?this.chain.slice().reverse():this.chain.slice();t.modified===t&&(t.modified=t.clone(!1,r));let o=Promise.resolve(t);for(let e=0,t=s.length;e<t;++e){let t=s[e];o=o.then(e=>t.modify(e.modified,r))}return(o=o.then(e=>(t.modified.deleteColumns(),t.modified.setColumns(e.modified.getColumns()),t))).catch(e=>{throw this.emit({type:"error",detail:r,table:t}),e})}modifyCell(e,s,o,n,i){let a=this.options.reverse?this.chain.reverse():this.chain;if(a.length){let r=e.clone();for(let e=0,t=a.length;e<t;++e)a[e].modifyCell(r,s,o,n,i),r=r.modified;e.modified=r}return e}modifyColumns(e,s,o,n){let i=this.options.reverse?this.chain.reverse():this.chain.slice();if(i.length){let r=e.clone();for(let e=0,t=i.length;e<t;++e)i[e].modifyColumns(r,s,o,n),r=r.modified;e.modified=r}return e}modifyRows(e,s,o,n){let i=this.options.reverse?this.chain.reverse():this.chain.slice();if(i.length){let r=e.clone();for(let e=0,t=i.length;e<t;++e)i[e].modifyRows(r,s,o,n),r=r.modified;e.modified=r}return e}modifyTable(e,r){this.emit({type:"modify",detail:r,table:e});let s=this.options.reverse?this.chain.reverse():this.chain.slice(),o=e.modified;for(let e=0,t=s.length;e<t;++e)o=s[e].modifyTable(o,r).modified;return e.modified=o,this.emit({type:"afterModify",detail:r,table:e}),e}remove(e,t){let r=this.chain;this.emit({type:"removeModifier",detail:t,modifier:e}),r.splice(r.indexOf(e),1),this.emit({type:"afterRemoveModifier",detail:t,modifier:e})}}return r.defaultOptions={type:"Chain"},i.registerType("Chain",r),r}),t(e,"Data/Modifiers/InvertModifier.js",[e["Data/Modifiers/DataModifier.js"],e["Core/Utilities.js"]],function(e,t){let r=t["merge"];class s extends e{constructor(e){super(),this.options=r(s.defaultOptions,e)}modifyCell(e,t,r,s,o){let n=e.modified,i=n.getRowIndexBy("columnNames",t);return void 0===i?n.setColumns(this.modifyTable(e.clone()).getColumns(),void 0,o):n.setCell(""+r,i,s,o),e}modifyColumns(e,n,i,a){let l=e.modified,r=l.getColumn("columnNames")||[],u=e.getColumnNames(),s=e.getRowCount()!==r.length;if(!s)for(let e=0,t=u.length;e<t;++e)if(u[e]!==r[e]){s=!0;break}if(s)return this.modifyTable(e,a);for(let e=0,t=(u=Object.keys(n)).length,s,r,o;e<t;++e){s=n[r=u[e]],o=l.getRowIndexBy("columnNames",r)||l.getRowCount();for(let e=0,t=i,r=s.length;e<r;++e,++t)l.setCell(""+t,o,s[e],a)}return e}modifyRows(e,o,n,i){let a=e.getColumnNames(),l=e.modified,r=l.getColumn("columnNames")||[],s=e.getRowCount()!==r.length;if(!s)for(let e=0,t=a.length;e<t;++e)if(a[e]!==r[e]){s=!0;break}if(s)return this.modifyTable(e,i);for(let e=0,r=n,t=o.length,s;e<t;++e,++r)if((s=o[e])instanceof Array)l.setColumn(""+r,s);else for(let e=0,t=a.length;e<t;++e)l.setCell(""+r,e,s[a[e]],i);return e}modifyTable(n,e){this.emit({type:"modify",detail:e,table:n});let t=n.modified;if(n.hasColumns(["columnNames"])){let s=((n.deleteColumns(["columnNames"])||{}).columnNames||[]).map(e=>""+e),o={};for(let e=0,t=n.getRowCount(),r;e<t;++e)(r=n.getRow(e))&&(o[s[e]]=r);t.deleteColumns(),t.setColumns(o)}else{let s={};for(let e=0,t=n.getRowCount(),r;e<t;++e)(r=n.getRow(e))&&(s[""+e]=r);s.columnNames=n.getColumnNames(),t.deleteColumns(),t.setColumns(s)}return this.emit({type:"afterModify",detail:e,table:n}),n}}return s.defaultOptions={type:"Invert"},e.registerType("Invert",s),s}),t(e,"Data/Modifiers/MathModifier.js",[e["Data/Modifiers/DataModifier.js"],e["Data/Formula/FormulaParser.js"],e["Data/Formula/FormulaProcessor.js"]],function(e,l,a){class t extends e{constructor(e){super(),this.options={...t.defaultOptions,...e}}modifyTable(o,e){this.emit({type:"modify",detail:e,table:o});let n=this.options.alternativeSeparators,s=this.options.formulaColumns||o.getColumnNames(),i=o.modified;for(let e=0,t=s.length,r;e<t;++e)r=s[e],0<=s.indexOf(r)&&i.setColumn(r,this.processColumn(o,r));var a=this.options.columnFormulas||[];for(let e=0,t=a.length,r,s;e<t;++e)r=a[e],s=l.parseFormula(r.formula,n),i.setColumn(r.column,this.processColumnFormula(s,o,r.rowStart,r.rowEnd));return this.emit({type:"afterModify",detail:e,table:o}),o}processColumn(o,e,t=0){let n=this.options.alternativeSeparators,i=(o.getColumn(e,!0)||[]).slice(0<t?t:0);for(let e=0,t=i.length,r=[],s;e<t;++e)if("string"==typeof(s=i[e])&&"="===s[0])try{r=""===s?r:l.parseFormula(s.substring(1),n),i[e]=a.processFormula(r,o)}catch{i[e]=NaN}return i}processColumnFormula(r,e,s=0,o=e.getRowCount()){s=0<=s?s:0,o=0<=o?o:e.getRowCount()+o;let n=[],i=e.modified;for(let e=0,t=o-s;e<t;++e)try{n[e]=a.processFormula(r,i)}catch{n[e]=NaN}finally{r=a.translateReferences(r,0,1)}return n}}return t.defaultOptions={type:"Math",alternativeSeparators:!1},e.registerType("Math",t),t}),t(e,"Data/Modifiers/RangeModifier.js",[e["Data/Modifiers/DataModifier.js"],e["Core/Utilities.js"]],function(e,t){let r=t["merge"];class s extends e{constructor(e){super(),this.options=r(s.defaultOptions,e)}modifyTable(u,e){this.emit({type:"modify",detail:e,table:u});var{additive:m,ranges:r,strict:h}=this.options;if(r.length){let i=u.modified,a=u.getColumns(),l=[];for(let e=0,t=r.length,o,n;e<t;++e)if(o=r[e],!h||typeof o.minValue==typeof o.maxValue){0<e&&!m&&(i.deleteRows(),i.setRows(l),a=i.getColumns(),l=[]);for(let e=0,t=(n=a[o.column]||[]).length,r,s;e<t;++e){switch(typeof(r=n[e])){default:continue;case"boolean":case"number":case"string":}(!h||typeof r==typeof o.minValue)&&r>=o.minValue&&r<=o.maxValue&&(s=(m?u:i).getRow(e))&&l.push(s)}}i.deleteRows(),i.setRows(l)}return this.emit({type:"afterModify",detail:e,table:u}),u}}return s.defaultOptions={type:"Range",ranges:[]},e.registerType("Range",s),s}),t(e,"Data/Modifiers/SortModifier.js",[e["Data/Modifiers/DataModifier.js"],e["Data/DataTable.js"],e["Core/Utilities.js"]],function(e,a,t){let r=t["merge"];class h extends e{static ascending(e,t){return(e||0)<(t||0)?-1:(t||0)<(e||0)?1:0}static descending(e,t){return(t||0)<(e||0)?-1:(e||0)<(t||0)?1:0}constructor(e){super(),this.options=r(h.defaultOptions,e)}getRowReferences(e){let r=e.getRows(),s=[];for(let e=0,t=r.length;e<t;++e)s.push({index:e,row:r[e]});return s}modifyCell(e,t,r,s,o){var{orderByColumn:n,orderInColumn:i}=this.options;return t===n&&(i?(e.modified.setCell(t,r,s),e.modified.setColumn(i,this.modifyTable(new a({columns:e.getColumns([n,i])})).modified.getColumn(i))):this.modifyTable(e,o)),e}modifyColumns(e,t,r,s){let{orderByColumn:o,orderInColumn:n}=this.options,i=Object.keys(t);return-1<i.indexOf(o)&&(n&&t[i[0]].length?(e.modified.setColumns(t,r),e.modified.setColumn(n,this.modifyTable(new a({columns:e.getColumns([o,n])})).modified.getColumn(n))):this.modifyTable(e,s)),e}modifyRows(e,t,r,s){var{orderByColumn:o,orderInColumn:n}=this.options;return n&&t.length?(e.modified.setRows(t,r),e.modified.setColumn(n,this.modifyTable(new a({columns:e.getColumns([o,n])})).modified.getColumn(n))):this.modifyTable(e,s),e}modifyTable(e,t){this.emit({type:"modify",detail:t,table:e});let r=e.getColumnNames(),s=e.getRowCount(),o=this.getRowReferences(e),{direction:n,orderByColumn:i,orderInColumn:a}=this.options,l="asc"===n?h.ascending:h.descending,u=r.indexOf(i),m=e.modified;if(-1!==u&&o.sort((e,t)=>l(e.row[u],t.row[u])),a){let t=[];for(let e=0;e<s;++e)t[o[e].index]=e;m.setColumns({[a]:t})}else{let t=[];for(let e=0;e<s;++e)t.push(o[e].row);m.setRows(t,0)}return this.emit({type:"afterModify",detail:t,table:e}),e}}return h.defaultOptions={type:"Sort",direction:"desc",orderByColumn:"y"},e.registerType("Sort",h),h}),t(e,"masters/modules/data-tools.src.js",[e["Core/Globals.js"],e["Data/Connectors/DataConnector.js"],e["Data/Converters/DataConverter.js"],e["Data/DataCursor.js"],e["Data/Modifiers/DataModifier.js"],e["Data/DataPool.js"],e["Data/DataTable.js"],e["Data/Formula/Formula.js"]],function(e,t,r,s,o,n,i,a){return e.DataConnector=e.DataConnector||t,e.DataConverter=e.DataConverter||r,e.DataCursor=e.DataCursor||s,e.DataModifier=e.DataModifier||o,e.DataPool=e.DataPool||n,e.DataTable=e.DataTable||i,e.Formula=e.Formula||a,e})});