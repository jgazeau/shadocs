!function(t){"object"==typeof module&&module.exports?module.exports=t.default=t:"function"==typeof define&&define.amd?define("highcharts/modules/venn",["highcharts"],function(e){return t(e),t.Highcharts=e,t}):t("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(e){"use strict";e=e?e._modules:{};function t(e,t,r,i){e.hasOwnProperty(t)||(e[t]=i.apply(null,r),"function"==typeof CustomEvent&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:t,module:e[t]}})))}t(e,"Core/Geometry/GeometryUtilities.js",[],function(){var e;e={getCenterOfPoints:function(e){var t=e.reduce((e,t)=>(e.x+=t.x,e.y+=t.y,e),{x:0,y:0});return{x:t.x/e.length,y:t.y/e.length}},getDistanceBetweenPoints:function(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))},getAngleBetweenPoints:function(e,t){return Math.atan2(t.x-e.x,t.y-e.y)}};return e}),t(e,"Core/Geometry/CircleUtilities.js",[e["Core/Geometry/GeometryUtilities.js"]],function(e){var t;let{getAngleBetweenPoints:p,getCenterOfPoints:s,getDistanceBetweenPoints:d}=e;return(e=t=t||{}).round=f,e.getAreaOfCircle=o,e.getCircularSegmentArea=a,e.getOverlapBetweenCircles=function(e,t,r){let i=0;var n;return i=r<e+t?f(i=r<=Math.abs(t-e)?o(e<t?e:t):(n=r-(r=(e*e-t*t+r*r)/(2*r)),a(e,e-r)+a(t,t-n)),14):i},e.getCircleCircleIntersection=l,e.getCirclesIntersectionPoints=r,e.isCircle1CompletelyOverlappingCircle2=function(e,t){return d(e,t)+t.r<e.r+1e-10},e.isPointInsideCircle=i,e.isPointInsideAllCircles=n,e.isPointOutsideAllCircles=function(t,e){return!e.some(function(e){return i(t,e)})},e.getCirclesIntersectionPolygon=c,e.getAreaOfIntersectionBetweenCircles=function(f){let i=c(f),n;if(1<i.length){let t=s(i),e=(i=i.map(function(e){return e.angle=p(t,e),e}).sort(function(e,t){return t.angle-e.angle}))[i.length-1],r=i.reduce(function(e,l){let c=e["startPoint"],u=s([c,l]),t=l.indexes.filter(function(e){return-1<c.indexes.indexOf(e)}).reduce(function(e,t){let r=f[t],i=p(r,l),n=p(r,c),s=n-(n-i+(n<i?2*Math.PI:0))/2,o=d(u,{x:r.x+r.r*Math.sin(s),y:r.y+r.r*Math.cos(s)}),a=r["r"];return o>2*a&&(o=2*a),e=!e||e.width>o?{r:a,largeArc:o>a?1:0,width:o,x:l.x,y:l.y}:e},null);var r;return t&&(r=t["r"],e.arcs.push(["A",r,r,0,t.largeArc,1,t.x,t.y]),e.startPoint=l),e},{startPoint:e,arcs:[]}).arcs;0!==r.length&&1!==r.length&&(r.unshift(["M",e.x,e.y]),n={center:t,d:r})}return n},t;function f(e,t){t=Math.pow(10,t);return Math.round(e*t)/t}function o(e){if(e<=0)throw Error("radius of circle must be a positive number.");return Math.PI*e*e}function a(e,t){return e*e*Math.acos(1-t/e)-(e-t)*Math.sqrt(t*(2*e-t))}function l(e,t){let r=d(e,t),i=e.r,n=t.r,s=[];var o,a,l,c,u;return r<i+n&&r>Math.abs(i-n)&&(u=((o=i*i)-n*n+r*r)/(2*r),o=Math.sqrt(o-u*u),c=(a=e.x)+u*((l=t.x)-a)/r,t=(e=e.y)+u*((u=t.y)-e)/r,u=o/r*-(u-e),e=o/r*-(l-a),s=[{x:f(c+u,14),y:f(t-e,14)},{x:f(c-u,14),y:f(t+e,14)}]),s}function r(e){return e.reduce((e,s,o,t)=>{t=t.slice(o+1).reduce((e,t,r,i)=>{let n=[o,r+o+1];return e.concat(l(s,t).map(e=>(e.indexes=n,e)))},[]);return e.concat(t)},[])}function i(e,t){return d(e,t)<=t.r+1e-10}function n(t,e){return!e.some(function(e){return!i(t,e)})}function c(t){return r(t).filter(function(e){return n(e,t)})}}),t(e,"Series/DrawPointUtilities.js",[e["Core/Utilities.js"]],function(e){var{}=e;return{draw:function(t,e){let{animatableAttribs:r,onComplete:i,css:n,renderer:s}=e,o=t.series&&t.series.chart.hasRendered?void 0:t.series&&t.series.options.animation,a=t.graphic;if(e.attribs={...e.attribs,class:t.getClassName()},t.shouldDraw())a||(a="text"===e.shapeType?s.text():"image"===e.shapeType?s.image(e.imageUrl||"").attr(e.shapeArgs||{}):s[e.shapeType](e.shapeArgs||{}),(t.graphic=a).add(e.group)),n&&a.css(n),a.attr(e.attribs).animate(r,!e.isNew&&o,i);else if(a){let e=()=>{t.graphic=a=a&&a.destroy(),"function"==typeof i&&i()};Object.keys(r).length?a.animate(r,void 0,()=>e()):e()}}}}),t(e,"Series/Venn/VennPoint.js",[e["Core/Series/SeriesRegistry.js"],e["Core/Utilities.js"]],function(e,t){let{prototype:{pointClass:r}}=e.seriesTypes["scatter"],i=t["isNumber"];return class extends r{constructor(){super(...arguments),this.options=void 0,this.series=void 0}isValid(){return i(this.value)}shouldDraw(){return!!this.shapeArgs}}}),t(e,"Series/Venn/VennSeriesDefaults.js",[],function(){return{borderColor:"#cccccc",borderDashStyle:"solid",borderWidth:1,brighten:0,clip:!1,colorByPoint:!0,dataLabels:{enabled:!0,verticalAlign:"middle",formatter:function(){return this.point.name}},inactiveOtherPoints:!0,marker:!1,opacity:.75,showInLegend:!1,legendType:"point",states:{hover:{opacity:1,borderColor:"#333333"},select:{color:"#cccccc",borderColor:"#000000",animation:!1},inactive:{opacity:.075}},tooltip:{pointFormat:"{point.name}: {point.value}"},legendSymbol:"rectangle"}}),t(e,"Series/Venn/VennUtils.js",[e["Core/Geometry/CircleUtilities.js"],e["Core/Geometry/GeometryUtilities.js"],e["Core/Utilities.js"]],function(e,t,r){let{getAreaOfCircle:n,getCircleCircleIntersection:x,getOverlapBetweenCircles:s,isPointInsideAllCircles:a,isPointInsideCircle:i,isPointOutsideAllCircles:l}=e,o=t["getDistanceBetweenPoints"],{extend:c,isArray:u,isNumber:f,isObject:p,isString:d}=r;function h(e){let n={};return e.filter(e=>2===e.sets.length).forEach(i=>{i.sets.forEach((e,t,r)=>{p(n[e])||(n[e]={totalOverlap:0,overlapping:{}}),n[e]={totalOverlap:(n[e].totalOverlap||0)+i.value,overlapping:{...n[e].overlapping||{},[r[1-t]]:i.value}}})}),e.filter(C).forEach(e=>{var t=n[e.sets[0]];c(e,t)}),e}function y(e,t,r,i,n){let s=e(t),o=e(r),a=n||100,l=i||1e-10,c=r-t,u=1,f,p;if(r<=t)throw Error("a must be smaller than b.");if(0<s*o)throw Error("f(a) and f(b) must have opposite signs.");if(0===s)f=t;else if(0===o)f=r;else for(;u++<=a&&0!==p&&c>l;)c=(r-t)/2,0<s*(p=e(f=t+c))?t=f:r=f;return f}function g(e){let t=e.slice(0,-1),r=t.length,i=[],n=(e,t)=>(e.sum+=t[e.i],e);for(let e=0;e<r;e++)i[e]=t.reduce(n,{sum:0,i:e}).sum/r;return i}function v(t,r,i){var e=t+r;return i<=0?e:n(t<r?t:r)<=i?0:y(e=>{e=s(t,r,e);return i-e},0,e)}function C(e){return u(e.sets)&&1===e.sets.length}function m(e){let r={};return p(e)&&f(e.value)&&-1<e.value&&u(e.sets)&&0<e.sets.length&&!e.sets.some(function(e){let t=!1;return!r[e]&&d(e)?r[e]=!0:t=!0,t})}function b(i,e){return e.reduce(function(e,t){let r=0;return 1<t.sets.length&&(t=t.value-function(e){let t=0;var r;return 2===e.length&&(r=e[0],e=e[1],t=s(r.r,e.r,o(r,e))),t}(t.sets.map(function(e){return i[e]})),r=Math.round(t*t*1e11)/1e11),e+r},0)}function A(e,t){return void 0!==t.totalOverlap&&void 0!==e.totalOverlap?t.totalOverlap-e.totalOverlap:NaN}return{geometry:t,geometryCircles:e,addOverlapToSets:h,getCentroid:g,getDistanceBetweenCirclesByOverlap:v,getLabelWidth:function(n,s,e){function t(r,i){return y(e=>{var t={x:n.x+i*e,y:n.y},t=a(t,s)&&l(t,o);return-(r-e)+(t?0:Number.MAX_VALUE)},0,r)}let r=s.reduce((e,t)=>Math.min(t.r,e),1/0),o=e.filter(e=>!i(n,e));return 2*Math.min(t(r,-1),t(r,1))},getMarginFromCircles:function(r,e,t){e=e.reduce((e,t)=>{t=t.r-o(r,t);return t<=e?t:e},Number.MAX_VALUE);return t.reduce((e,t)=>{t=o(r,t)-t.r;return t<=e?t:e},e)},isSet:C,layoutGreedyVenn:function(e){let y=[],g={};e.filter(e=>1===e.sets.length).forEach(e=>{g[e.sets[0]]=e.circle={x:Number.MAX_VALUE,y:Number.MAX_VALUE,r:Math.sqrt(e.value/Math.PI)}});var t,r=(e,t)=>{let r=e.circle;r&&(r.x=t.x,r.y=t.y),y.push(e)};h(e);let i=e.filter(C).sort(A),m=(r(i.shift(),{x:0,y:0}),e.filter(e=>2===e.sets.length));for(t of i){let h=t.circle;if(h){let p=h.r,d=t.overlapping,e=y.reduce((e,t,r)=>{var i,n,s=t.circle;if(!s||!d)return e;let o=d[t.sets[0]],a=v(p,s.r,o),l=[{x:s.x+a,y:s.y},{x:s.x-a,y:s.y},{x:s.x,y:s.y+a},{x:s.x,y:s.y-a}];for(i of y.slice(r+1)){var c=i.circle,u=d[i.sets[0]];c&&(u=v(p,c.r,u),l=l.concat(x({x:s.x,y:s.y,r:a},{x:c.x,y:c.y,r:u})))}for(n of l){h.x=n.x,h.y=n.y;var f=b(g,m);f<e.loss&&(e.loss=f,e.coordinates=n)}return e},{loss:Number.MAX_VALUE,coordinates:void 0});r(t,e.coordinates)}}return g},loss:b,nelderMead:function(s,e){function t(e,t){return e.fx-t.fx}let o=(r,e,i,n)=>e.map((e,t)=>r*e+i*n[t]),r=(e,t)=>(t.fx=s(t),e[e.length-1]=t,e),i=e=>{let r=e[0];return e.map(e=>{let t=o(.5,r,.5,e);return t.fx=s(t),t})},n=(e,t,r,i)=>{let n=o(r,e,i,t);return n.fx=s(n),n},a=(r=>{let e=r.length,i=Array(e+1);i[0]=r,i[0].fx=s(r);for(let t=0;t<e;++t){let e=r.slice();e[t]=e[t]?1.05*e[t]:.001,e.fx=s(e),i[t+1]=e}return i})(e);for(let e=0;e<100;e++){a.sort(t);var l=a[a.length-1],c=g(a),u=n(c,l,2,-1);if(u.fx<a[0].fx){var f=n(c,l,3,-2);a=r(a,f.fx<u.fx?f:u)}else if(u.fx>=a[a.length-2].fx){let e;a=u.fx>l.fx?(e=n(c,l,.5,.5)).fx<l.fx?r(a,e):i(a):(e=n(c,l,1.5,-.5)).fx<u.fx?r(a,e):i(a)}else a=r(a,u)}return a[0]},processVennData:function(e,s){let t=u(e)?e:[],r=t.reduce(function(e,t){var r;return t.sets&&m(r=t)&&C(r)&&0<r.value&&-1===e.indexOf(t.sets[0])&&e.push(t.sets[0]),e},[]).sort(),i=t.reduce(function(e,t){return t.sets&&m(t)&&!t.sets.some(function(e){return-1===r.indexOf(e)})&&(e[t.sets.sort().join(s)]={sets:t.sets,value:t.value||0}),e},{});return r.reduce(function(t,r,e,i){let n=i.slice(e+1);return n.forEach(function(e){t.push(r+s+e)}),t},[]).forEach(function(e){var t;i[e]||(t={sets:e.split(s),value:0},i[e]=t)}),Object.keys(i).map(function(e){return i[e]})},sortByTotalOverlap:A}}),t(e,"Series/Venn/VennSeries.js",[e["Core/Animation/AnimationUtilities.js"],e["Core/Color/Color.js"],e["Core/Geometry/CircleUtilities.js"],e["Series/DrawPointUtilities.js"],e["Core/Geometry/GeometryUtilities.js"],e["Core/Series/SeriesRegistry.js"],e["Series/Venn/VennPoint.js"],e["Series/Venn/VennSeriesDefaults.js"],e["Series/Venn/VennUtils.js"],e["Core/Utilities.js"]],function(e,t,r,a,i,n,s,o,h,l){let c=e["animObject"],u=t["parse"],{getAreaOfIntersectionBetweenCircles:f,getCirclesIntersectionPolygon:p,isCircle1CompletelyOverlappingCircle2:d,isPointInsideAllCircles:y,isPointOutsideAllCircles:g}=r,m=i["getCenterOfPoints"],x=n.seriesTypes["scatter"],{addEvent:v,extend:C,isArray:b,isNumber:A,isObject:O,merge:M}=l;class j extends x{constructor(){super(...arguments),this.data=void 0,this.mapOfIdToRelation=void 0,this.options=void 0,this.points=void 0}static getLabelPosition(i,n){let e=i.reduce((e,t)=>{var r=t.r/2;return[{x:t.x,y:t.y},{x:t.x+r,y:t.y},{x:t.x-r,y:t.y},{x:t.x,y:t.y+r},{x:t.x,y:t.y-r}].reduce((e,t)=>{var r=h.getMarginFromCircles(t,i,n);return e.margin<r&&(e.point=t,e.margin=r),e},e)},{point:void 0,margin:-Number.MAX_VALUE}).point,t=h.nelderMead(e=>-h.getMarginFromCircles({x:e[0],y:e[1]},i,n),[e.x,e.y]);return e=y(e={x:t[0],y:t[1]},i)&&g(e,n)?e:1<i.length?m(p(i)):{x:i[0].x,y:i[0].y}}static getLabelValues(e,t){let i=e.sets,r=t.reduce((e,t)=>{var r=-1<i.indexOf(t.sets[0]);return t.circle&&e[r?"internal":"external"].push(t.circle),e},{internal:[],external:[]});r.external=r.external.filter(t=>r.internal.some(e=>!d(t,e)));e=j.getLabelPosition(r.internal,r.external);return{position:e,width:h.getLabelWidth(e,r.internal,r.external)}}static layout(e){let s={},o={};if(0<e.length){let i=h.layoutGreedyVenn(e),n=e.filter(h.isSet);for(var a of e){let e=a.sets,t=e.join(),r=h.isSet(a)?i[t]:f(e.map(e=>i[e]));r&&(s[t]=r,o[t]=j.getLabelValues(a,n))}}return{mapOfIdToShape:s,mapOfIdToLabelValues:o}}static getScale(e,t,r){var i=r.bottom-r.top,n=r.right-r.left,s=(r.right+r.left)/2,r=(r.top+r.bottom)/2,n=Math.min(0<n?1/n*e:1,0<i?1/i*t:1);return{scale:n,centerX:e/2-s*n,centerY:t/2-r*n}}static updateFieldBoundaries(e,t){var r=t.x-t.r,i=t.x+t.r,n=t.y+t.r,t=t.y-t.r;return(!A(e.left)||e.left>r)&&(e.left=r),(!A(e.right)||e.right<i)&&(e.right=i),(!A(e.top)||e.top>t)&&(e.top=t),(!A(e.bottom)||e.bottom<n)&&(e.bottom=n),e}animate(e){if(!e){var i=c(this.options.animation);for(let r of this.points){var n=r.shapeArgs;if(r.graphic&&n){let e={},t={};n.d?e.opacity=.001:(e.r=0,t.r=n.r),r.graphic.attr(e).animate(t,i),n.d&&setTimeout(()=>{r&&r.graphic&&r.graphic.animate({opacity:1})},i.duration)}}}}drawPoints(){var e,t=this.chart,r=this.group,i=this.points||[],n=t.renderer;for(e of i){var s={zIndex:b(e.sets)?e.sets.length:0},o=e.shapeArgs;t.styledMode||C(s,this.pointAttribs(e,e.state)),a.draw(e,{isNew:!e.graphic,animatableAttribs:o,attribs:s,group:r,renderer:n,shapeType:o&&o.d?"path":"circle"})}}init(){x.prototype.init.apply(this,arguments),delete this.opacity}pointAttribs(e,t){var r=this.options||{},i=e&&e.options||{},t=t&&r.states[t]||{},r=M(r,{color:e&&e.color},i,t);return{fill:u(r.color).brighten(r.brightness).get(),opacity:r.opacity,stroke:r.borderColor,"stroke-width":r.borderWidth,dashstyle:r.borderDashStyle}}translate(){var l,e=this.chart;this.processedXData=this.xData,this.generatePoints();let t=h.processVennData(this.options.data,j.splitter),{mapOfIdToShape:c,mapOfIdToLabelValues:u}=j.layout(t),r=Object.keys(c).filter(e=>{e=c[e];return e&&A(e.r)}).reduce((e,t)=>j.updateFieldBoundaries(e,c[t]),{top:0,bottom:0,left:0,right:0}),i=j.getScale(e.plotWidth,e.plotHeight,r),f=i.scale,p=i.centerX,d=i.centerY;for(l of this.points){let e=b(l.sets)?l.sets:[],t=e.join(),r=c[t],i,n=u[t]||{},s=n.width,o=n.position,a=l.options&&l.options.dataLabels;if(r){if(r.r)i={x:p+r.x*f,y:d+r.y*f,r:r.r*f};else if(r.d){let e=r.d;e.forEach(e=>{"M"===e[0]?(e[1]=p+e[1]*f,e[2]=d+e[2]*f):"A"===e[0]&&(e[1]=e[1]*f,e[2]=e[2]*f,e[6]=p+e[6]*f,e[7]=d+e[7]*f)}),i={d:e}}o?(o.x=p+o.x*f,o.y=d+o.y*f):o={},A(s)&&(s=Math.round(s*f))}l.shapeArgs=i,o&&i&&(l.plotX=o.x,l.plotY=o.y),s&&i&&(l.dlOptions=M(!0,{style:{width:s}},O(a,!0)?a:void 0)),l.name=l.options.name||e.join("∩")}}}return j.splitter="highcharts-split",j.defaultOptions=M(x.defaultOptions,o),C(j.prototype,{axisTypes:[],directTouch:!0,isCartesian:!1,pointArrayMap:["value"],pointClass:s,utils:h}),v(j,"afterSetOptions",function(e){let t=e.options,r=t.states||{};if(this.is("venn"))for(var i of Object.keys(r))r[i].halo=!1}),n.registerSeriesType("venn",j),j}),t(e,"masters/modules/venn.src.js",[],function(){})});