"use strict";!function(e){"object"==typeof module&&module.exports?module.exports=e.default=e:"function"==typeof define&&define.amd?define("highcharts/modules/funnel3d",["highcharts","highcharts/highcharts-3d","highcharts/modules/cylinder"],function(t){return e(t),e.Highcharts=t,e}):e("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(t){function e(t,e,i,r){t.hasOwnProperty(e)||(t[e]=r.apply(null,i),"function"==typeof CustomEvent&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:e,module:t[e]}})))}e(t=t?t._modules:{},"Series/Funnel3D/Funnel3DComposition.js",[t["Core/Color/Color.js"],t["Core/Globals.js"],t["Core/Renderer/SVG/SVGRenderer3D.js"],t["Core/Utilities.js"]],function(t,o,i,e){const r=t["parse"],y=o["charts"],{error:x,extend:n,merge:w}=e;var s;return(s||(s={})).compose=function(t){i.compose(t),(e=t.prototype.elements3d).funnel3d=w(e.cuboid,{parts:"top bottom frontUpper backUpper frontLower backLower rightUpper rightLower".split(" "),mainParts:["top","bottom"],sideGroups:["upperGroup","lowerGroup"],sideParts:{upperGroup:["frontUpper","backUpper","rightUpper"],lowerGroup:["frontLower","backLower","rightLower"]},pathType:"funnel3d",opacitySetter:function(t){const e=this,i=e.parts,r=o.charts[e.renderer.chartIndex],n="group-opacity-"+t+"-"+r.index;return e.parts=e.mainParts,e.singleSetterForParts("opacity",t),e.parts=i,r.renderer.filterId||(r.renderer.definition({tagName:"filter",attributes:{id:n},children:[{tagName:"feComponentTransfer",children:[{tagName:"feFuncA",attributes:{type:"table",tableValues:"0 "+t}}]}]}),e.sideGroups.forEach(function(t){e[t].attr({filter:"url(#"+n+")"})}),e.renderer.styledMode&&(r.renderer.definition({tagName:"style",textContent:".highcharts-"+n+" {filter:url(#"+n+")}"}),e.sideGroups.forEach(function(t){t.addClass("highcharts-"+n)}))),e},fillSetter:function(t){let o=this,n=r(t),e=n.rgba[3],s={top:r(t).brighten(.1).get(),bottom:r(t).brighten(-.2).get()};return e<1?(n.rgba[3]=1,n=n.get("rgb"),o.attr({opacity:e})):n=t,(n=n.linearGradient||n.radialGradient||!o.gradientForSides?n:{linearGradient:{x1:0,x2:1,y1:1,y2:1},stops:[[0,r(t).brighten(-.2).get()],[.5,t],[1,r(t).brighten(-.2).get()]]}).linearGradient?o.sideGroups.forEach(function(t){const e=o[t].gradientBox,i=n.linearGradient,r=w(n,{linearGradient:{x1:e.x+i.x1*e.width,y1:e.y+i.y1*e.height,x2:e.x+i.x2*e.width,y2:e.y+i.y2*e.height}});o.sideParts[t].forEach(function(t){s[t]=r})}):(w(!0,s,{frontUpper:n,backUpper:n,rightUpper:n,frontLower:n,backLower:n,rightLower:n}),n.radialGradient&&o.sideGroups.forEach(function(t){const e=o[t].gradientBox,i=e.x+e.width/2,r=e.y+e.height/2,n=Math.min(e.width,e.height);o.sideParts[t].forEach(function(t){o[t].setRadialReference([i,r,n])})})),o.singleSetterForParts("fill",null,s),o.color=o.fill=t,n.linearGradient&&[o.frontLower,o.frontUpper].forEach(function(t){(t=(t=t.element)&&o.renderer.gradients[t.gradient])&&"userSpaceOnUse"!==t.attr("gradientUnits")&&t.attr({gradientUnits:"userSpaceOnUse"})}),o},adjustForGradient:function(){let r=this,n;r.sideGroups.forEach(function(t){let e={x:Number.MAX_VALUE,y:Number.MAX_VALUE},i={x:-Number.MAX_VALUE,y:-Number.MAX_VALUE};r.sideParts[t].forEach(function(t){n=r[t].getBBox(!0),e={x:Math.min(e.x,n.x),y:Math.min(e.y,n.y)},i={x:Math.max(i.x,n.x+n.width),y:Math.max(i.y,n.y+n.height)}}),r[t].gradientBox={x:e.x,width:i.x-e.x,y:e.y,height:i.y-e.y}})},zIndexSetter:function(){return this.finishedOnAdd&&this.adjustForGradient(),this.renderer.Element.prototype.zIndexSetter.apply(this,arguments)},onAdd:function(){this.adjustForGradient(),this.finishedOnAdd=!0}});{var e=t;const f=e.prototype;return void n(f,{funnel3d:function(t){const e=this.element3d("funnel3d",t),i=this.styledMode,r={"stroke-width":1,stroke:"none"};return e.upperGroup=this.g("funnel3d-upper-group").attr({zIndex:e.frontUpper.zIndex}).add(e),[e.frontUpper,e.backUpper,e.rightUpper].forEach(function(t){i||t.attr(r),t.add(e.upperGroup)}),e.lowerGroup=this.g("funnel3d-lower-group").attr({zIndex:e.frontLower.zIndex}).add(e),[e.frontLower,e.backLower,e.rightLower].forEach(function(t){i||t.attr(r),t.add(e.lowerGroup)}),e.gradientForSides=t.gradientForSides,e},funnel3dPath:function(t){this.getCylinderEnd||x("A required Highcharts module is missing: cylinder.js",!0,y[this.chartIndex]);var e=y[this.chartIndex],i=t.alphaCorrection=90-Math.abs(e.options.chart.options3d.alpha%180-90),r=f.cuboidPath.call(this,w(t,{depth:t.width,width:(t.width+t.bottom.width)/2})),n=r.isTop,o=!r.isFront,s=!!t.middle,d=this.getCylinderEnd(e,w(t,{x:t.x-t.width/2,z:t.z-t.width/2,alphaCorrection:i}));let a=t.bottom.width,h=w(t,{width:a,x:t.x-a/2,z:t.z-a/2,alphaCorrection:i}),l=this.getCylinderEnd(e,h,!0),p=a,c=h,u=l,g=l;return s&&(p=t.middle.width,c=w(t,{y:t.y+t.middle.fraction*t.height,width:p,x:t.x-p/2,z:t.z-p/2}),u=this.getCylinderEnd(e,c,!1),g=this.getCylinderEnd(e,c,!1)),(r={top:d,bottom:l,frontUpper:this.getCylinderFront(d,u),zIndexes:{group:r.zIndexes.group,top:0!==n?0:3,bottom:1!==n?0:3,frontUpper:o?2:1,backUpper:o?1:2,rightUpper:o?2:1}}).backUpper=this.getCylinderBack(d,u),d=1!=Math.min(p,t.width)/Math.max(p,t.width),r.rightUpper=this.getCylinderFront(this.getCylinderEnd(e,w(t,{x:t.x-t.width/2,z:t.z-t.width/2,alphaCorrection:d?-i:0}),!1),this.getCylinderEnd(e,w(c,{alphaCorrection:d?-i:0}),!s)),s&&(d=1!=Math.min(p,a)/Math.max(p,a),w(!0,r,{frontLower:this.getCylinderFront(g,l),backLower:this.getCylinderBack(g,l),rightLower:this.getCylinderFront(this.getCylinderEnd(e,w(h,{alphaCorrection:d?-i:0}),!0),this.getCylinderEnd(e,w(c,{alphaCorrection:d?-i:0}),!1)),zIndexes:{frontLower:o?2:1,backLower:o?1:2,rightLower:o?1:2}})),r}})}},s}),e(t,"Series/Funnel3D/Funnel3DPoint.js",[t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],function(t,e){({column:t}=t.seriesTypes),e=e.extend;class i extends t.prototype.pointClass{constructor(){super(...arguments),this.y=this.series=this.options=this.dlBoxRaw=void 0}}return e(i.prototype,{shapeType:"funnel3d"}),i}),e(t,"Series/Funnel3D/Funnel3DSeries.js",[t["Series/Funnel3D/Funnel3DComposition.js"],t["Series/Funnel3D/Funnel3DPoint.js"],t["Core/Globals.js"],t["Core/Math3D.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],function(t,e,i,r,n,o){i=i.noop;const E=r["perspective"],{series:F,seriesTypes:{column:a}}=n,{extend:G,merge:s,pick:v,relativeLength:A}=o;class d extends a{constructor(){super(...arguments),this.points=this.options=this.data=this.center=void 0}alignDataLabel(t,e,i){const r=t.dlBoxRaw,n=this.chart.inverted,o=t.plotY>v(this.translatedThreshold,this.yAxis.len),s=v(i.inside,!!this.options.stacking),d={x:r.x,y:r.y,height:0};i.align=v(i.align,!n||s?"center":o?"right":"left"),i.verticalAlign=v(i.verticalAlign,n||s?"middle":o?"top":"bottom"),"top"!==i.verticalAlign&&(d.y+=r.bottom/("bottom"===i.verticalAlign?1:2)),d.width=this.getWidthAt(d.y),this.options.reversed&&(d.width=r.fullWidth-d.width),s?d.x-=d.width/2:"left"===i.align?(i.align="right",d.x-=1.5*d.width):"right"===i.align?(i.align="left",d.x+=d.width/2):d.x-=d.width/2,t.dlBox=d,a.prototype.alignDataLabel.apply(this,arguments)}bindAxes(){F.prototype.bindAxes.apply(this,arguments),G(this.xAxis.options,{gridLineWidth:0,lineWidth:0,title:void 0,tickPositions:[]}),s(!0,this.yAxis.options,{gridLineWidth:0,title:void 0,labels:{enabled:!1}})}translate(){F.prototype.translate.apply(this,arguments);let e=0,i=this.chart,r=this.options,n=r.reversed,o=r.ignoreHiddenPoint;var t=i.plotWidth;let s=i.plotHeight,d=0,a=r.center,h=A(a[0],t),l=A(a[1],s),p=A(r.width,t),c,u,g=A(r.height,s),f=A(r.neckWidth,t),y=A(r.neckHeight,s),x=l-g/2+g-y;t=this.data;let w,m,b,C,L,S,U;this.getWidthAt=u=function(t){var e=l-g/2;return t>x||g===y?f:f+(p-f)*(1-(t-e)/(g-y))},this.center=[h,l,g],this.centerX=h,t.forEach(function(t){o&&!1===t.visible||(e+=t.y)}),t.forEach(function(t){L=null,w=e?t.y/e:0,b=l-g/2+d*g,C=b+w*g,c=u(b),S=C-b,U={gradientForSides:v(t.options.gradientForSides,r.gradientForSides),x:h,y:b,height:S,width:c,z:1,top:{width:c}},c=u(C),U.bottom={fraction:w,width:c},b>=x?U.isCylinder=!0:C>x&&(L=C,c=u(x),C=x,U.bottom.width=c,U.middle={fraction:S?(x-b)/S:0,width:c}),n&&(U.y=b=l+g/2-(d+w)*g,U.middle&&(U.middle.fraction=1-(S?U.middle.fraction:0)),c=U.width,U.width=U.bottom.width,U.bottom.width=c),t.shapeArgs=G(t.shapeArgs,U),t.percentage=100*w,t.plotX=h,t.plotY=n?l+g/2-(d+w/2)*g:(b+(L||C))/2,m=E([{x:h,y:t.plotY,z:n?-(p-u(t.plotY))/2:-u(t.plotY)/2}],i,!0)[0],t.tooltipPos=[m.x,m.y],t.dlBoxRaw={x:h,width:u(t.plotY),y:b,bottom:U.height||0,fullWidth:p},o&&!1===t.visible||(d+=w)})}}return d.compose=t.compose,d.defaultOptions=s(a.defaultOptions,{center:["50%","50%"],width:"90%",neckWidth:"30%",height:"100%",neckHeight:"25%",reversed:!1,gradientForSides:!0,animation:!1,edgeWidth:0,colorByPoint:!0,showInLegend:!1,dataLabels:{align:"right",crop:!1,inside:!1,overflow:"allow"}}),G(d.prototype,{pointClass:e,translate3dShapes:i}),n.registerSeriesType("funnel3d",d),d}),e(t,"masters/modules/funnel3d.src.js",[t["Core/Renderer/RendererRegistry.js"],t["Series/Funnel3D/Funnel3DSeries.js"]],function(t,e){return e.compose(t.getRendererType()),e})});