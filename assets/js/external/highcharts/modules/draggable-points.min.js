!function(r){"object"==typeof module&&module.exports?module.exports=r.default=r:"function"==typeof define&&define.amd?define("highcharts/modules/draggable-points",["highcharts"],function(e){return r(e),r.Highcharts=e,r}):r("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(e){function r(e,r,t,o){e.hasOwnProperty(r)||(e[r]=o.apply(null,t),"function"==typeof CustomEvent&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:r,module:e[r]}})))}r(e=e?e._modules:{},"Extensions/DraggablePoints.js",[e["Core/Animation/AnimationUtilities.js"],e["Core/Chart/Chart.js"],e["Core/Globals.js"],e["Core/Series/Point.js"],e["Core/Series/Series.js"],e["Core/Series/SeriesRegistry.js"],e["Core/Utilities.js"]],function(e,r,t,o,a,i,n){function x(e){return{left:"right",right:"left",top:"bottom",bottom:"top"}[e]}function d(e){var r=e.series?e.series.length:0;if(e.hasCartesianSeries&&!e.polar)for(;r--;)if(e.series[r].options.dragDrop&&function(e){var r,t=["draggableX","draggableY"];for(S(e.dragDropProps,function(e){e.optionName&&t.push(e.optionName)}),r=t.length;r--;)if(e.options.dragDrop[t[r]])return 1}(e.series[r]))return 1}function h(e,r){return void 0===e.chartX||void 0===e.chartY?r.pointer.normalize(e):e}function u(r,e,t,o){var a=e.map(function(e){return b(r,e,t,o)});return function(){a.forEach(function(e){e()})}}function c(e,r){a=(o=r).series,i=[],n=a.options.dragDrop.groupBy,a.boosted?a.options.data.forEach(function(e,r){i.push((new a.pointClass).init(a,e)),i[i.length-1].index=r}):i=a.points;var t,o,a,i,n,s,d,p=o.options[n]?i.filter(function(e){return e.options[n]===o.options[n]}):[o],g=r.series,l=g.chart;A(g.options.dragDrop&&g.options.dragDrop.liveRedraw,!0)||(l.dragGuideBox=t=g.getGuideBox(p),l.setGuideBoxState("default",g.options.dragDrop.guideBox).add(g.group)),l.dragDropData={origin:(g=p,l=t,d={chartX:(s=e).chartX,chartY:s.chartY,guideBox:l&&{x:l.attr("x"),y:l.attr("y"),width:l.attr("width"),height:l.attr("height")},points:{}},g.forEach(function(t){var o={};S(t.series.dragDropProps,function(e,r){e=t.series[e.axis+"Axis"],o[r]=t[r],o[r+"Offset"]=e.toPixels(t[r])-(e.horiz?s.chartX:s.chartY)}),o.point=t,d.points[t.id]=o}),d),point:r,groupedPoints:p,isDragging:!0}}function f(e,r){var t=e.dragDropData.newPoints;r=D(r),e.isDragDropAnimating=!0,S(t,function(e){e.point.update(e.newValues,!1)}),e.redraw(r),setTimeout(function(){delete e.isDragDropAnimating,e.hoverPoint&&!e.dragHandles&&e.hoverPoint.showDragHandles()},r.duration)}function m(e){var r=e.series&&e.series.chart,t=r&&r.dragDropData;!r||!r.dragHandles||t&&(t.isDragging&&t.draggedPastSensitivity||t.isHoveringHandle===e.id)||r.hideDragHandles()}function y(e){var r,t=0;for(r in e)Object.hasOwnProperty.call(e,r)&&t++;return t}function v(e){for(var r in e)if(Object.hasOwnProperty.call(e,r))return e[r]}function p(h,e){var r,u,t,o,a,i,n,s,d,p,g,l,c,m;e.zoomOrPanKeyPressed(h)||(t=0,(r=e.dragDropData)&&r.isDragging&&r.point.series&&(t=(u=r.point).series.options.dragDrop,h.preventDefault(),r.draggedPastSensitivity||(r.draggedPastSensitivity=(p=h,g=e,l=A(u.options.dragDrop&&u.options.dragDrop.dragSensitivity,t&&t.dragSensitivity,2),c=g.dragDropData.origin,g=c.chartX,c=c.chartY,m=p.chartX,p=p.chartY,Math.sqrt((m-g)*(m-g)+(p-c)*(p-c))>l)),r.draggedPastSensitivity&&(r.newPoints=(a=h,m=(o=r).point,i=H(m.series.options.dragDrop,m.options.dragDrop),n={},s=o.updateProp,d={},S(m.series.dragDropProps,function(e,r){s&&(s!==r||!e.resize||e.optionName&&!1===i[e.optionName])||(s||e.move&&("x"===e.axis&&i.draggableX||"y"===e.axis&&i.draggableY))&&(n[r]=e)}),(s?[m]:o.groupedPoints).forEach(function(e){d[e.id]={point:e,newValues:e.getDropValues(o.origin,a,n)}}),d),e=1===(t=y(e=r.newPoints))?v(e):null,u.firePointEvent("drag",{origin:r.origin,newPoints:r.newPoints,newPoint:e&&e.newValues,newPointId:e&&e.point.id,numNewPoints:t,chartX:h.chartX,chartY:h.chartY},function(){var e=(s=(o=u.series).chart).dragDropData,r=(d=H(o.options.dragDrop,u.options.dragDrop)).draggableX,t=d.draggableY,o=e.origin,a=h.chartX-o.chartX,i=h.chartY-o.chartY,n=a;if(e=e.updateProp,s.inverted&&(a=-i,i=-n),A(d.liveRedraw,!0))f(s,!1),u.showDragHandles();else if(e){var r=a,s=i,e=(t=(n=u.series).chart).dragDropData,d=n.dragDropProps[e.updateProp],p=e.newPoints[u.id].newValues,g="function"==typeof d.resizeSide?d.resizeSide(p,u):d.resizeSide;switch(d.beforeResize&&d.beforeResize(t.dragGuideBox,p,u),t=t.dragGuideBox,n="x"===d.axis&&n.xAxis.reversed||"y"===d.axis&&n.yAxis.reversed?x(g):g,r="x"===d.axis?r-(e.origin.prevdX||0):0,s="y"===d.axis?s-(e.origin.prevdY||0):0,n){case"left":var l={x:t.attr("x")+r,width:Math.max(1,t.attr("width")-r)};break;case"right":l={width:Math.max(1,t.attr("width")+r)};break;case"top":l={y:t.attr("y")+s,height:Math.max(1,t.attr("height")-s)};break;case"bottom":l={height:Math.max(1,t.attr("height")+s)}}t.attr(l)}else s.dragGuideBox.translate(r?a:0,t?i:0);o.prevdX=a,o.prevdY=i}))))}function g(e,r){var t,o,a,i,n=r.dragDropData;n&&n.isDragging&&n.draggedPastSensitivity&&n.point.series&&(t=n.point,i=1===(a=y(o=n.newPoints))?v(o):null,r.dragHandles&&r.hideDragHandles(),e.preventDefault(),r.cancelClick=!0,t.firePointEvent("drop",{origin:n.origin,chartX:e.chartX,chartY:e.chartY,newPoints:o,numNewPoints:a,newPoint:i&&i.newValues,newPointId:i&&i.point.id},function(){f(r)})),delete r.dragDropData,r.dragGuideBox&&(r.dragGuideBox.destroy(),delete r.dragGuideBox)}function s(s){var e=s.container,r=t.doc;d(s)&&(u(e,["mousedown","touchstart"],function(e){e=h(e,s);var r,t,o,a=s.hoverPoint,i=(n=H(a&&a.series.options.dragDrop,a&&a.options.dragDrop)).draggableX||!1,n=n.draggableY||!1;s.cancelClick=!1,!i&&!n||s.zoomOrPanKeyPressed(e)||s.hasDraggedAnnotation||(s.dragDropData&&s.dragDropData.isDragging?g(e,s):a&&(n=(i=a).series,o=n.options.dragDrop||{},i=i.options&&i.options.dragDrop,S(n.dragDropProps,function(e){"x"===e.axis&&e.move?r=!0:"y"===e.axis&&e.move&&(t=!0)}),(o.draggableX&&r||o.draggableY&&t)&&(!i||!1!==i.draggableX||!1!==i.draggableY)&&n.yAxis&&n.xAxis)&&(s.mouseIsDown=!1,c(e,a),a.firePointEvent("dragStart",e)))}),u(e,["mousemove","touchmove"],function(e){p(h(e,s),s)},{passive:!1}),b(e,"mouseleave",function(e){g(h(e,s),s)}),s.unbindDragDropMouseUp=u(r,["mouseup","touchend"],function(e){g(h(e,s),s)},{passive:!1}),s.hasAddedDragDropEvents=!0,b(s,"destroy",function(){s.unbindDragDropMouseUp&&s.unbindDragDropMouseUp()}))}var l,D=e.animObject,P=i.seriesTypes,b=n.addEvent,w=n.clamp,z=n.isNumber,H=n.merge,S=n.objectEach,A=n.pick,B=(e=function(e){var r=(e=e.shapeArgs||e.graphic.getBBox()).r||0,t=e.height/2;return[["M",0,r],["L",0,t-5],["A",1,1,0,0,0,0,5+t],["A",1,1,0,0,0,0,t-5],["M",0,5+t],["L",0,e.height-r]]},i=a.prototype.dragDropProps={x:{axis:"x",move:!0},y:{axis:"y",move:!0}},P.flags&&(P.flags.prototype.dragDropProps=i),P.column.prototype.dragDropProps={x:{axis:"x",move:!0},y:{axis:"y",move:!1,resize:!0,beforeResize:function(e,r,t){var o=t.series.translatedThreshold,a=e.attr("y");r.y>=t.series.options.threshold?(r=e.attr("height"),e.attr({height:Math.max(0,Math.round(r+(o?o-(a+r):0)))})):e.attr({y:Math.round(a+(o?o-a:0))})},resizeSide:function(e,r){var t=r.series.chart.dragHandles;return t[r=x(e=e.y>=(r.series.options.threshold||0)?"top":"bottom")]&&(t[r].destroy(),delete t[r]),e},handlePositioner:function(e){var r=e.shapeArgs||e.graphic&&e.graphic.getBBox()||{},t=e.series.yAxis.reversed,o=e.series.options.threshold||0;return e=e.y||0,{x:r.x||0,y:!t&&o<=e||t&&e<o?r.y||0:(r.y||0)+(r.height||0)}},handleFormatter:function(e){var r=e.shapeArgs||{},t=(e=r.r||0,(r=r.width||0)/2);return[["M",e,0],["L",t-5,0],["A",1,1,0,0,0,5+t,0],["A",1,1,0,0,0,t-5,0],["M",5+t,0],["L",r-e,0]]}}}),N=(P.bullet&&(P.bullet.prototype.dragDropProps={x:B.x,y:B.y,target:{optionName:"draggableTarget",axis:"y",move:!0,resize:!0,resizeSide:"top",handlePositioner:function(e){var r=e.targetGraphic.getBBox();return{x:e.barX,y:r.y+r.height/2}},handleFormatter:B.y.handleFormatter}}),P.columnrange&&(P.columnrange.prototype.dragDropProps={x:{axis:"x",move:!0},low:{optionName:"draggableLow",axis:"y",move:!0,resize:!0,resizeSide:"bottom",handlePositioner:function(e){return{x:(e=e.shapeArgs||e.graphic.getBBox()).x||0,y:(e.y||0)+(e.height||0)}},handleFormatter:B.y.handleFormatter,propValidate:function(e,r){return e<=r.high}},high:{optionName:"draggableHigh",axis:"y",move:!0,resize:!0,resizeSide:"top",handlePositioner:function(e){return{x:(e=e.shapeArgs||e.graphic.getBBox()).x||0,y:e.y||0}},handleFormatter:B.y.handleFormatter,propValidate:function(e,r){return e>=r.low}}}),P.boxplot&&(P.boxplot.prototype.dragDropProps={x:B.x,low:{optionName:"draggableLow",axis:"y",move:!0,resize:!0,resizeSide:"bottom",handlePositioner:function(e){return{x:e.shapeArgs.x||0,y:e.lowPlot}},handleFormatter:B.y.handleFormatter,propValidate:function(e,r){return e<=r.q1}},q1:{optionName:"draggableQ1",axis:"y",move:!0,resize:!0,resizeSide:"bottom",handlePositioner:function(e){return{x:e.shapeArgs.x||0,y:e.q1Plot}},handleFormatter:B.y.handleFormatter,propValidate:function(e,r){return e<=r.median&&e>=r.low}},median:{axis:"y",move:!0},q3:{optionName:"draggableQ3",axis:"y",move:!0,resize:!0,resizeSide:"top",handlePositioner:function(e){return{x:e.shapeArgs.x||0,y:e.q3Plot}},handleFormatter:B.y.handleFormatter,propValidate:function(e,r){return e<=r.high&&e>=r.median}},high:{optionName:"draggableHigh",axis:"y",move:!0,resize:!0,resizeSide:"top",handlePositioner:function(e){return{x:e.shapeArgs.x||0,y:e.highPlot}},handleFormatter:B.y.handleFormatter,propValidate:function(e,r){return e>=r.q3}}}),P.ohlc&&(P.ohlc.prototype.dragDropProps={x:B.x,low:{optionName:"draggableLow",axis:"y",move:!0,resize:!0,resizeSide:"bottom",handlePositioner:function(e){return{x:e.shapeArgs.x,y:e.plotLow}},handleFormatter:B.y.handleFormatter,propValidate:function(e,r){return e<=r.open&&e<=r.close}},high:{optionName:"draggableHigh",axis:"y",move:!0,resize:!0,resizeSide:"top",handlePositioner:function(e){return{x:e.shapeArgs.x,y:e.plotHigh}},handleFormatter:B.y.handleFormatter,propValidate:function(e,r){return e>=r.open&&e>=r.close}},open:{optionName:"draggableOpen",axis:"y",move:!0,resize:!0,resizeSide:function(e){return e.open>=e.close?"top":"bottom"},handlePositioner:function(e){return{x:e.shapeArgs.x,y:e.plotOpen}},handleFormatter:B.y.handleFormatter,propValidate:function(e,r){return e<=r.high&&e>=r.low}},close:{optionName:"draggableClose",axis:"y",move:!0,resize:!0,resizeSide:function(e){return e.open>=e.close?"bottom":"top"},handlePositioner:function(e){return{x:e.shapeArgs.x,y:e.plotClose}},handleFormatter:B.y.handleFormatter,propValidate:function(e,r){return e<=r.high&&e>=r.low}}}),P.arearange&&(i=P.columnrange.prototype.dragDropProps,P.arearange.prototype.dragDropProps={x:i.x,low:{optionName:"draggableLow",axis:"y",move:!0,resize:!0,resizeSide:"bottom",handlePositioner:function(e){return(e=e.lowerGraphic&&e.lowerGraphic.getBBox())?{x:e.x+e.width/2,y:e.y+e.height/2}:{x:-999,y:-999}},handleFormatter:n=function(e){return[["M",0-(e=e.graphic?e.graphic.getBBox().width/2+1:4),0],["a",e,e,0,1,0,2*e,0],["a",e,e,0,1,0,-2*e,0]]},propValidate:i.low.propValidate},high:{optionName:"draggableHigh",axis:"y",move:!0,resize:!0,resizeSide:"top",handlePositioner:function(e){return(e=e.upperGraphic&&e.upperGraphic.getBBox())?{x:e.x+e.width/2,y:e.y+e.height/2}:{x:-999,y:-999}},handleFormatter:n,propValidate:i.high.propValidate}}),P.waterfall&&(P.waterfall.prototype.dragDropProps={x:B.x,y:H(B.y,{handleFormatter:function(e){return e.isSum||e.isIntermediateSum?null:B.y.handleFormatter(e)}})}),P.xrange&&(l=function(e,r){var t=e.series,o=t.xAxis,a=t.yAxis,i=t.chart.inverted,n=(r=o.toPixels(e[r],!0),a.toPixels(e.y,!0));return e=t.columnMetrics?t.columnMetrics.offset:-e.shapeArgs.height/2,i&&(r=o.len-r,n=a.len-n),{x:Math.round(r),y:Math.round(n+e)}},e=P.xrange.prototype.dragDropProps={y:{axis:"y",move:!0},x:{optionName:"draggableX1",axis:"x",move:!0,resize:!0,resizeSide:"left",handlePositioner:function(e){return l(e,"x")},handleFormatter:e,propValidate:function(e,r){return e<=r.x2}},x2:{optionName:"draggableX2",axis:"x",move:!0,resize:!0,resizeSide:"right",handlePositioner:function(e){return l(e,"x2")},handleFormatter:e,propValidate:function(e,r){return e>=r.x}}},P.gantt&&(P.gantt.prototype.dragDropProps={y:e.y,start:H(e.x,{optionName:"draggableStart",validateIndividualDrag:function(e){return!e.milestone}}),end:H(e.x2,{optionName:"draggableEnd",validateIndividualDrag:function(e){return!e.milestone}})})),"gauge pie sunburst wordcloud sankey histogram pareto vector windbarb treemap bellcurve sma map mapline".split(" ").forEach(function(e){P[e]&&(P[e].prototype.dragDropProps=null)}),{default:{className:"highcharts-drag-box-default",lineWidth:1,lineColor:"#888",color:"rgba(0, 0, 0, 0.1)",cursor:"move",zIndex:900}}),F={className:"highcharts-drag-handle",color:"#fff",lineColor:"rgba(0, 0, 0, 0.6)",lineWidth:1,zIndex:901};r.prototype.setGuideBoxState=function(e,r){var t=this.dragGuideBox;return r=H(N,r),e=H(r.default,r[e]),t.attr({className:e.className,stroke:e.lineColor,strokeWidth:e.lineWidth,fill:e.color,cursor:e.cursor,zIndex:e.zIndex}).css({pointerEvents:"none"})},o.prototype.getDropValues=function(e,s,r){var t,d=this,p=d.series,g=H(p.options.dragDrop,d.options.dragDrop),l={},h=e.points[d.id];for(t in r)if(Object.hasOwnProperty.call(r,t)){if(void 0!==u){var u=!1;break}u=!0}return S(r,function(e,r){var t=h[r],o=(o=p[e.axis+"Axis"]).toValue((o.horiz?s.chartX:s.chartY)+h[r+"Offset"]),a=e.axis.toUpperCase(),i=p[a.toLowerCase()+"Axis"].categories?1:0,i=A(g["dragPrecision"+a],i),n=A(g["dragMin"+a],-1/0),a=A(g["dragMax"+a],1/0);i&&(o=Math.round(o/i)*i),o=w(o,n,a),u&&e.propValidate&&!e.propValidate(o,d)||void 0===t||(l[r]=o)}),l},a.prototype.getGuideBox=function(e){var a,r=this.chart,i=1/0,n=-1/0,s=1/0,d=-1/0;return e.forEach(function(e){var r,t,o=e.graphic&&e.graphic.getBBox()||e.shapeArgs;o&&(r=void 0,t=e.x2,z(t)&&(r=e.series.xAxis.translate(t,!1,!1,!1,!0)),t=!(o.width||o.height||o.x||o.y),a=!0,i=Math.min(e.plotX||0,r||0,t?1/0:o.x||0,i),n=Math.max(e.plotX||0,r||0,(o.x||0)+(o.width||0),n),s=Math.min(e.plotY||0,t?1/0:o.y||0,s),d=Math.max((o.y||0)+(o.height||0),d))}),a?r.renderer.rect(i,s,n-i,d-s):r.renderer.g()},o.prototype.showDragHandles=function(){var s=this,d=s.series,p=d.chart,g=p.renderer,l=H(d.options.dragDrop,s.options.dragDrop);S(d.dragDropProps,function(e,t){var r=H(F,e.handleOptions,l.dragHandle),o={class:r.className,"stroke-width":r.lineWidth,fill:r.color,stroke:r.lineColor},a=r.pathFormatter||e.handleFormatter,i=e.handlePositioner,n=!e.validateIndividualDrag||e.validateIndividualDrag(s);e.resize&&n&&e.resizeSide&&a&&(l["draggable"+e.axis.toUpperCase()]||l[e.optionName])&&!1!==l[e.optionName]&&(p.dragHandles||(p.dragHandles={group:g.g("drag-drop-handles").add(d.markerGroup||d.group)}),p.dragHandles.point=s.id,i=i(s),o.d=a=a(s),n=s.series.xAxis.categories?-.5:0,!a||i.x<n||i.y<0||(o.cursor=r.cursor||("x"===e.axis!=!!p.inverted?"ew-resize":"ns-resize"),(r=(r=p.dragHandles[e.optionName])?r:p.dragHandles[e.optionName]=g.path().add(p.dragHandles.group)).translate(i.x,i.y).attr(o),u(r.element,["touchstart","mousedown"],function(e){e=h(e,p);var r=s.series.chart;r.zoomOrPanKeyPressed(e)||(r.mouseIsDown=!1,c(e,s),r.dragDropData.updateProp=e.updateProp=t,s.firePointEvent("dragStart",e),e.stopPropagation(),e.preventDefault())},{passive:!1}),b(p.dragHandles.group.element,"mouseover",function(){p.dragDropData=p.dragDropData||{},p.dragDropData.isHoveringHandle=s.id}),u(p.dragHandles.group.element,["touchend","mouseout"],function(){var e=s.series.chart;e.dragDropData&&s.id===e.dragDropData.isHoveringHandle&&delete e.dragDropData.isHoveringHandle,e.hoverPoint||m(s)})))})},r.prototype.hideDragHandles=function(){this.dragHandles&&(S(this.dragHandles,function(e,r){"group"!==r&&e.destroy&&e.destroy()}),this.dragHandles.group&&this.dragHandles.group.destroy&&this.dragHandles.group.destroy(),delete this.dragHandles)},b(o,"mouseOver",function(){var a=this;setTimeout(function(){var e=a.series,r=e&&e.chart,t=r&&r.dragDropData,o=r&&r.is3d&&r.is3d();!r||t&&t.isDragging&&t.draggedPastSensitivity||r.isDragDropAnimating||!e.options.dragDrop||o||(r.dragHandles&&r.hideDragHandles(),a.showDragHandles())},12)}),b(o,"mouseOut",function(){var e=this;setTimeout(function(){e.series&&m(e)},10)}),b(o,"remove",function(){var e=this.series.chart,r=e.dragHandles;r&&r.point===this.id&&e.hideDragHandles()}),r.prototype.zoomOrPanKeyPressed=function(e){var r=this.options.chart||{},t=r.panKey&&r.panKey+"Key";return e[r.zooming.key&&r.zooming.key+"Key"]||e[t]},b(r,"render",function(){this.hasAddedDragDropEvents||s(this)})}),r(e,"masters/modules/draggable-points.src.js",[],function(){})});