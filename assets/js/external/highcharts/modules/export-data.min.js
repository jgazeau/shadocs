!function(e){"object"==typeof module&&module.exports?module.exports=e.default=e:"function"==typeof define&&define.amd?define("highcharts/modules/export-data",["highcharts","highcharts/modules/exporting"],function(t){return e(t),e.Highcharts=t,e}):e("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(n){"use strict";var t=n?n._modules:{};function e(t,e,a,o){t.hasOwnProperty(e)||(t[e]=o.apply(null,a),"function"==typeof CustomEvent&&n.win.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:e,module:t[e]}})))}e(t,"Extensions/DownloadURL.js",[t["Core/Globals.js"]],function(t){let{isSafari:i,win:r,win:{document:s}}=t,n=r.URL||r.webkitURL||r;function l(o){o=o.replace(/filename=.*;/,"").match(/data:([^;]*)(;base64)?,([A-Z+\d\/]+)/i);if(o&&3<o.length&&r.atob&&r.ArrayBuffer&&r.Uint8Array&&r.Blob&&n.createObjectURL){let e=r.atob(o[3]),t=new r.ArrayBuffer(e.length),a=new r.Uint8Array(t);for(let t=0;t<a.length;++t)a[t]=e.charCodeAt(t);return n.createObjectURL(new r.Blob([a],{type:o[1]}))}}return{dataURLtoBlob:l,downloadURL:function(t,e){let a=r.navigator,o=s.createElement("a");if("string"==typeof t||t instanceof String||!a.msSaveOrOpenBlob){if(t=""+t,1e3<a.userAgent.length)throw Error("Input too long");var n=/Edge\/\d+/.test(a.userAgent);if((i&&"string"==typeof t&&0===t.indexOf("data:application/pdf")||n||2e6<t.length)&&!(t=l(t)||""))throw Error("Failed to convert to blob");if(void 0!==o.download)o.href=t,o.download=e,s.body.appendChild(o),o.click(),s.body.removeChild(o);else try{if(!r.open(t,"chart"))throw Error("Failed to open window")}catch{r.location.href=t}}else a.msSaveOrOpenBlob(t,e)}}}),e(t,"Extensions/ExportData/ExportDataDefaults.js",[],function(){return{exporting:{csv:{annotations:{itemDelimiter:"; ",join:!1},columnHeaderFormatter:null,dateFormat:"%Y-%m-%d %H:%M:%S",decimalPoint:null,itemDelimiter:null,lineDelimiter:"\n"},showTable:!1,useMultiLevelHeaders:!0,useRowspanHeaders:!0,showExportInProgress:!0},lang:{downloadCSV:"Download CSV",downloadXLS:"Download XLS",exportData:{annotationHeader:"Annotations",categoryHeader:"Category",categoryDatetimeHeader:"DateTime"},viewData:"View data table",hideData:"Hide data table",exportInProgress:"Exporting..."}}}),e(t,"Extensions/ExportData/ExportData.js",[t["Core/Renderer/HTML/AST.js"],t["Core/Defaults.js"],t["Extensions/DownloadURL.js"],t["Extensions/ExportData/ExportDataDefaults.js"],t["Core/Globals.js"],t["Core/Utilities.js"]],function(r,t,e,d,a,o){let{getOptions:c,setOptions:p}=t,n=e["downloadURL"],{doc:s,win:i}=a,{addEvent:u,defined:m,extend:f,find:S,fireEvent:C,isNumber:A,pick:R}=o;function g(t){let e=!!this.options.exporting?.showExportInProgress,a=i.requestAnimationFrame||setTimeout;a(()=>{e&&this.showLoading(this.options.lang.exportInProgress),a(()=>{try{t.call(this)}finally{e&&this.hideLoading()}})})}function x(){g.call(this,()=>{var t=this.getCSV(!0);n(l(t,"text/csv")||"data:text/csv,\ufeff"+encodeURIComponent(t),this.getFilename()+".csv")})}function b(){g.call(this,()=>{var t='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head>\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>Ark1</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e<style>td{border:none;font-family: Calibri, sans-serif;} .number{mso-number-format:"0.00";} .text{ mso-number-format:"@";}</style><meta name=ProgId content=Excel.Sheet><meta charset=UTF-8></head><body>'+this.getTable(!0)+"</body></html>";n(l(t,"application/vnd.ms-excel")||"data:application/vnd.ms-excel;base64,"+i.btoa(unescape(encodeURIComponent(t))),this.getFilename()+".xls")})}function y(t){let n="",i=this.getDataRows(),e=this.options.exporting.csv,r=R(e.decimalPoint,","!==e.itemDelimiter&&t?1.1.toLocaleString()[1]:"."),s=R(e.itemDelimiter,","===r?";":","),l=e.lineDelimiter;return i.forEach((t,e)=>{let a="",o=t.length;for(;o--;)"number"==typeof(a="string"==typeof(a=t[o])?`"${a}"`:a)&&"."!==r&&(a=a.toString().replace(".",r)),t[o]=a;t.length=i.length?i[0].length:0,n+=t.join(s),e<i.length-1&&(n+=l)}),n}function w(n){function i(t,e,a){if(y.columnHeaderFormatter){var o=y.columnHeaderFormatter(t,e,a);if(!1!==o)return o}return t?t.bindAxes?n?{columnTitle:1<a?e:t.name,topLevelColumnTitle:t.name}:t.name+(1<a?" ("+e+")":""):t.options.title&&t.options.title.text||(t.dateTime?l:s):s}function g(a,t,o){let n={},i={};return t.forEach(function(t){var e=(a.keyToAxis&&a.keyToAxis[t]||t)+"Axis",e=A(o)?a.chart[e][o]:a[e];n[t]=e&&e.categories||[],i[t]=e&&e.dateTime}),{categoryMap:n,dateTimeValueAxisMap:i}}let a,o,x=this.hasParallelCoordinates,b=this.time,y=this.options.exporting&&this.options.exporting.csv||{},r=this.xAxis,w={},t=[],D=[],v=[],e=this.options.lang.exportData,s=e.categoryHeader,l=e.categoryDatetimeHeader,T=[],h,d,E,L=0,c,p;for(c in this.series.forEach(function(s){let t=s.options.keys,l=s.xAxis,h=t||(a=l,o=(e=s).pointArrayMap||["y"],e.data.some(t=>void 0!==t.y&&t.name)&&a&&!a.categories&&"name"!==e.exportKey?["x",...o]:o),d=h.length,c=!s.requireSorting&&{},p=r.indexOf(l),u=g(s,h),m,f;var e,a,o;if(!1!==s.options.includeInDataExport&&!s.options.isInternal&&!1!==s.visible){for(S(T,function(t){return t[0]===p})||T.push([p,L]),f=0;f<d;)E=i(s,h[f],h.length),v.push(E.columnTitle||E),n&&D.push(E.topLevelColumnTitle||E),f++;m={chart:s.chart,autoIncrement:s.autoIncrement,options:s.options,pointArrayMap:s.pointArrayMap,index:s.index},s.options.data.forEach(function(t,e){let a,o,n;var i={series:m},t=(x&&(u=g(s,h,e)),s.pointClass.prototype.applyOptions.apply(i,[t]),s.data[e]&&s.data[e].name);if(a=(i.x??"")+","+t,f=0,(!l||"name"===s.exportKey||!x&&l&&l.hasNames&&t)&&(a=t),c&&(c[a]&&(a+="|"+e),c[a]=!0),w[a]){var e=a+","+w[a].pointers[s.index],r=a;w[a].pointers[s.index]&&(w[e]||(w[e]=[],w[e].xValues=[],w[e].pointers=[]),a=e),w[r].pointers[s.index]+=1}else{w[a]=[],w[a].xValues=[];let e=[];for(let t=0;t<s.chart.series.length;t++)e[t]=0;w[a].pointers=e,w[a].pointers[s.index]=1}for(w[a].x=i.x,w[a].name=t,w[a].xValues[p]=i.x;f<d;)n=i[o=h[f]],w[a][L+f]=R(u.categoryMap[o][n],u.dateTimeValueAxisMap[o]?b.dateFormat(y.dateFormat,n):null,n),f++}),L+=f}}),w)Object.hasOwnProperty.call(w,c)&&t.push(w[c]);for(d=n?[D,v]:[v],L=T.length;L--;)a=T[L][0],o=T[L][1],h=r[a],t.sort(function(t,e){return t.xValues[a]-e.xValues[a]}),p=i(h),d[0].splice(o,0,p),n&&d[1]&&d[1].splice(o,0,p),t.forEach(function(t){let e=t.name;h&&!m(e)&&(e=h.dateTime?(t.x instanceof Date&&(t.x=t.x.getTime()),b.dateFormat(y.dateFormat,t.x)):h.categories?R(h.names[t.x],h.categories[t.x],t.x):t.x),t.splice(o,0,e)});return C(this,"exportData",{dataRows:d=d.concat(t)}),d}function D(t){let e=t=>{if(!t.tagName||"#text"===t.tagName)return t.textContent||"";let a=t.attributes,o="<"+t.tagName;return a&&Object.keys(a).forEach(t=>{var e=a[t];o+=` ${t}="${e}"`}),o+=">"+(t.textContent||""),(t.children||[]).forEach(t=>{o+=e(t)}),o+=`</${t.tagName}>`};return e(this.getTableAST(t))}function v(t){function h(t,e,a,o){let n=R(o,""),i="highcharts-text"+(e?" "+e:"");return"number"==typeof n?(n=n.toString(),","===r&&(n=n.replace(".",r)),i="highcharts-number"):o||(i="highcharts-empty"),{tagName:t,attributes:a=f({class:i},a),textContent:n}}let d=0,e=[],c=this.options,r=t?1.1.toLocaleString()[1]:".",p=R(c.exporting.useMultiLevelHeaders,!0),a=this.getDataRows(p),o=p?a.shift():null,u=a.shift();!1!==c.exporting.tableCaption&&e.push({tagName:"caption",attributes:{class:"highcharts-table-caption"},textContent:R(c.exporting.tableCaption,c.title.text||"Chart")});for(let t=0,e=a.length;t<e;++t)a[t].length>d&&(d=a[t].length);e.push(function(t,a){let o=[],n=0,i=Math.max(d,u.length)||a&&a.length,r,s=0,l;if(p&&t&&a&&!function(t,e){let a=t.length;if(e.length!==a)return!1;for(;a--;)if(t[a]!==e[a])return!1;return!0}(t,a)){let e=[];for(;n<i;++n)if((r=t[n])===t[n+1])++s;else if(s)e.push(h("th","highcharts-table-topheading",{scope:"col",colspan:s+1},r)),s=0;else{r===a[n]?c.exporting.useRowspanHeaders?(l=2,delete a[n]):(l=1,a[n]=""):l=1;let t=h("th","highcharts-table-topheading",{scope:"col"},r);1<l&&t.attributes&&(t.attributes.valign="top",t.attributes.rowspan=l),e.push(t)}o.push({tagName:"tr",children:e})}if(a){let t=[];for(n=0,i=a.length;n<i;++n)void 0!==a[n]&&t.push(h("th",null,{scope:"col"},a[n]));o.push({tagName:"tr",children:t})}return{tagName:"thead",children:o}}(o,u));let n=[];a.forEach(function(e){let a=[];for(let t=0;t<d;t++)a.push(h(t?"td":"th",null,t?{}:{scope:"row"},e[t]));n.push({tagName:"tr",children:a})}),e.push({tagName:"tbody",children:n});t={tree:{tagName:"table",id:"highcharts-data-table-"+this.index,children:e}};return C(this,"aftergetTableAST",t),t.tree}function T(){this.toggleDataTable(!1)}function E(a){var o=(a=R(a,!this.isDataTableVisible))&&!this.dataTableDiv;if(o&&(this.dataTableDiv=s.createElement("div"),this.dataTableDiv.className="highcharts-data-table",this.renderTo.parentNode.insertBefore(this.dataTableDiv,this.renderTo.nextSibling)),this.dataTableDiv){let t=this.dataTableDiv.style,e=t.display;t.display=a?"block":"none",a?(this.dataTableDiv.innerHTML=r.emptyHTML,new r([this.getTableAST()]).addToDOM(this.dataTableDiv),C(this,"afterViewData",{element:this.dataTableDiv,wasHidden:o||e!==t.display})):C(this,"afterHideData")}this.isDataTableVisible=a;let t=this.exportDivElements,e=this.options.exporting,n=e&&e.buttons&&e.buttons.contextButton.menuItems,i=this.options.lang;e&&e.menuItemDefinitions&&i&&i.viewData&&i.hideData&&n&&t&&((o=t[n.indexOf("viewData")])&&r.setElementHTML(o,this.isDataTableVisible?i.hideData:i.viewData))}function L(){this.toggleDataTable(!0)}function l(e,t){let a=i.navigator,o=i.URL||i.webkitURL||i;try{if(a.msSaveOrOpenBlob&&i.MSBlobBuilder){let t=new i.MSBlobBuilder;return t.append(e),t.getBlob("image/svg+xml")}return o.createObjectURL(new i.Blob(["\ufeff"+e],{type:t}))}catch(e){}}function k(){let r=this,s=r.dataTableDiv,l=(t,e)=>t.children[e].textContent;if(s&&r.options.exporting&&r.options.exporting.allowTableSorting){let t=s.querySelector("thead tr");t&&t.childNodes.forEach(a=>{let o=a.closest("table");a.addEventListener("click",function(){let t=[...s.querySelectorAll("tr:not(thead tr)")],e=[...a.parentNode.children];var n,i;t.sort((n=e.indexOf(a),i=r.ascendingOrderInTable=!r.ascendingOrderInTable,(t,e)=>{let a,o;return a=l(i?t:e,n),o=l(i?e:t,n),""===a||""===o||isNaN(a)||isNaN(o)?a.toString().localeCompare(o):a-o})).forEach(t=>{o.appendChild(t)}),e.forEach(e=>{["highcharts-sort-ascending","highcharts-sort-descending"].forEach(t=>{e.classList.contains(t)&&e.classList.remove(t)})}),a.classList.add(r.ascendingOrderInTable?"highcharts-sort-ascending":"highcharts-sort-descending")})})}}function O(){this.options&&this.options.exporting&&this.options.exporting.showTable&&!this.options.chart.forExport&&this.viewData()}function U(){this.dataTableDiv?.remove()}return{compose:function(s,l){let h=s.prototype;if(!h.getCSV){let t=c().exporting,{arearange:e,gantt:a,map:o,mapbubble:n,treemap:i,xrange:r}=(u(s,"afterViewData",k),u(s,"render",O),u(s,"destroy",U),h.downloadCSV=x,h.downloadXLS=b,h.getCSV=y,h.getDataRows=w,h.getTable=D,h.getTableAST=v,h.hideData=T,h.toggleDataTable=E,h.viewData=L,t&&(f(t.menuItemDefinitions,{downloadCSV:{textKey:"downloadCSV",onclick:function(){this.downloadCSV()}},downloadXLS:{textKey:"downloadXLS",onclick:function(){this.downloadXLS()}},viewData:{textKey:"viewData",onclick:function(){g.call(this,this.toggleDataTable)}}}),t.buttons&&t.buttons.contextButton.menuItems&&t.buttons.contextButton.menuItems.push("separator","downloadCSV","downloadXLS","viewData")),p(d),l.types);e&&(e.prototype.keyToAxis={low:"y",high:"y"}),a&&(a.prototype.exportKey="name",a.prototype.keyToAxis={start:"x",end:"x"}),o&&(o.prototype.exportKey="name"),n&&(n.prototype.exportKey="name"),i&&(i.prototype.exportKey="name"),r&&(r.prototype.keyToAxis={x2:"x"})}}}}),e(t,"masters/modules/export-data.src.js",[t["Core/Globals.js"],t["Extensions/DownloadURL.js"],t["Extensions/ExportData/ExportData.js"]],function(t,e,a){return t.dataURLtoBlob=t.dataURLtoBlob||e.dataURLtoBlob,t.downloadURL=t.downloadURL||e.downloadURL,a.compose(t.Chart,t.Series),t})});