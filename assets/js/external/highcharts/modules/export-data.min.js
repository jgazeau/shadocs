!function(e){"object"==typeof module&&module.exports?module.exports=e.default=e:"function"==typeof define&&define.amd?define("highcharts/modules/export-data",["highcharts","highcharts/modules/exporting"],function(t){return e(t),e.Highcharts=t,e}):e("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(t){function e(t,e,a,n){t.hasOwnProperty(e)||(t[e]=n.apply(null,a),"function"==typeof CustomEvent&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:e,module:t[e]}})))}e(t=t?t._modules:{},"Extensions/ExportData/ExportDataDefaults.js",[],function(){return{exporting:{csv:{annotations:{itemDelimiter:"; ",join:!1},columnHeaderFormatter:null,dateFormat:"%Y-%m-%d %H:%M:%S",decimalPoint:null,itemDelimiter:null,lineDelimiter:"\n"},showTable:!1,useMultiLevelHeaders:!0,useRowspanHeaders:!0},lang:{downloadCSV:"Download CSV",downloadXLS:"Download XLS",exportData:{annotationHeader:"Annotations",categoryHeader:"Category",categoryDatetimeHeader:"DateTime"},viewData:"View data table",hideData:"Hide data table"}}}),e(t,"Extensions/DownloadURL.js",[t["Core/Globals.js"]],function(t){var i=t.isSafari,r=t.win,s=r.document,o=r.URL||r.webkitURL||r,l=t.dataURLtoBlob=function(t){if((t=t.replace(/filename=.*;/,"").match(/data:([^;]*)(;base64)?,([0-9A-Za-z+/]+)/))&&3<t.length&&r.atob&&r.ArrayBuffer&&r.Uint8Array&&r.Blob&&o.createObjectURL){for(var e=r.atob(t[3]),a=new r.ArrayBuffer(e.length),a=new r.Uint8Array(a),n=0;n<a.length;++n)a[n]=e.charCodeAt(n);return t=new r.Blob([a],{type:t[1]}),o.createObjectURL(t)}};return t=t.downloadURL=function(e,t){var a=r.navigator,n=s.createElement("a");if("string"==typeof e||e instanceof String||!a.msSaveOrOpenBlob){if(e="".concat(e),a=/Edge\/\d+/.test(a.userAgent),(i&&"string"==typeof e&&0===e.indexOf("data:application/pdf")||a||2e6<e.length)&&!(e=l(e)||""))throw Error("Failed to convert to blob");if(void 0!==n.download)n.href=e,n.download=t,s.body.appendChild(n),n.click(),s.body.removeChild(n);else try{var o=r.open(e,"chart");if(null==o)throw Error("Failed to open window")}catch(t){r.location.href=e}}else a.msSaveOrOpenBlob(e,t)},{dataURLtoBlob:l,downloadURL:t}}),e(t,"Extensions/ExportData/ExportData.js",[t["Core/Renderer/HTML/AST.js"],t["Extensions/ExportData/ExportDataDefaults.js"],t["Core/Globals.js"],t["Core/Defaults.js"],t["Extensions/DownloadURL.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],function(o,e,t,a,n,i,r){function s(){var t=this.getCSV(!0);T(g(t,"text/csv")||"data:text/csv,\ufeff"+encodeURIComponent(t),this.getFilename()+".csv")}function l(){var t='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head>\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>Ark1</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e<style>td{border:none;font-family: Calibri, sans-serif;} .number{mso-number-format:"0.00";} .text{ mso-number-format:"@";}</style><meta name=ProgId content=Excel.Sheet><meta charset=UTF-8></head><body>'+this.getTable(!0)+"</body></html>";T(g(t,"application/vnd.ms-excel")||"data:application/vnd.ms-excel;base64,"+y.btoa(unescape(encodeURIComponent(t))),this.getFilename()+".xls")}function c(t){var o="",i=this.getDataRows(),e=this.options.exporting.csv,r=H(e.decimalPoint,","!==e.itemDelimiter&&t?1.1.toLocaleString()[1]:"."),s=H(e.itemDelimiter,","===r?";":","),l=e.lineDelimiter;return i.forEach(function(t,e){for(var a,n=t.length;n--;)"number"==typeof(a="string"==typeof(a=t[n])?'"'+a+'"':a)&&"."!==r&&(a=a.toString().replace(".",r)),t[n]=a;t.length=i.length?i[0].length:0,o+=t.join(s),e<i.length-1&&(o+=l)}),o}function d(u){function a(t,e,a){if(x.columnHeaderFormatter){var n=x.columnHeaderFormatter(t,e,a);if(!1!==n)return n}return t?t instanceof I?u?{columnTitle:1<a?e:t.name,topLevelColumnTitle:t.name}:t.name+(1<a?" ("+e+")":""):t.options.title&&t.options.title.text||(t.dateTime?i:o):o}function f(a,t,n){var o={},i={};return t.forEach(function(t){var e=(a.keyToAxis&&a.keyToAxis[t]||t)+"Axis",e=U(n)?a.chart[e][n]:a[e];o[t]=e&&e.categories||[],i[t]=e&&e.dateTime}),{categoryMap:o,dateTimeValueAxisMap:i}}var n,m=this.hasParallelCoordinates,g=this.time,x=this.options.exporting&&this.options.exporting.csv||{},b=this.xAxis,v={},t=[],y=[],w=[],e=this.options.lang.exportData,o=e.categoryHeader,i=e.categoryDatetimeHeader,D=[],T=0;for(c in this.series.forEach(function(o){var i,t,e,r=o.xAxis,s=o.options.keys||(e=r,(t=o).data.filter(function(t){return void 0!==t.y&&t.name}).length&&e&&!e.categories&&!t.keyToAxis?t.pointArrayMap&&t.pointArrayMap.filter(function(t){return"x"===t}).length?(t.pointArrayMap.unshift("x"),t.pointArrayMap):["x","y"]:t.pointArrayMap||["y"]),l=s.length,c=!o.requireSorting&&{},d=b.indexOf(r),h=f(o,s);if(!1!==o.options.includeInDataExport&&!o.options.isInternal&&!1!==o.visible){for(V(D,function(t){return t[0]===d})||D.push([d,T]),i=0;i<l;)n=a(o,s[i],s.length),w.push(n.columnTitle||n),u&&y.push(n.topLevelColumnTitle||n),i++;var p={chart:o.chart,autoIncrement:o.autoIncrement,options:o.options,pointArrayMap:o.pointArrayMap,index:o.index};o.options.data.forEach(function(t,e){var a={series:p},n=(m&&(h=f(o,s,e)),o.pointClass.prototype.applyOptions.apply(a,[t]),a.x);for(R(v[n])&&v[n].seriesIndices.includes(p.index)&&(t=Object.keys(v).filter(function(t){return v[t].seriesIndices.includes(p.index)&&n}).filter(function(t){return 0===t.indexOf(String(n))}),n=n.toString()+","+t.length),t=o.data[e]&&o.data[e].name,i=0,(!r||"name"===o.exportKey||!m&&r&&r.hasNames&&t)&&(n=t),c&&(c[n]&&(n+="|"+e),c[n]=!0),v[n]||(v[n]=[],v[n].xValues=[]),v[n].x=a.x,v[n].name=t,v[n].xValues[d]=a.x,R(v[n].seriesIndices)||(v[n].seriesIndices=[]),v[n].seriesIndices=E(E([],v[n].seriesIndices,!0),[p.index],!1);i<l;)e=s[i],v[n][T+i]=H(h.categoryMap[e][t=a[e]],h.dateTimeValueAxisMap[e]?g.dateFormat(x.dateFormat,t):null,t),i++}),T+=i}}),v)Object.hasOwnProperty.call(v,c)&&t.push(v[c]);for(e=u?[y,w]:[w],T=D.length;T--;){var r=D[T][0],s=D[T][1],l=b[r],c=(t.sort(function(t,e){return t.xValues[r]-e.xValues[r]}),a(l));e[0].splice(s,0,c),u&&e[1]&&e[1].splice(s,0,c),t.forEach(function(t){var e=t.name;l&&!R(e)&&(e=l.dateTime?(t.x instanceof Date&&(t.x=t.x.getTime()),g.dateFormat(x.dateFormat,t.x)):l.categories?H(l.names[t.x],l.categories[t.x],t.x):t.x),t.splice(s,0,e)})}return e=e.concat(t),j(this,"exportData",{dataRows:e}),e}function h(t){var e=function(t){if(!t.tagName||"#text"===t.tagName)return t.textContent||"";var a=t.attributes,n="<".concat(t.tagName);return a&&Object.keys(a).forEach(function(t){var e=a[t];n+=" ".concat(t,'="').concat(e,'"')}),n=(n+=">")+(t.textContent||""),(t.children||[]).forEach(function(t){n+=e(t)}),n+="</".concat(t.tagName,">")};return t=this.getTableAST(t),e(t)}function p(t){function c(t,e,a,n){var o=H(n,"");return e="highcharts-text"+(e?" "+e:""),"number"==typeof o?(o=o.toString(),","===i&&(o=o.replace(".",i)),e="highcharts-number"):n||(e="highcharts-empty"),{tagName:t,attributes:a=N({class:e},a),textContent:o}}var n=0,e=[],d=this.options,i=t?1.1.toLocaleString()[1]:".",h=H(d.exporting.useMultiLevelHeaders,!0),a=(t=this.getDataRows(h),h?t.shift():null),o=t.shift();!1!==d.exporting.tableCaption&&e.push({tagName:"caption",attributes:{class:"highcharts-table-caption"},textContent:H(d.exporting.tableCaption,d.title.text||"Chart")});for(var r=0,s=t.length;r<s;++r)t[r].length>n&&(n=t[r].length);e.push(function(t,e,a){var n,o=[],i=0,r=(a=a||e&&e.length,0);if(n=h&&t&&e){t:if(n=t.length,e.length===n){for(;n--;)if(t[n]!==e[n]){n=!1;break t}n=!0}else n=!1;n=!n}if(n){for(n=[];i<a;++i){var s=t[i],l=t[i+1];s===l?++r:r?(n.push(c("th","highcharts-table-topheading",{scope:"col",colspan:r+1},s)),r=0):(s===e[i]?d.exporting.useRowspanHeaders?(l=2,delete e[i]):(l=1,e[i]=""):l=1,s=c("th","highcharts-table-topheading",{scope:"col"},s),1<l&&s.attributes&&(s.attributes.valign="top",s.attributes.rowspan=l),n.push(s))}o.push({tagName:"tr",children:n})}if(e){for(n=[],i=0,a=e.length;i<a;++i)void 0!==e[i]&&n.push(c("th",null,{scope:"col"},e[i]));o.push({tagName:"tr",children:n})}return{tagName:"thead",children:o}}(a,o,Math.max(n,o.length)));var l=[];return t.forEach(function(t){for(var e=[],a=0;a<n;a++)e.push(c(a?"td":"th",null,a?{}:{scope:"row"},t[a]));l.push({tagName:"tr",children:e})}),e.push({tagName:"tbody",children:l}),e={tree:{tagName:"table",id:"highcharts-data-table-".concat(this.index),children:e}},j(this,"aftergetTableAST",e),e.tree}function u(){this.toggleDataTable(!1)}function f(t){var e,a,n=(t=H(t,!this.isDataTableVisible))&&!this.dataTableDiv;n&&(this.dataTableDiv=v.createElement("div"),this.dataTableDiv.className="highcharts-data-table",this.renderTo.parentNode.insertBefore(this.dataTableDiv,this.renderTo.nextSibling)),this.dataTableDiv&&(a=(e=this.dataTableDiv.style).display,e.display=t?"block":"none",t&&(this.dataTableDiv.innerHTML=o.emptyHTML,new o([this.getTableAST()]).addToDOM(this.dataTableDiv),j(this,"afterViewData",{element:this.dataTableDiv,wasHidden:n||a!==e.display}))),this.isDataTableVisible=t,n=this.exportDivElements,a=(e=this.options.exporting)&&e.buttons&&e.buttons.contextButton.menuItems,t=this.options.lang,e&&e.menuItemDefinitions&&t&&t.viewData&&t.hideData&&a&&n&&(n=n[a.indexOf("viewData")])&&o.setElementHTML(n,this.isDataTableVisible?t.hideData:t.viewData)}function m(){this.toggleDataTable(!0)}function g(t,e){var a,n=y.navigator,o=-1<n.userAgent.indexOf("WebKit")&&n.userAgent.indexOf("Chrome")<0,i=y.URL||y.webkitURL||y;try{if(n.msSaveOrOpenBlob&&y.MSBlobBuilder)return(a=new y.MSBlobBuilder).append(t),a.getBlob("image/svg+xml");if(!o)return i.createObjectURL(new y.Blob(["\ufeff"+t],{type:e}))}catch(t){}}function x(){var t,r=this,s=r.dataTableDiv;s&&r.options.exporting&&r.options.exporting.allowTableSorting&&((t=s.querySelector("thead tr"))&&t.childNodes.forEach(function(a){var i=a.closest("table");a.addEventListener("click",function(){var n,o,t=E([],s.querySelectorAll("tr:not(thead tr)"),!0),e=E([],a.parentNode.children,!0);t.sort((n=e.indexOf(a),o=r.ascendingOrderInTable=!r.ascendingOrderInTable,function(t,e){var a=(o?t:e).children[n].textContent;return t=(o?e:t).children[n].textContent,""===a||""===t||isNaN(a)||isNaN(t)?a.toString().localeCompare(t):a-t})).forEach(function(t){i.appendChild(t)}),e.forEach(function(e){["highcharts-sort-ascending","highcharts-sort-descending"].forEach(function(t){e.classList.contains(t)&&e.classList.remove(t)})}),a.classList.add(r.ascendingOrderInTable?"highcharts-sort-ascending":"highcharts-sort-descending")})}))}function b(){this.options&&this.options.exporting&&this.options.exporting.showTable&&!this.options.chart.forExport&&this.viewData()}var E=this&&this.__spreadArray||function(t,e,a){if(a||2===arguments.length)for(var n,o=0,i=e.length;o<i;o++)!n&&o in e||((n=n||Array.prototype.slice.call(e,0,o))[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))},v=t.doc,y=t.win,w=a.getOptions,D=a.setOptions,T=n.downloadURL,I=i.series,S=(t=i.seriesTypes).arearange,C=t.gantt,A=t.map,O=t.mapbubble,L=t.treemap,k=r.addEvent,R=r.defined,N=r.extend,V=r.find,j=r.fireEvent,U=r.isNumber,H=r.pick,M=[];return{compose:function(t){-1===M.indexOf(t)&&(M.push(t),k(t,"afterViewData",x),k(t,"render",b),(t=t.prototype).downloadCSV=s,t.downloadXLS=l,t.getCSV=c,t.getDataRows=d,t.getTable=h,t.getTableAST=p,t.hideData=u,t.toggleDataTable=f,t.viewData=m),-1===M.indexOf(D)&&(M.push(D),(t=w().exporting)&&(N(t.menuItemDefinitions,{downloadCSV:{textKey:"downloadCSV",onclick:function(){this.downloadCSV()}},downloadXLS:{textKey:"downloadXLS",onclick:function(){this.downloadXLS()}},viewData:{textKey:"viewData",onclick:function(){this.toggleDataTable()}}}),t.buttons&&t.buttons.contextButton.menuItems&&t.buttons.contextButton.menuItems.push("separator","downloadCSV","downloadXLS","viewData")),D(e)),S&&-1===M.indexOf(S)&&(M.push(S),S.prototype.keyToAxis={low:"y",high:"y"}),C&&-1===M.indexOf(C)&&(M.push(C),C.prototype.keyToAxis={start:"x",end:"x"}),A&&-1===M.indexOf(A)&&(M.push(A),A.prototype.exportKey="name"),O&&-1===M.indexOf(O)&&(M.push(O),O.prototype.exportKey="name"),L&&-1===M.indexOf(L)&&(M.push(L),L.prototype.exportKey="name")}}}),e(t,"masters/modules/export-data.src.js",[t["Core/Globals.js"],t["Extensions/ExportData/ExportData.js"]],function(t,e){e.compose(t.Chart)})});