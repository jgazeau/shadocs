!function(t){"object"==typeof module&&module.exports?module.exports=t.default=t:"function"==typeof define&&define.amd?define("highcharts/modules/export-data",["highcharts","highcharts/modules/exporting"],function(e){return t(e),t.Highcharts=e,t}):t("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(e){"use strict";e=e?e._modules:{};function t(e,t,a,o){e.hasOwnProperty(t)||(e[t]=o.apply(null,a),"function"==typeof CustomEvent&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:t,module:e[t]}})))}t(e,"Extensions/DownloadURL.js",[e["Core/Globals.js"]],function(e){let{isSafari:i,win:r,win:{document:s}}=e,n=r.URL||r.webkitURL||r;function l(o){o=o.replace(/filename=.*;/,"").match(/data:([^;]*)(;base64)?,([0-9A-Za-z+/]+)/);if(o&&3<o.length&&r.atob&&r.ArrayBuffer&&r.Uint8Array&&r.Blob&&n.createObjectURL){let t=r.atob(o[3]),e=new r.ArrayBuffer(t.length),a=new r.Uint8Array(e);for(let e=0;e<a.length;++e)a[e]=t.charCodeAt(e);return n.createObjectURL(new r.Blob([a],{type:o[1]}))}}return{dataURLtoBlob:l,downloadURL:function(e,t){let a=r.navigator,o=s.createElement("a");if("string"==typeof e||e instanceof String||!a.msSaveOrOpenBlob){e=""+e;var n=/Edge\/\d+/.test(a.userAgent);if((i&&"string"==typeof e&&0===e.indexOf("data:application/pdf")||n||2e6<e.length)&&!(e=l(e)||""))throw Error("Failed to convert to blob");if(void 0!==o.download)o.href=e,o.download=t,s.body.appendChild(o),o.click(),s.body.removeChild(o);else try{if(!r.open(e,"chart"))throw Error("Failed to open window")}catch{r.location.href=e}}else a.msSaveOrOpenBlob(e,t)}}}),t(e,"Extensions/ExportData/ExportDataDefaults.js",[],function(){return{exporting:{csv:{annotations:{itemDelimiter:"; ",join:!1},columnHeaderFormatter:null,dateFormat:"%Y-%m-%d %H:%M:%S",decimalPoint:null,itemDelimiter:null,lineDelimiter:"\n"},showTable:!1,useMultiLevelHeaders:!0,useRowspanHeaders:!0},lang:{downloadCSV:"Download CSV",downloadXLS:"Download XLS",exportData:{annotationHeader:"Annotations",categoryHeader:"Category",categoryDatetimeHeader:"DateTime"},viewData:"View data table",hideData:"Hide data table"}}}),t(e,"Extensions/ExportData/ExportData.js",[e["Core/Renderer/HTML/AST.js"],e["Extensions/ExportData/ExportDataDefaults.js"],e["Core/Globals.js"],e["Core/Defaults.js"],e["Extensions/DownloadURL.js"],e["Core/Series/SeriesRegistry.js"],e["Core/Utilities.js"]],function(r,a,e,t,o,n,i){let{doc:s,win:l}=e,{getOptions:h,setOptions:d}=t,c=o["downloadURL"],{series:f,seriesTypes:{arearange:p,gantt:u,map:m,mapbubble:x,treemap:g,xrange:b}}=n,{addEvent:y,defined:C,extend:w,find:L,fireEvent:U,isNumber:R,pick:A}=i,D=[];function v(){var e=this.getCSV(!0);c(j(e,"text/csv")||"data:text/csv,\ufeff"+encodeURIComponent(e),this.getFilename()+".csv")}function T(){var e='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head>\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>Ark1</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e<style>td{border:none;font-family: Calibri, sans-serif;} .number{mso-number-format:"0.00";} .text{ mso-number-format:"@";}</style><meta name=ProgId content=Excel.Sheet><meta charset=UTF-8></head><body>'+this.getTable(!0)+"</body></html>";c(j(e,"application/vnd.ms-excel")||"data:application/vnd.ms-excel;base64,"+l.btoa(unescape(encodeURIComponent(e))),this.getFilename()+".xls")}function E(e){let n="",i=this.getDataRows(),t=this.options.exporting.csv,r=A(t.decimalPoint,","!==t.itemDelimiter&&e?1.1.toLocaleString()[1]:"."),s=A(t.itemDelimiter,","===r?";":","),l=t.lineDelimiter;return i.forEach((e,t)=>{let a="",o=e.length;for(;o--;)"number"==typeof(a="string"==typeof(a=e[o])?`"${a}"`:a)&&"."!==r&&(a=a.toString().replace(".",r)),e[o]=a;e.length=i.length?i[0].length:0,n+=e.join(s),t<i.length-1&&(n+=l)}),n}function S(n){function i(e,t,a){if(y.columnHeaderFormatter){var o=y.columnHeaderFormatter(e,t,a);if(!1!==o)return o}return e?e instanceof f?n?{columnTitle:1<a?t:e.name,topLevelColumnTitle:e.name}:e.name+(1<a?" ("+t+")":""):e.options.title&&e.options.title.text||(e.dateTime?h:l):l}function x(a,e,o){let n={},i={};return e.forEach(function(e){var t=(a.keyToAxis&&a.keyToAxis[e]||e)+"Axis",t=R(o)?a.chart[t][o]:a[t];n[e]=t&&t.categories||[],i[e]=t&&t.dateTime}),{categoryMap:n,dateTimeValueAxisMap:i}}let a,o,g=this.hasParallelCoordinates,b=this.time,y=this.options.exporting&&this.options.exporting.csv||{},r=this.xAxis,w={},e=[],D=[],v=[],t=this.options.lang,s=t.exportData,l=s.categoryHeader,h=s.categoryDatetimeHeader,T=[],d,c,E,S=0,p,u;for(p in this.series.forEach(function(s){let e=s.options.keys,l=s.xAxis,h=e||(a=l,o=(t=s).pointArrayMap||["y"],t.data.some(e=>void 0!==e.y&&e.name)&&a&&!a.categories&&"name"!==t.exportKey?["x",...o]:o),d=h.length,c=!s.requireSorting&&{},p=r.indexOf(l),u=x(s,h),f,m;var t,a,o;if(!1!==s.options.includeInDataExport&&!s.options.isInternal&&!1!==s.visible){for(L(T,function(e){return e[0]===p})||T.push([p,S]),m=0;m<d;)E=i(s,h[m],h.length),v.push(E.columnTitle||E),n&&D.push(E.topLevelColumnTitle||E),m++;f={chart:s.chart,autoIncrement:s.autoIncrement,options:s.options,pointArrayMap:s.pointArrayMap,index:s.index},s.options.data.forEach(function(e,t){let a,o,n;var i={series:f},e=(g&&(u=x(s,h,t)),s.pointClass.prototype.applyOptions.apply(i,[e]),s.data[t]&&s.data[t].name);if(a=(i.x??"")+","+e,m=0,(!l||"name"===s.exportKey||!g&&l&&l.hasNames&&e)&&(a=e),c&&(c[a]&&(a+="|"+t),c[a]=!0),w[a]){var t=a+","+w[a].pointers[s.index],r=a;w[a].pointers[s.index]&&(w[t]||(w[t]=[],w[t].xValues=[],w[t].pointers=[]),a=t),w[r].pointers[s.index]+=1}else{w[a]=[],w[a].xValues=[];let t=[];for(let e=0;e<s.chart.series.length;e++)t[e]=0;w[a].pointers=t,w[a].pointers[s.index]=1}for(w[a].x=i.x,w[a].name=e,w[a].xValues[p]=i.x;m<d;)n=i[o=h[m]],w[a][S+m]=A(u.categoryMap[o][n],u.dateTimeValueAxisMap[o]?b.dateFormat(y.dateFormat,n):null,n),m++}),S+=m}}),w)Object.hasOwnProperty.call(w,p)&&e.push(w[p]);for(c=n?[D,v]:[v],S=T.length;S--;)a=T[S][0],o=T[S][1],d=r[a],e.sort(function(e,t){return e.xValues[a]-t.xValues[a]}),u=i(d),c[0].splice(o,0,u),n&&c[1]&&c[1].splice(o,0,u),e.forEach(function(e){let t=e.name;d&&!C(t)&&(t=d.dateTime?(e.x instanceof Date&&(e.x=e.x.getTime()),b.dateFormat(y.dateFormat,e.x)):d.categories?A(d.names[e.x],d.categories[e.x],e.x):e.x),e.splice(o,0,t)});return U(this,"exportData",{dataRows:c=c.concat(e)}),c}function k(e){let t=e=>{if(!e.tagName||"#text"===e.tagName)return e.textContent||"";let a=e.attributes,o="<"+e.tagName;return a&&Object.keys(a).forEach(e=>{var t=a[e];o+=` ${e}="${t}"`}),o+=">"+(e.textContent||""),(e.children||[]).forEach(e=>{o+=t(e)}),o+=`</${e.tagName}>`},a=this.getTableAST(e);return t(a)}function O(e){function h(e,t,a,o){let n=A(o,""),i="highcharts-text"+(t?" "+t:"");return"number"==typeof n?(n=n.toString(),","===r&&(n=n.replace(".",r)),i="highcharts-number"):o||(i="highcharts-empty"),{tagName:e,attributes:a=w({class:i},a),textContent:n}}let d=0,t=[],c=this.options,r=e?1.1.toLocaleString()[1]:".",p=A(c.exporting.useMultiLevelHeaders,!0),a=this.getDataRows(p),o=p?a.shift():null,u=a.shift();!1!==c.exporting.tableCaption&&t.push({tagName:"caption",attributes:{class:"highcharts-table-caption"},textContent:A(c.exporting.tableCaption,c.title.text||"Chart")});for(let e=0,t=a.length;e<t;++e)a[e].length>d&&(d=a[e].length);t.push(function(e,a){let o=[],n=0,i=Math.max(d,u.length)||a&&a.length,r,s=0,l;if(p&&e&&a&&!function(e,t){let a=e.length;if(t.length!==a)return!1;for(;a--;)if(e[a]!==t[a])return!1;return!0}(e,a)){let t=[];for(;n<i;++n)if((r=e[n])===e[n+1])++s;else if(s)t.push(h("th","highcharts-table-topheading",{scope:"col",colspan:s+1},r)),s=0;else{r===a[n]?c.exporting.useRowspanHeaders?(l=2,delete a[n]):(l=1,a[n]=""):l=1;let e=h("th","highcharts-table-topheading",{scope:"col"},r);1<l&&e.attributes&&(e.attributes.valign="top",e.attributes.rowspan=l),t.push(e)}o.push({tagName:"tr",children:t})}if(a){let e=[];for(n=0,i=a.length;n<i;++n)void 0!==a[n]&&e.push(h("th",null,{scope:"col"},a[n]));o.push({tagName:"tr",children:e})}return{tagName:"thead",children:o}}(o,u));let n=[];a.forEach(function(t){let a=[];for(let e=0;e<d;e++)a.push(h(e?"td":"th",null,e?{}:{scope:"row"},t[e]));n.push({tagName:"tr",children:a})}),t.push({tagName:"tbody",children:n});e={tree:{tagName:"table",id:"highcharts-data-table-"+this.index,children:t}};return U(this,"aftergetTableAST",e),e.tree}function H(){this.toggleDataTable(!1)}function N(e){var o=(e=A(e,!this.isDataTableVisible))&&!this.dataTableDiv;if(o&&(this.dataTableDiv=s.createElement("div"),this.dataTableDiv.className="highcharts-data-table",this.renderTo.parentNode.insertBefore(this.dataTableDiv,this.renderTo.nextSibling)),this.dataTableDiv){let t=this.dataTableDiv.style,a=t.display;if(t.display=e?"block":"none",e){this.dataTableDiv.innerHTML=r.emptyHTML;let e=new r([this.getTableAST()]);e.addToDOM(this.dataTableDiv),U(this,"afterViewData",{element:this.dataTableDiv,wasHidden:o||a!==t.display})}else U(this,"afterHideData")}this.isDataTableVisible=e;let t=this.exportDivElements,a=this.options.exporting,n=a&&a.buttons&&a.buttons.contextButton.menuItems,i=this.options.lang;a&&a.menuItemDefinitions&&i&&i.viewData&&i.hideData&&n&&t&&((o=t[n.indexOf("viewData")])&&r.setElementHTML(o,this.isDataTableVisible?i.hideData:i.viewData))}function V(){this.toggleDataTable(!0)}function j(t,e){let a=l.navigator,o=l.URL||l.webkitURL||l;try{if(a.msSaveOrOpenBlob&&l.MSBlobBuilder){let e=new l.MSBlobBuilder;return e.append(t),e.getBlob("image/svg+xml")}return o.createObjectURL(new l.Blob(["\ufeff"+t],{type:e}))}catch(t){}}function B(){let r=this,s=r.dataTableDiv,l=(e,t)=>e.children[t].textContent;if(s&&r.options.exporting&&r.options.exporting.allowTableSorting){let e=s.querySelector("thead tr");e&&e.childNodes.forEach(a=>{let i=a.closest("table");a.addEventListener("click",function(){let e=[...s.querySelectorAll("tr:not(thead tr)")],t=[...a.parentNode.children];var o,n;e.sort((o=t.indexOf(a),n=r.ascendingOrderInTable=!r.ascendingOrderInTable,(e,t)=>{var a=l(n?e:t,o),t=l(n?t:e,o);return""===a||""===t||isNaN(a)||isNaN(t)?a.toString().localeCompare(t):a-t})).forEach(e=>{i.appendChild(e)}),t.forEach(t=>{["highcharts-sort-ascending","highcharts-sort-descending"].forEach(e=>{t.classList.contains(e)&&t.classList.remove(e)})}),a.classList.add(r.ascendingOrderInTable?"highcharts-sort-ascending":"highcharts-sort-descending")})})}}function M(){this.options&&this.options.exporting&&this.options.exporting.showTable&&!this.options.chart.forExport&&this.viewData()}return{compose:function(t){if(i.pushUnique(D,t)){y(t,"afterViewData",B),y(t,"render",M);let e=t.prototype;e.downloadCSV=v,e.downloadXLS=T,e.getCSV=E,e.getDataRows=S,e.getTable=k,e.getTableAST=O,e.hideData=H,e.toggleDataTable=N,e.viewData=V}if(i.pushUnique(D,d)){let e=h().exporting;e&&(w(e.menuItemDefinitions,{downloadCSV:{textKey:"downloadCSV",onclick:function(){this.downloadCSV()}},downloadXLS:{textKey:"downloadXLS",onclick:function(){this.downloadXLS()}},viewData:{textKey:"viewData",onclick:function(){this.toggleDataTable()}}}),e.buttons&&e.buttons.contextButton.menuItems&&e.buttons.contextButton.menuItems.push("separator","downloadCSV","downloadXLS","viewData")),d(a)}p&&i.pushUnique(D,p)&&(p.prototype.keyToAxis={low:"y",high:"y"}),u&&i.pushUnique(D,u)&&(u.prototype.exportKey="name",u.prototype.keyToAxis={start:"x",end:"x"}),b&&i.pushUnique(D,b)&&(b.prototype.keyToAxis={x2:"x"}),m&&i.pushUnique(D,m)&&(m.prototype.exportKey="name"),x&&i.pushUnique(D,x)&&(x.prototype.exportKey="name"),g&&i.pushUnique(D,g)&&(g.prototype.exportKey="name")}}}),t(e,"masters/modules/export-data.src.js",[e["Core/Globals.js"],e["Extensions/DownloadURL.js"],e["Extensions/ExportData/ExportData.js"]],function(e,t,a){e.dataURLtoBlob=t.dataURLtoBlob,e.downloadURL=t.downloadURL,a.compose(e.Chart)})});