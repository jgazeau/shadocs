!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("jspdf")):"function"==typeof define&&define.amd?define(["exports","jspdf"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).svg2pdf={},t.jspdf)}(this,function(_,u){"use strict";var t="default"in u?u.default:u,H=function(t,e){return(H=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function e(t,e){function r(){this.constructor=t}H(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var D=function(){return(D=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++)for(var n in e=arguments[r])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)};function d(t,a,o,l){return new(o=o||Promise)(function(r,e){function i(t){try{s(l.next(t))}catch(t){e(t)}}function n(t){try{s(l.throw(t))}catch(t){e(t)}}function s(t){var e;t.done?r(t.value):((e=t.value)instanceof o?e:new o(function(t){t(e)})).then(i,n)}s((l=l.apply(t,a||[])).next())})}function S(i,n){var s,a,o,l={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(r){return function(t){var e=[r,t];if(s)throw new TypeError("Generator is already executing.");for(;l;)try{if(s=1,a&&(o=2&e[0]?a.return:e[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,e[1])).done)return o;switch(a=0,(e=o?[2&e[0],o.value]:e)[0]){case 0:case 1:o=e;break;case 4:return l.label++,{value:e[1],done:!1};case 5:l.label++,a=e[1],e=[0];continue;case 7:e=l.ops.pop(),l.trys.pop();continue;default:if(!((o=0<(o=l.trys).length&&o[o.length-1])||6!==e[0]&&2!==e[0])){l=0;continue}if(3===e[0]&&(!o||e[1]>o[0]&&e[1]<o[3])){l.label=e[1];break}if(6===e[0]&&l.label<o[1]){l.label=o[1],o=e;break}if(o&&l.label<o[2]){l.label=o[2],l.ops.push(e);break}o[2]&&l.ops.pop(),l.trys.pop();continue}e=n.call(i,l)}catch(t){e=[6,t],a=0}finally{s=o=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}}}function q(t,e){"single"!=(e=function(t,e){if(!t)return e;var r,i={};for(r in e)i[r]=(G.call(t,r)?t:e)[r];return i}(e,q.options)).quotes&&"double"!=e.quotes&&(e.quotes="single");for(var r="double"==e.quotes?'"':"'",i=e.isIdentifier,n=t.charAt(0),s="",a=0,o=t.length;a<o;){var l,h=t.charAt(a++),u=h.charCodeAt();s+=u<32||126<u?(55296<=u&&u<=56319&&a<o&&(56320==(64512&(l=t.charCodeAt(a++)))?u=((1023&u)<<10)+(1023&l)+65536:a--),"\\"+u.toString(16).toUpperCase()+" "):e.escapeEverything?U.test(h)?"\\"+h:"\\"+u.toString(16).toUpperCase()+" ":/[\t\n\f\r\x0B]/.test(h)?"\\"+u.toString(16).toUpperCase()+" ":"\\"==h||!i&&('"'==h&&r==h||"'"==h&&r==h)||i&&z.test(h)?"\\"+h:h}return i&&(/^-[-\d]/.test(s)?s="\\-"+s.slice(1):/\d/.test(n)&&(s="\\3"+n+" "+s.slice(1))),s=s.replace(Y,function(t,e,r){return e&&e.length%2?t:(e||"")+r}),!i&&e.wrap?r+s+r:s}f.prototype.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},f.prototype.toRGBA=function(){return"rgba("+this.r+", "+this.g+", "+this.b+", "+(this.a||"1")+")"},f.prototype.toHex=function(){var t=this.r.toString(16),e=this.g.toString(16),r=this.b.toString(16);return"#"+(t=1==t.length?"0"+t:t)+(e=1==e.length?"0"+e:e)+(r=1==r.length?"0"+r:r)},f.prototype.getHelpXML=function(){for(var t,e=[],r=0;r<this.colorDefs.length;r++)for(var i=this.colorDefs[r].example,n=0;n<i.length;n++)e[e.length]=i[n];for(t in this.simpleColors)e[e.length]=t;var s=document.createElement("ul");for(s.setAttribute("id","rgbcolor-examples"),r=0;r<e.length;r++)try{var a=document.createElement("li"),o=new f(e[r]),l=document.createElement("div"),h=(l.style.cssText="margin: 3px; border: 1px solid black; background:"+o.toHex()+"; color:"+o.toHex(),l.appendChild(document.createTextNode("test")),document.createTextNode(" "+e[r]+" -> "+o.toRGB()+" -> "+o.toHex()));a.appendChild(l),a.appendChild(h),s.appendChild(a)}catch(t){}return s};var h=f,c=($.prototype.getFillData=function(t,e){return d(this,void 0,void 0,function(){return S(this,function(t){return[2,void 0]})})},$),V=(Q.prototype.clone=function(){var t=new Q;return t.xmlSpace=this.xmlSpace,t.fill=this.fill,t.fillOpacity=this.fillOpacity,t.fontFamily=this.fontFamily,t.fontSize=this.fontSize,t.fontStyle=this.fontStyle,t.fontWeight=this.fontWeight,t.opacity=this.opacity,t.stroke=this.stroke,t.strokeDasharray=this.strokeDasharray,t.strokeDashoffset=this.strokeDashoffset,t.strokeLinecap=this.strokeLinecap,t.strokeLinejoin=this.strokeLinejoin,t.strokeMiterlimit=this.strokeMiterlimit,t.strokeOpacity=this.strokeOpacity,t.strokeWidth=this.strokeWidth,t.textAnchor=this.textAnchor,t.alignmentBaseline=this.alignmentBaseline,t.visibility=this.visibility,t.color=this.color,t},Q.default=function(){var t=new Q;return t.xmlSpace="default",t.fill=new c(new h("rgb(0, 0, 0)")),t.fillOpacity=1,t.fontFamily="times",t.fontSize=16,t.fontStyle="normal",t.fontWeight="normal",t.opacity=1,t.stroke=null,t.strokeDasharray=null,t.strokeDashoffset=0,t.strokeLinecap="butt",t.strokeLinejoin="miter",t.strokeMiterlimit=4,t.strokeOpacity=1,t.strokeWidth=1,t.alignmentBaseline="baseline",t.textAnchor="start",t.visibility="visible",t.color=new h("rgb(0, 0, 0)"),t},Q),j=/url\(["']?#([^"']+)["']?\)/,R={bottom:"bottom","text-bottom":"bottom",top:"top","text-top":"top",hanging:"hanging",middle:"middle",central:"middle",center:"middle",mathematical:"middle",ideographic:"ideographic",alphabetic:"alphabetic",baseline:"alphabetic"},W=(n.prototype.getTextOffset=function(t,e){var r=e.textAnchor;if("start"===r)return 0;var i=this.measureTextWidth(t,e),n=0;switch(r){case"end":n=i;break;case"middle":n=i/2}return n},n.prototype.measureTextWidth=function(t,e){if(0===t.length)return 0;var r=e.fontFamily;return this.getMeasureFunction(r).call(this,t,e.fontFamily,e.fontSize+"px",e.fontStyle,e.fontWeight)},n.prototype.getMeasurementTextNode=function(){var t;return this.textMeasuringTextElement||(this.textMeasuringTextElement=document.createElementNS("http://www.w3.org/2000/svg","text"),(t=document.createElementNS("http://www.w3.org/2000/svg","svg")).appendChild(this.textMeasuringTextElement),t.style.setProperty("position","absolute"),t.style.setProperty("visibility","hidden"),document.body.appendChild(t)),this.textMeasuringTextElement},n.prototype.canvasTextMeasure=function(t,e,r,i,n){var s=document.createElement("canvas").getContext("2d");return null!=s?(s.font=[i,n,r,e].join(" "),s.measureText(t).width):0},n.prototype.svgTextMeasure=function(t,e,r,i,n,s){s=void 0===s?this.getMeasurementTextNode():s;return s.setAttribute("font-family",e),s.setAttribute("font-size",r),s.setAttribute("font-style",i),s.setAttribute("font-weight",n),s.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),s.textContent=t,s.getBBox().width},n.prototype.getMeasureFunction=function(t){var e,r,i=this.measureMethods[t];return i||(e=this.canvasTextMeasure(n.testString,t,"16px","normal","normal"),r=this.svgTextMeasure(n.testString,t,"16px","normal","normal"),i=Math.abs(e-r)<n.epsilon?this.canvasTextMeasure:this.svgTextMeasure,this.measureMethods[t]=i),i},n.prototype.cleanupTextMeasuring=function(){var t;this.textMeasuringTextElement&&((t=this.textMeasuringTextElement.parentNode)&&document.body.removeChild(t),this.textMeasuringTextElement=void 0)},n.testString="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ 0123456789!\"$%&/()=?'\\+*-_.:,;^}][{#~|<>",n.epsilon=.1,n),g=(X.prototype.clone=function(t){var e;return new X(this.pdf,{svg2pdfParameters:null!=(e=(t=void 0===t?{}:t).svg2pdfParameters)?e:this.svg2pdfParameters,attributeState:(t.attributeState?t:this).attributeState.clone(),viewport:null!=(e=t.viewport)?e:this.viewport,refsHandler:null!=(e=t.refsHandler)?e:this.refsHandler,styleSheets:null!=(e=t.styleSheets)?e:this.styleSheets,textMeasure:null!=(e=t.textMeasure)?e:this.textMeasure,transform:null!=(e=t.transform)?e:this.transform,withinClipPath:null!=(e=t.withinClipPath)?e:this.withinClipPath,withinUse:null!=(e=t.withinUse)?e:this.withinUse})},X),G={}.hasOwnProperty,U=/[ -,\.\/:-@\[-\^`\{-~]/,z=/[ -,\.\/:-@\[\]\^`\{-~]/,Y=/(^|\\+)?(\\[A-F0-9]{1,6})\x20(?![a-fA-F0-9\x20])/g;function X(t,e){this.pdf=t,this.svg2pdfParameters=e.svg2pdfParameters,this.attributeState=e.attributeState?e.attributeState.clone():V.default(),this.viewport=e.viewport,this.refsHandler=null!=(t=e.refsHandler)?t:null,this.styleSheets=null!=(t=e.styleSheets)?t:null,this.textMeasure=null!=(t=e.textMeasure)?t:new W,this.transform=null!=(t=e.transform)?t:this.pdf.unitMatrix,this.withinClipPath=null!=(t=e.withinClipPath)&&t,this.withinUse=null!=(t=e.withinUse)&&t}function n(){this.measureMethods={}}function Q(){this.xmlSpace="",this.fill=null,this.fillOpacity=1,this.fontFamily="",this.fontSize=16,this.fontStyle="",this.fontWeight="",this.opacity=1,this.stroke=null,this.strokeDasharray=null,this.strokeDashoffset=0,this.strokeLinecap="",this.strokeLinejoin="",this.strokeMiterlimit=4,this.strokeOpacity=1,this.strokeWidth=1,this.alignmentBaseline="",this.textAnchor="",this.visibility="",this.color=null}function $(t){this.color=t}function f(t){if(this.a=void 0,this.r=0,this.g=0,this.b=0,this.simpleColors={},this.colorDefs=[],this.ok=!1,t){for(var e in t=(t=(t="#"==t.charAt(0)?t.substr(1,6):t).replace(/ /g,"")).toLowerCase(),this.simpleColors={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgrey:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",grey:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightslategrey:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"},this.simpleColors)t==e&&(t=this.simpleColors[e]);this.colorDefs=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(t){return[parseInt(t[1]),parseInt(t[2]),parseInt(t[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(t){return[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(t){return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)]}}];for(var r=0;r<this.colorDefs.length;r++){var i=this.colorDefs[r].re,n=this.colorDefs[r].process,i=i.exec(t);i&&(n=n(i),this.r=n[0],this.g=n[1],this.b=n[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:255<this.r?255:this.r,this.g=this.g<0||isNaN(this.g)?0:255<this.g?255:this.g,this.b=this.b<0||isNaN(this.b)?0:255<this.b?255:this.b}}q.options={escapeEverything:!1,isIdentifier:!1,quotes:"single",wrap:!1},q.version="3.0.0";var K=q,Z=(r.prototype.getRendered=function(i,n,s){return d(this,void 0,void 0,function(){var e,r;return S(this,function(t){switch(t.label){case 0:return e=this.generateKey(i,n),this.renderedElements.hasOwnProperty(e)?[2,this.renderedElements[i]]:(r=this.get(i),this.renderedElements[e]=r,[4,s(r)]);case 1:return t.sent(),[2,r]}})})},r.prototype.get=function(t){return this.idMap[K(t,{isIdentifier:!0})]},r.prototype.generateKey=function(t,e){return this.idPrefix+"|"+t+"|"+(e||new h("rgb(0,0,0)")).toRGBA()},r.instanceCounter=0,r);function r(t){this.renderedElements={},this.idMap=t,this.idPrefix=String(r.instanceCounter++)}function J(t,e){return Math.atan2(e[1]-t[1],e[0]-t[0])}function tt(t,e){return[2/3*(e[0]-t[0])+t[0],2/3*(e[1]-t[1])+t[1]]}function et(t){var e=Math.sqrt(t[0]*t[0]+t[1]*t[1]);return[t[0]/e,t[1]/e]}function rt(t,e){return et([e[0]-t[0],e[1]-t[1]])}function it(t,e){return[t[0]+e[0],t[1]+e[1]]}function nt(t,e){var r=t[0],t=t[1];return[e.a*r+e.c*t+e.e,e.b*r+e.d*t+e.f]}i.prototype.moveTo=function(t,e){return this.segments.push(new y(t,e)),this},i.prototype.lineTo=function(t,e){return this.segments.push(new b(t,e)),this},i.prototype.curveTo=function(t,e,r,i,n,s){return this.segments.push(new x(t,e,r,i,n,s)),this},i.prototype.close=function(){return this.segments.push(new at),this},i.prototype.transform=function(i){this.segments.forEach(function(t){var e,r;(t instanceof y||t instanceof b||t instanceof x)&&(e=nt([t.x,t.y],i),t.x=e[0],t.y=e[1]),t instanceof x&&(e=nt([t.x1,t.y1],i),r=nt([t.x2,t.y2],i),t.x1=e[0],t.y1=e[1],t.x2=r[0],t.y2=r[1])})},i.prototype.draw=function(t){var e=t.pdf;this.segments.forEach(function(t){t instanceof y?e.moveTo(t.x,t.y):t instanceof b?e.lineTo(t.x,t.y):t instanceof x?e.curveTo(t.x1,t.y1,t.x2,t.y2,t.x,t.y):e.close()})};var st=i,y=function(t,e){this.x=t,this.y=e},b=function(t,e){this.x=t,this.y=e},x=function(t,e,r,i,n,s){this.x1=t,this.y1=e,this.x2=r,this.y2=i,this.x=n,this.y=s},at=function(){};function i(){this.segments=[]}function m(t,e){return 0<=e.split(",").indexOf((t.nodeName||t.tagName).toLowerCase())}function v(t,e,r,i){var n=t.style.getPropertyValue(i=void 0===i?r:i);return n||e.getPropertyValue(t,i)||t.hasAttribute(r)&&t.getAttribute(r)||void 0}function s(t,e,r){if("none"===v(t.element,r.styleSheets,"display"))return!1;t=v(t.element,r.styleSheets,"visibility");return e=t?"hidden"!==t:e}function a(t,e,r){var i=s(t,e,r);return 0!==t.element.childNodes.length&&(t.children.forEach(function(t){t.isVisible(i,r)&&(i=!0)}),i)}function w(t,e,r){this.id=t,this.anchor=e,this.angle=r}lt.prototype.addMarker=function(t){this.markers.push(t)},lt.prototype.draw=function(o){return d(this,void 0,void 0,function(){var e,r,i,n,s,a;return S(this,function(t){switch(t.label){case 0:e=0,t.label=1;case 1:return e<this.markers.length?(r=this.markers[e],i=void 0,a=r.angle,n=r.anchor,s=Math.cos(a),a=Math.sin(a),i=o.pdf.Matrix(s,a,-a,s,n[0],n[1]),i=o.pdf.matrixMult(o.pdf.Matrix(o.attributeState.strokeWidth,0,0,o.attributeState.strokeWidth,0,0),i),i=o.pdf.matrixMult(i,o.transform),o.pdf.saveGraphicsState(),[4,o.refsHandler.getRendered(r.id,null,function(t){return t.apply(o)})]):[3,4];case 2:t.sent(),o.pdf.doFormObject(r.id,i),o.pdf.restoreGraphicsState(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})};var ot=lt;function lt(){this.markers=[]}function k(t,e){var r;return(r=t&&t.toString().match(/^([\-0-9.]+)em$/))?parseFloat(r[1])*e:(r=t&&t.toString().match(/^([\-0-9.]+)(px|)$/))?parseFloat(r[1]):0}function ht(t){return R[t]||"alphabetic"}function M(t){for(var e,r=[],i=/[+-]?(?:(?:\d+\.?\d*)|(?:\d*\.?\d+))(?:[eE][+-]?\d+)?/g;e=i.exec(t);)r.push(parseFloat(e[0]));return r}function ut(t,e){if("transparent"===t)return(r=new h("rgb(0,0,0)")).a=0,r;if("currentcolor"===t.toLowerCase())return e||new h("rgb(0,0,0)");var r=/\s*rgba\(((?:[^,\)]*,){3}[^,\)]*)\)\s*/.exec(t);return r?(e=M(r[1]),(r=new h("rgb("+e.slice(0,3).join(",")+")")).a=e[3],r):new h(t)}var ct=/[a-z0-9_-]/i,ft=/[\s\t]/,p={"sans-serif":"helvetica",verdana:"helvetica",arial:"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",serif:"times",cursive:"times",fantasy:"times"},pt=(t=t.version.split("."),2===parseFloat(t[0])&&3===parseFloat(t[1]));function dt(t,e){return pt?400==e?"italic"==t?"italic":"normal":700==e&&"italic"!==t?"bold":t+""+e:400==e||"normal"===e?"italic"===t?"italic":"normal":700!=e&&"bold"!==e||"normal"!==t?(700==e?"bold":e)+""+t:"bold"}function gt(e,t){if("none"===v(t.element,e.styleSheets,"display"))return[0,0,0,0];var r=[0,0,0,0];return t.children.forEach(function(t){t=t.getBoundingBox(e);r=[Math.min(r[0],t[0]),Math.min(r[1],t[1]),Math.max(r[0]+r[2],t[0]+t[2])-Math.min(r[0],t[0]),Math.max(r[1]+r[3],t[1]+t[3])-Math.min(r[1],t[1])]}),r}function mt(t,e){var r=parseFloat,i=r(t.getAttribute("x1"))||r(v(t,e.styleSheets,"x"))||r(v(t,e.styleSheets,"cx"))-r(v(t,e.styleSheets,"r"))||0,n=r(t.getAttribute("x2"))||i+r(v(t,e.styleSheets,"width"))||r(v(t,e.styleSheets,"cx"))+r(v(t,e.styleSheets,"r"))||0,s=r(t.getAttribute("y1"))||r(v(t,e.styleSheets,"y"))||r(v(t,e.styleSheets,"cy"))-r(v(t,e.styleSheets,"r"))||0,r=r(t.getAttribute("y2"))||s+r(v(t,e.styleSheets,"height"))||r(v(t,e.styleSheets,"cy"))+r(v(t,e.styleSheets,"r"))||0;return[Math.min(i,n),Math.min(s,r),Math.max(i,n)-Math.min(i,n),Math.max(s,r)-Math.min(s,r)]}function yt(t,e,r,i,n,s,a,o){void 0===o&&(o=!1);var l,h=e[0],u=e[1],c=e[2],e=e[3],f=n/c,p=s/e,t=t.getAttribute("preserveAspectRatio");if(t=t?(l=(t="defer"===(t=t.split(" "))[0]?t.slice(1):t)[0],t[1]||"meet"):(l="xMidYMid","meet"),"none"!==l&&("meet"===t?f=p=Math.min(f,p):"slice"===t&&(f=p=Math.max(f,p))),o)return a.pdf.Matrix(f,0,0,p,0,0);t=r-h*f,o=i-u*p,0<=l.indexOf("xMid")?t+=(n-c*f)/2:0<=l.indexOf("xMax")&&(t+=n-c*f),0<=l.indexOf("YMid")?o+=(s-e*p)/2:0<=l.indexOf("YMax")&&(o+=s-e*p),r=a.pdf.Matrix(1,0,0,1,t,o),h=a.pdf.Matrix(f,0,0,p,0,0);return a.pdf.matrixMult(h,r)}function bt(t,e){if(!t||"none"===t)return e.pdf.unitMatrix;for(var r=/^[\s,]*matrix\(([^)]+)\)\s*/,i=/^[\s,]*translate\(([^)]+)\)\s*/,n=/^[\s,]*rotate\(([^)]+)\)\s*/,s=/^[\s,]*scale\(([^)]+)\)\s*/,a=/^[\s,]*skewX\(([^)]+)\)\s*/,o=/^[\s,]*skewY\(([^)]+)\)\s*/,l=e.pdf.unitMatrix;0<t.length&&t.length!==f;){var h,u,c,f=t.length,p=r.exec(t);p&&(h=M(p[1]),l=e.pdf.matrixMult(e.pdf.Matrix(h[0],h[1],h[2],h[3],h[4],h[5]),l),t=t.substr(p[0].length)),(p=n.exec(t))&&(h=M(p[1]),u=Math.PI*h[0]/180,l=e.pdf.matrixMult(e.pdf.Matrix(Math.cos(u),Math.sin(u),-Math.sin(u),Math.cos(u),0,0),l),(h[1]||h[2])&&(u=e.pdf.Matrix(1,0,0,1,h[1],h[2]),c=e.pdf.Matrix(1,0,0,1,-h[1],-h[2]),l=e.pdf.matrixMult(c,e.pdf.matrixMult(l,u))),t=t.substr(p[0].length)),(p=i.exec(t))&&(h=M(p[1]),l=e.pdf.matrixMult(e.pdf.Matrix(1,0,0,1,h[0],h[1]||0),l),t=t.substr(p[0].length)),(p=s.exec(t))&&((h=M(p[1]))[1]||(h[1]=h[0]),l=e.pdf.matrixMult(e.pdf.Matrix(h[0],0,0,h[1],0,0),l),t=t.substr(p[0].length)),(p=a.exec(t))&&(h=parseFloat(p[1]),h*=Math.PI/180,l=e.pdf.matrixMult(e.pdf.Matrix(1,0,Math.tan(h),1,0,0),l),t=t.substr(p[0].length)),(p=o.exec(t))&&(h=parseFloat(p[1]),h*=Math.PI/180,l=e.pdf.matrixMult(e.pdf.Matrix(1,Math.tan(h),0,1,0,0),l),t=t.substr(p[0].length))}return l}Ht.prototype.setParent=function(t){this.parent=t},Ht.prototype.getParent=function(){return this.parent},Ht.prototype.getBoundingBox=function(t){return"none"===v(this.element,t.styleSheets,"display")?[0,0,0,0]:this.getBoundingBoxCore(t)},Ht.prototype.computeNodeTransform=function(t){var e=this.computeNodeTransformCore(t),r=v(this.element,t.styleSheets,"transform");return r?t.pdf.matrixMult(e,bt(r,t)):e};var xt,vt,St,wt,kt,t=Ht,Mt=(e(_t,kt=t),_t.prototype.render=function(t){return Promise.resolve()},_t.prototype.getBoundingBoxCore=function(t){return[]},_t.prototype.computeNodeTransformCore=function(t){return t.pdf.unitMatrix},_t),Ct=(e(o,wt=Mt),o.prototype.apply=function(a){return d(this,void 0,void 0,function(){var e,r,i,n,s;return S(this,function(t){return(e=this.element.getAttribute("id"))&&(s=this.getStops(a.styleSheets),r=0,i=!1,s.forEach(function(t){t=t.opacity;t&&1!==t&&(r+=t,i=!0)}),i&&(n=new u.GState({opacity:r/s.length})),s=new u.ShadingPattern(this.pdfGradientType,this.getCoordinates(),s,n),a.pdf.addShadingPattern(e,s)),[2]})})},o.prototype.getStops=function(i){var n=this;if(this.stops)return this.stops;if(void 0===this.contextColor){this.contextColor=null;for(var t=this;t;){var e=v(t.element,i,"color");if(e){this.contextColor=ut(e,null);break}t=t.getParent()}}var s=[];return this.children.forEach(function(t){var e,r;"stop"===t.element.tagName.toLowerCase()&&(e=v(t.element,i,"color"),e=ut(v(t.element,i,"stop-color")||"",e?ut(e,null):n.contextColor),r=parseFloat(v(t.element,i,"stop-opacity")||"1"),s.push({offset:o.parseGradientOffset(t.element.getAttribute("offset")||"0"),color:[e.r,e.g,e.b],opacity:r}))}),this.stops=s},o.prototype.getBoundingBoxCore=function(t){return mt(this.element,t)},o.prototype.computeNodeTransformCore=function(t){return t.pdf.unitMatrix},o.prototype.isVisible=function(t,e){return a(this,t,e)},o.parseGradientOffset=function(t){var e=parseFloat(t);return!isNaN(e)&&0<=t.indexOf("%")?e/100:e},o),At=(e(It,St=Ct),It.prototype.getCoordinates=function(){return[parseFloat(this.element.getAttribute("x1")||"0"),parseFloat(this.element.getAttribute("y1")||"0"),parseFloat(this.element.getAttribute("x2")||"1"),parseFloat(this.element.getAttribute("y2")||"0")]},It),Ft=(e(Ot,vt=Ct),Ot.prototype.getCoordinates=function(){var t=this.element.getAttribute("cx"),e=this.element.getAttribute("cy"),r=this.element.getAttribute("fx"),i=this.element.getAttribute("fy");return[parseFloat(r||t||"0.5"),parseFloat(i||e||"0.5"),0,parseFloat(t||"0.5"),parseFloat(e||"0.5"),parseFloat(this.element.getAttribute("r")||"0.5")]},Ot),Tt=(Et.prototype.getFillData=function(i,n){return d(this,void 0,void 0,function(){var e,r;return S(this,function(t){switch(t.label){case 0:return[4,n.refsHandler.getRendered(this.key,null,function(t){return t.apply(new g(n.pdf,{refsHandler:n.refsHandler,textMeasure:n.textMeasure,styleSheets:n.styleSheets,viewport:n.viewport,svg2pdfParameters:n.svg2pdfParameters}))})];case 1:return t.sent(),e=this.gradient.element.hasAttribute("gradientUnits")&&"objectboundingbox"!==this.gradient.element.getAttribute("gradientUnits").toLowerCase()?n.pdf.unitMatrix:(e=i.getBoundingBox(n),n.pdf.Matrix(e[2],0,0,e[3],e[0],e[1])),r=bt(v(this.gradient.element,n.styleSheets,"gradientTransform","transform"),n),[2,{key:this.key,matrix:n.pdf.matrixMult(r,e)}]}})})},Et),Pt=(e(Lt,xt=Mt),Lt.prototype.apply=function(s){return d(this,void 0,void 0,function(){var e,r,i,n;return S(this,function(t){switch(t.label){case 0:if(!(e=this.element.getAttribute("id")))return[2];r=this.getBoundingBox(s),r=new u.TilingPattern([r[0],r[1],r[0]+r[2],r[1]+r[3]],r[2],r[3]),s.pdf.beginTilingPattern(r),i=0,n=this.children,t.label=1;case 1:return i<n.length?[4,n[i].render(new g(s.pdf,{attributeState:s.attributeState,refsHandler:s.refsHandler,styleSheets:s.styleSheets,viewport:s.viewport,svg2pdfParameters:s.svg2pdfParameters}))]:[3,4];case 2:t.sent(),t.label=3;case 3:return i++,[3,1];case 4:return s.pdf.endTilingPattern(e,r),[2]}})})},Lt.prototype.getBoundingBoxCore=function(t){return mt(this.element,t)},Lt.prototype.computeNodeTransformCore=function(t){return t.pdf.unitMatrix},Lt.prototype.isVisible=function(t,e){return a(this,t,e)},Lt),Bt=(Nt.prototype.getFillData=function(f,p){return d(this,void 0,void 0,function(){var e,r,i,n,s,a,o,l,h,u,c;return S(this,function(t){switch(t.label){case 0:return[4,p.refsHandler.getRendered(this.key,null,function(t){return t.apply(new g(p.pdf,{refsHandler:p.refsHandler,textMeasure:p.textMeasure,styleSheets:p.styleSheets,viewport:p.viewport,svg2pdfParameters:p.svg2pdfParameters}))})];case 1:return t.sent(),e={key:this.key,boundingBox:void 0,xStep:0,yStep:0,matrix:void 0},i=p.pdf.unitMatrix,this.pattern.element.hasAttribute("patternUnits")&&"objectboundingbox"!==this.pattern.element.getAttribute("patternUnits").toLowerCase()||(r=f.getBoundingBox(p),i=p.pdf.Matrix(1,0,0,1,r[0],r[1]),s=this.pattern.getBoundingBox(p),a=s[0]*r[0]||0,o=s[1]*r[1]||0,l=s[2]*r[2]||0,h=s[3]*r[3]||0,e.boundingBox=[a,o,a+l,o+h],e.xStep=l,e.yStep=h),n=p.pdf.unitMatrix,this.pattern.element.hasAttribute("patternContentUnits")&&"objectboundingbox"===this.pattern.element.getAttribute("patternContentUnits").toLowerCase()&&(r=r||f.getBoundingBox(p),n=p.pdf.Matrix(r[2],0,0,r[3],0,0),s=e.boundingBox||this.pattern.getBoundingBox(p),a=s[0]/r[0]||0,o=s[1]/r[1]||0,l=s[2]/r[2]||0,h=s[3]/r[3]||0,e.boundingBox=[a,o,a+l,o+h],e.xStep=l,e.yStep=h),u=p.pdf.unitMatrix,(c=v(this.pattern.element,p.styleSheets,"patternTransform","transform"))&&(u=bt(c,p)),c=n,c=p.pdf.matrixMult(c,i),c=p.pdf.matrixMult(c,u),c=p.pdf.matrixMult(c,p.transform),e.matrix=c,[2,e]}})})},Nt);function Nt(t,e){this.key=t,this.pattern=e}function Lt(){return null!==xt&&xt.apply(this,arguments)||this}function Et(t,e){this.key=t,this.gradient=e}function Ot(t,e){return vt.call(this,"radial",t,e)||this}function It(t,e){return St.call(this,"axial",t,e)||this}function o(t,e,r){e=wt.call(this,e,r)||this;return e.pdfGradientType=t,e.contextColor=void 0,e}function _t(){return null!==kt&&kt.apply(this,arguments)||this}function Ht(t,e){this.element=t,this.children=e,this.parent=null}function Dt(t,e,r){var i,n,s,a,r=r||e.element,e=v(r,t.styleSheets,"color"),e=(e&&((e=ut(e,t.attributeState.color)).ok?t.attributeState.color=e:t.attributeState.color=new h("rgb(0,0,0)")),v(r,t.styleSheets,"visibility")),e=(e&&(t.attributeState.visibility=e),v(r,t.styleSheets,"fill")),e=(e&&(t.attributeState.fill=function(t,e){var r,i,n,s,a,o=j.exec(t);if(o)return o=o[1],(r=e.refsHandler.get(o))&&(r instanceof At||r instanceof Ft)?(i=o,0===(a=(n=r).getStops(e.styleSheets)).length?null:1===a.length?(l=a[0].color,(s=new h).ok=!0,s.r=l[0],s.g=l[1],s.b=l[2],s.a=a[0].opacity,new c(s)):new Tt(i,n)):r&&r instanceof Pt?new Bt(o,r):new c(new h("rgb(0, 0, 0)"));var l=ut(t,e.attributeState.color);return l.ok?new c(l):null}(e,t)),v(r,t.styleSheets,"fill-opacity")),e=(e&&(t.attributeState.fillOpacity=parseFloat(e)),v(r,t.styleSheets,"stroke-opacity")),e=(e&&(t.attributeState.strokeOpacity=parseFloat(e)),v(r,t.styleSheets,"opacity")),e=(e&&(t.attributeState.opacity=parseFloat(e)),v(r,t.styleSheets,"stroke-width")),e=(void 0!==e&&""!==e&&(t.attributeState.strokeWidth=Math.abs(parseFloat(e))),v(r,t.styleSheets,"stroke")),e=(e&&("none"===e?t.attributeState.stroke=null:(e=ut(e,t.attributeState.color)).ok&&(t.attributeState.stroke=new c(e))),v(r,t.styleSheets,"stroke-linecap")),e=(e&&(t.attributeState.strokeLinecap=e),v(r,t.styleSheets,"stroke-linejoin")),e=(e&&(t.attributeState.strokeLinejoin=e),v(r,t.styleSheets,"stroke-dasharray")),e=(e&&(o=parseInt(v(r,t.styleSheets,"stroke-dashoffset")||"0"),t.attributeState.strokeDasharray=M(e),t.attributeState.strokeDashoffset=o),v(r,t.styleSheets,"stroke-miterlimit")),o=(void 0!==e&&""!==e&&(t.attributeState.strokeMiterlimit=parseFloat(e)),r.getAttribute("xml:space")),e=(o&&(t.attributeState.xmlSpace=o),v(r,t.styleSheets,"font-weight")),o=(e&&(t.attributeState.fontWeight=e),v(r,t.styleSheets,"font-style")),e=(o&&(t.attributeState.fontStyle=o),v(r,t.styleSheets,"font-family")),e=(e&&(o=function(t){for(var e,r,i=!0,n=0,s="",a=0,o=[];;){if(r=t[a],0===n){if(!r&&i)break;if(!r&&!i)throw new Error("Parse error");if('"'===r||"'"===r)e=r,i=!(n=1);else if(!ft.test(r)){if(!ct.test(r))throw new Error("Parse error");i=!(n=3),a--}}else if(1===n){if(!r)throw new Error("Parse Error");"\\"===r?n=2:r===e?(o.push(s),s="",n=4):s+=r}else if(2===n){if(r!==e&&"\\"!==r)throw new Error("Parse error");s+=r,n=1}else if(3===n){if(!r){o.push(s);break}if(ct.test(r))s+=r;else if(","===r)o.push(s),s="",n=0;else{if(!ft.test(r))throw new Error("Parse error");n=5}}else if(5===n){if(!r){o.push(s);break}if(ct.test(r))s+=" "+r,n=3;else if(","===r)o.push(s),s="",n=0;else if(!ft.test(r))throw new Error("Parse error")}else if(4===n){if(!r)break;if(","===r)n=0;else if(!ft.test(r))throw new Error("Parse error")}a++}return o}(e),t.attributeState.fontFamily=(e=t.attributeState,o=o,i=dt(e.fontStyle,e.fontWeight),n=t.pdf.getFontList(),s="",s=o.some(function(t){var e=n[t];return e&&0<=e.indexOf(i)?(s=t,!0):(t=t.toLowerCase(),!!p.hasOwnProperty(t)&&(s=t,!0))})?s:"times")),v(r,t.styleSheets,"font-size")),e=(e&&(a=t.pdf.getFontSize(),t.attributeState.fontSize=k(e,a)),v(r,t.styleSheets,"vertical-align")||v(r,t.styleSheets,"alignment-baseline")),e=(!e||(a=e.match(/(baseline|text-bottom|alphabetic|ideographic|middle|central|mathematical|text-top|bottom|center|top|hanging)/))&&(t.attributeState.alignmentBaseline=a[0]),v(r,t.styleSheets,"text-anchor"));e&&(t.attributeState.textAnchor=e)}function qt(t,e,r){var i=1,n=1,i=(i*=t.attributeState.fillOpacity)*t.attributeState.opacity;t.attributeState.fill instanceof c&&void 0!==t.attributeState.fill.color.a&&(i*=t.attributeState.fill.color.a),n=(n*=t.attributeState.strokeOpacity)*t.attributeState.opacity,t.attributeState.stroke instanceof c&&void 0!==t.attributeState.stroke.color.a&&(n*=t.attributeState.stroke.color.a);var s,a,o,l=i<1,h=n<1;m(r,"use")?(h=l=!0,i*=t.attributeState.fill?1:0,n*=t.attributeState.stroke?1:0):t.withinUse&&(t.attributeState.fill!==e.attributeState.fill?(l=!0,i*=t.attributeState.fill?1:0):l&&!t.attributeState.fill&&(i=0),t.attributeState.stroke!==e.attributeState.stroke?(h=!0,n*=t.attributeState.stroke?1:0):h&&!t.attributeState.stroke&&(n=0)),(l||h)&&(o={},l&&(o.opacity=i),h&&(o["stroke-opacity"]=n),t.pdf.setGState(new u.GState(o))),t.attributeState.fill&&t.attributeState.fill!==e.attributeState.fill&&t.attributeState.fill instanceof c&&t.attributeState.fill.color.ok&&!m(r,"text")&&t.pdf.setFillColor(t.attributeState.fill.color.r,t.attributeState.fill.color.g,t.attributeState.fill.color.b),t.attributeState.strokeWidth!==e.attributeState.strokeWidth&&t.pdf.setLineWidth(t.attributeState.strokeWidth),t.attributeState.stroke!==e.attributeState.stroke&&t.attributeState.stroke instanceof c&&t.pdf.setDrawColor(t.attributeState.stroke.color.r,t.attributeState.stroke.color.g,t.attributeState.stroke.color.b),t.attributeState.strokeLinecap!==e.attributeState.strokeLinecap&&t.pdf.setLineCap(t.attributeState.strokeLinecap),t.attributeState.strokeLinejoin!==e.attributeState.strokeLinejoin&&t.pdf.setLineJoin(t.attributeState.strokeLinejoin),t.attributeState.strokeDasharray===e.attributeState.strokeDasharray&&t.attributeState.strokeDashoffset===e.attributeState.strokeDashoffset||!t.attributeState.strokeDasharray||t.pdf.setLineDashPattern(t.attributeState.strokeDasharray,t.attributeState.strokeDashoffset),t.attributeState.strokeMiterlimit!==e.attributeState.strokeMiterlimit&&t.pdf.setLineMiterLimit(t.attributeState.strokeMiterlimit),t.attributeState.fontFamily!==e.attributeState.fontFamily&&(s=p.hasOwnProperty(t.attributeState.fontFamily)?p[t.attributeState.fontFamily]:t.attributeState.fontFamily),t.attributeState.fill&&t.attributeState.fill!==e.attributeState.fill&&t.attributeState.fill instanceof c&&t.attributeState.fill.color.ok&&(l=t.attributeState.fill.color,t.pdf.setTextColor(l.r,l.g,l.b)),t.attributeState.fontWeight===e.attributeState.fontWeight&&t.attributeState.fontStyle===e.attributeState.fontStyle||(a=dt(t.attributeState.fontStyle,t.attributeState.fontWeight)),void 0===s&&void 0===a||(void 0===s&&(s=p.hasOwnProperty(t.attributeState.fontFamily)?p[t.attributeState.fontFamily]:t.attributeState.fontFamily),t.pdf.setFont(s,a)),t.attributeState.fontSize!==e.attributeState.fontSize&&t.pdf.setFontSize(t.attributeState.fontSize*t.pdf.internal.scaleFactor)}function Vt(t,e,r){var t=j.exec(t);if(t)return t=t[1],r.refsHandler.get(t)||void 0}function jt(i,n,s){return d(this,void 0,void 0,function(){var e,r;return S(this,function(t){switch(t.label){case 0:return e=s.clone(),n.element.hasAttribute("clipPathUnits")&&"objectboundingbox"===n.element.getAttribute("clipPathUnits").toLowerCase()&&(r=i.getBoundingBox(s),e.transform=s.pdf.matrixMult(s.pdf.Matrix(r[2],0,0,r[3],r[0],r[1]),s.transform)),[4,n.apply(e)];case 1:return t.sent(),[2]}})})}e(Yt,Gt=t),Yt.prototype.render=function(n){return d(this,void 0,void 0,function(){var e,r,i;return S(this,function(t){switch(t.label){case 0:return this.isVisible("hidden"!==n.attributeState.visibility,n)?((e=n.clone()).transform=e.pdf.matrixMult(this.computeNodeTransform(e),n.transform),Dt(e,this),i=v(this.element,e.styleSheets,"clip-path"),(r=i&&"none"!==i)?(i=Vt(i,0,e))?i.isVisible(!0,e)?(e.pdf.saveGraphicsState(),[4,jt(this,i,e)]):[3,2]:[3,4]:[3,5]):[2];case 1:return t.sent(),[3,3];case 2:return[2];case 3:return[3,5];case 4:r=!1,t.label=5;case 5:return e.withinClipPath||e.pdf.saveGraphicsState(),qt(e,n,this.element),[4,this.renderCore(e)];case 6:return t.sent(),e.withinClipPath||e.pdf.restoreGraphicsState(),r&&e.pdf.restoreGraphicsState(),[2]}})})};var Rt,Wt,Gt,Ct=Yt,Ut=(e(zt,Wt=Ct),zt),l=(e(C,Rt=Ut),C.prototype.renderCore=function(r){return d(this,void 0,void 0,function(){var e;return S(this,function(t){switch(t.label){case 0:return null===(e=this.getCachedPath(r))||0===e.segments.length?[2]:(r.withinClipPath?e.transform(r.transform):r.pdf.setCurrentTransformationMatrix(r.transform),e.draw(r),[4,this.fillOrStroke(r)]);case 1:return t.sent(),this.hasMarkers?[4,this.drawMarkers(r,e)]:[3,3];case 2:t.sent(),t.label=3;case 3:return[2]}})})},C.prototype.getCachedPath=function(t){return this.cachedPath||(this.cachedPath=this.getPath(t))},C.prototype.drawMarkers=function(e,r){return d(this,void 0,void 0,function(){return S(this,function(t){switch(t.label){case 0:return[4,this.getMarkers(r,e).draw(e.clone({transform:e.pdf.unitMatrix}))];case 1:return t.sent(),[2]}})})},C.prototype.fillOrStroke=function(a){return d(this,void 0,void 0,function(){var e,r,i,n,s;return S(this,function(t){switch(t.label){case 0:return a.withinClipPath?[2]:(e=a.attributeState.fill,r=a.attributeState.stroke&&0!==a.attributeState.strokeWidth,e?[4,e.getFillData(this,a)]:[3,2]);case 1:return n=t.sent(),[3,3];case 2:n=void 0,t.label=3;case 3:return i=n,s="evenodd"===v(this.element,a.styleSheets,"fill-rule"),e&&r||a.withinUse?s?a.pdf.fillStrokeEvenOdd(i):a.pdf.fillStroke(i):e?s?a.pdf.fillEvenOdd(i):a.pdf.fill(i):r?a.pdf.stroke():a.pdf.discardPath(),[2]}})})},C.prototype.getBoundingBoxCore=function(t){var e=this.getCachedPath(t);if(!e)return[0,0,0,0];for(var r=Number.POSITIVE_INFINITY,i=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY,s=Number.NEGATIVE_INFINITY,a=0,o=0,l=0;l<e.segments.length;l++){var h=e.segments[l];(h instanceof y||h instanceof b||h instanceof x)&&(a=h.x,o=h.y),s=h instanceof x?(r=Math.min(r,a,h.x1,h.x2,h.x),n=Math.max(n,a,h.x1,h.x2,h.x),i=Math.min(i,o,h.y1,h.y2,h.y),Math.max(s,o,h.y1,h.y2,h.y)):(r=Math.min(r,a),n=Math.max(n,a),i=Math.min(i,o),Math.max(s,o))}return[r,i,n-r,s-i]},C.prototype.getMarkers=function(t,e){var o=v(this.element,e.styleSheets,"marker-start"),l=v(this.element,e.styleSheets,"marker-mid"),h=v(this.element,e.styleSheets,"marker-end"),u=new ot;if(o||l||h)for(var h=h&&Xt(h),o=o&&Xt(o),l=l&&Xt(l),c=t.segments,f=[1,0],p=void 0,d=!1,g=[1,0],m=!1,r=0;r<c.length;r++)!function(r){var t,e=c[r],i=o&&(1===r||!(c[r]instanceof y)&&c[r-1]instanceof y),n=(i&&c.forEach(function(t,e){!m&&t instanceof at&&r<e&&(t=c[e-1],m=(t instanceof y||t instanceof b||t instanceof x)&&t)}),h&&(r===c.length-1||!(c[r]instanceof y)&&c[r+1]instanceof y)),s=l&&0<r&&!(1===r&&c[r-1]instanceof y),a=c[r-1]||null;a instanceof y||a instanceof b||a instanceof x?e instanceof x?(i&&u.addMarker(new w(o,[a.x,a.y],J(m?[m.x,m.y]:[a.x,a.y],[e.x1,e.y1]))),n&&u.addMarker(new w(h,[e.x,e.y],J([e.x2,e.y2],[e.x,e.y]))),s&&(p=rt([a.x,a.y],[e.x1,e.y1]),p=a instanceof y?p:et(it(f,p)),u.addMarker(new w(l,[a.x,a.y],Math.atan2(p[1],p[0])))),f=rt([e.x2,e.y2],[e.x,e.y])):e instanceof y||e instanceof b?(p=rt([a.x,a.y],[e.x,e.y]),i&&(t=m?rt([m.x,m.y],[e.x,e.y]):p,u.addMarker(new w(o,[a.x,a.y],Math.atan2(t[1],t[0])))),n&&u.addMarker(new w(h,[e.x,e.y],Math.atan2(p[1],p[0]))),s&&(t=e instanceof y?f:a instanceof y?p:et(it(f,p)),u.addMarker(new w(l,[a.x,a.y],Math.atan2(t[1],t[0])))),f=p):e instanceof at&&(p=rt([a.x,a.y],[d.x,d.y]),s&&(t=a instanceof y?p:et(it(f,p)),u.addMarker(new w(l,[a.x,a.y],Math.atan2(t[1],t[0])))),n&&(t=et(it(p,g)),u.addMarker(new w(h,[d.x,d.y],Math.atan2(t[1],t[0])))),f=p):(d=e instanceof y&&e,((i=c[r+1])instanceof y||i instanceof b||i instanceof x)&&(g=rt([d.x,d.y],[i.x,i.y])))}(r);return u},C);function C(t,e,r){e=Rt.call(this,e,r)||this;return e.cachedPath=null,e.hasMarkers=t,e}function zt(){return null!==Wt&&Wt.apply(this,arguments)||this}function Yt(){return null!==Gt&&Gt.apply(this,arguments)||this}function Xt(t){t=j.exec(t);return t&&t[1]||void 0}function Qt(t,e){this.width=t,this.height=e}e(fe,ee=l),fe.prototype.getPath=function(t){if(t.withinClipPath||null===t.attributeState.stroke)return null;var t=parseFloat(this.element.getAttribute("x1")||"0"),e=parseFloat(this.element.getAttribute("y1")||"0"),r=parseFloat(this.element.getAttribute("x2")||"0"),i=parseFloat(this.element.getAttribute("y2")||"0");return t||r||e||i?(new st).moveTo(t,e).lineTo(r,i):null},fe.prototype.computeNodeTransformCore=function(t){return t.pdf.unitMatrix},fe.prototype.isVisible=function(t,e){return s(this,t,e)},fe.prototype.fillOrStroke=function(e){return d(this,void 0,void 0,function(){return S(this,function(t){switch(t.label){case 0:return e.attributeState.fill=null,[4,ee.prototype.fillOrStroke.call(this,e)];case 1:return t.sent(),[2]}})})};var $t,Kt,Zt,Jt,te,ee,re=fe,ie=(e(ce,te=Mt),ce.prototype.apply=function(s){return d(this,void 0,void 0,function(){var e,r,i,n;return S(this,function(t){switch(t.label){case 0:return this.isVisible("hidden"!==s.attributeState.visibility,s)?((e=s.clone()).transform=e.pdf.unitMatrix,Dt(e,this),(r=v(this.element,e.styleSheets,"clip-path"))&&"none"!==r&&(r=Vt(r,0,e))?r.isVisible(!0,e)?[4,jt(this,r,e)]:[3,2]:[3,3]):[2];case 1:return t.sent(),[3,3];case 2:return[2];case 3:qt(e,s,this.element),i=0,n=this.children,t.label=4;case 4:return i<n.length?[4,n[i].render(e)]:[3,7];case 5:t.sent(),t.label=6;case 6:return i++,[3,4];case 7:return[2]}})})},ce.prototype.getBoundingBoxCore=function(t){return gt(t,this)},ce.prototype.isVisible=function(t,e){return a(this,t,e)},ce.prototype.computeNodeTransformCore=function(t){var e,r,i=parseFloat(v(this.element,t.styleSheets,"x")||"0"),n=parseFloat(v(this.element,t.styleSheets,"y")||"0"),s=this.element.getAttribute("viewBox");return s?(e=M(s),r=parseFloat(v(this.element,t.styleSheets,"width")||v(this.element.ownerSVGElement,t.styleSheets,"width")||s[2]),s=parseFloat(v(this.element,t.styleSheets,"height")||v(this.element.ownerSVGElement,t.styleSheets,"height")||s[3]),yt(this.element,e,i,n,r,s,t)):t.pdf.Matrix(1,0,0,1,i,n)},ce),ne=(e(A,Jt=Ut),A.prototype.renderCore=function(p){return d(this,void 0,void 0,function(){var e,r,i,n,s,a,o,l,h,u,c,f;return S(this,function(t){switch(t.label){case 0:return e=parseFloat,(u=this.element.getAttribute("href")||this.element.getAttribute("xlink:href"))?(r=u.substring(1),i=p.refsHandler.get(r),n=m(i.element,"symbol,svg")&&i.element.hasAttribute("viewBox"),s=e(v(this.element,p.styleSheets,"x")||"0"),a=e(v(this.element,p.styleSheets,"y")||"0"),l=o=void 0,h=n?(o=e(v(this.element,p.styleSheets,"width")||v(i.element,p.styleSheets,"width")||"0"),l=e(v(this.element,p.styleSheets,"height")||v(i.element,p.styleSheets,"height")||"0"),s+=e(v(i.element,p.styleSheets,"x")||"0"),a+=e(v(i.element,p.styleSheets,"y")||"0"),u=M(i.element.getAttribute("viewBox")),yt(i.element,u,s,a,o,l,p)):p.pdf.Matrix(1,0,0,1,s,a),c=new g(p.pdf,{refsHandler:p.refsHandler,styleSheets:p.styleSheets,withinUse:!0,viewport:n?new Qt(o,l):p.viewport,svg2pdfParameters:p.svg2pdfParameters}),f=p.attributeState.color,[4,p.refsHandler.getRendered(r,f,function(t){return A.renderReferencedNode(t,r,f,c)})]):[2];case 1:return t.sent(),p.pdf.saveGraphicsState(),p.pdf.setCurrentTransformationMatrix(p.transform),n&&"visible"!==v(i.element,p.styleSheets,"overflow")&&(p.pdf.rect(s,a,o,l),p.pdf.clip().discardPath()),p.pdf.doFormObject(p.refsHandler.generateKey(r,f),h),p.pdf.restoreGraphicsState(),[2]}})})},A.renderReferencedNode=function(r,i,n,s){return d(this,void 0,void 0,function(){var e;return S(this,function(t){switch(t.label){case 0:return e=[(e=r.getBoundingBox(s))[0]-.5*e[2],e[1]-.5*e[3],2*e[2],2*e[3]],s.attributeState.color=n,s.pdf.beginFormObject(e[0],e[1],e[2],e[3],s.pdf.unitMatrix),r instanceof ie?[4,r.apply(s)]:[3,2];case 1:return t.sent(),[3,4];case 2:return[4,r.render(s)];case 3:t.sent(),t.label=4;case 4:return s.pdf.endFormObject(s.refsHandler.generateKey(i,n)),[2]}})})},A.prototype.getBoundingBoxCore=function(t){return mt(this.element,t)},A.prototype.isVisible=function(t,e){return s(this,t,e)},A.prototype.computeNodeTransformCore=function(t){return t.pdf.unitMatrix},A),se=(e(ue,Zt=l),ue.prototype.getPath=function(t){var e=parseFloat(v(this.element,t.styleSheets,"width")||"0"),r=parseFloat(v(this.element,t.styleSheets,"height")||"0");if(!isFinite(e)||e<=0||!isFinite(r)||r<=0)return null;var i=v(this.element,t.styleSheets,"rx"),n=v(this.element,t.styleSheets,"ry"),s=Math.min(parseFloat(i||n||"0"),.5*e),n=Math.min(parseFloat(n||i||"0"),.5*r),i=parseFloat(v(this.element,t.styleSheets,"x")||"0"),t=parseFloat(v(this.element,t.styleSheets,"y")||"0"),a=4/3*(Math.SQRT2-1);return(0===s&&0===n?(new st).moveTo(i,t).lineTo(i+e,t).lineTo(i+e,t+r).lineTo(i,t+r):(new st).moveTo(i+=s,t).lineTo(i+=e-2*s,t).curveTo(i+s*a,t,i+s,t+(n-n*a),i+=s,t+=n).lineTo(i,t+=r-2*n).curveTo(i,t+n*a,i-s*a,t+n,i-=s,t+=n).lineTo(i+=2*s-e,t).curveTo(i-s*a,t,i-s,t-n*a,i-=s,t-=n).lineTo(i,t+=2*n-r).curveTo(i,t-n*a,i+s*a,t-n,i+=s,t-=n)).close()},ue.prototype.computeNodeTransformCore=function(t){return t.pdf.unitMatrix},ue.prototype.isVisible=function(t,e){return s(this,t,e)},ue),ae=(e(he,Kt=l),he.prototype.getPath=function(t){var e=this.getRx(t),r=this.getRy(t);if(!isFinite(e)||r<=0||!isFinite(r)||r<=0)return null;var i=parseFloat(v(this.element,t.styleSheets,"cx")||"0"),t=parseFloat(v(this.element,t.styleSheets,"cy")||"0"),n=4/3*(Math.SQRT2-1)*e,s=4/3*(Math.SQRT2-1)*r;return(new st).moveTo(i+e,t).curveTo(i+e,t-s,i+n,t-r,i,t-r).curveTo(i-n,t-r,i-e,t-s,i-e,t).curveTo(i-e,t+s,i-n,t+r,i,t+r).curveTo(i+n,t+r,i+e,t+s,i+e,t)},he.prototype.computeNodeTransformCore=function(t){return t.pdf.unitMatrix},he.prototype.isVisible=function(t,e){return s(this,t,e)},he),oe=(e(le,$t=ae),le.prototype.getRx=function(t){return parseFloat(v(this.element,t.styleSheets,"rx")||"0")},le.prototype.getRy=function(t){return parseFloat(v(this.element,t.styleSheets,"ry")||"0")},le);function le(t,e){return $t.call(this,t,e)||this}function he(t,e){return Kt.call(this,!1,t,e)||this}function ue(t,e){return Zt.call(this,!1,t,e)||this}function A(){return null!==Jt&&Jt.apply(this,arguments)||this}function ce(){return null!==te&&te.apply(this,arguments)||this}function fe(t,e){return ee.call(this,!0,t,e)||this}function pe(t){var e="invisible";return t.fill&&t.stroke?e="fillThenStroke":t.fill?e="fill":t.stroke&&(e="stroke"),e}function de(t){return t.replace(/[\n\r]/g,"")}function ge(t){return t.replace(/[\t]/g," ")}function me(t){return t.replace(/ +/g," ")}function ye(t,e,r){switch(v(t,r.styleSheets,"text-transform")){case"uppercase":return e.toUpperCase();case"lowercase":return e.toLowerCase();default:return e}}T.prototype.setX=function(t){this.originX=t},T.prototype.setY=function(t){this.originY=t},T.prototype.add=function(t,e,r){this.texts.push(e),this.textNodes.push(t),this.contexts.push(r)},T.prototype.rightTrimText=function(){for(var t=this.texts.length-1;0<=t;t--)if("default"===this.contexts[t].attributeState.xmlSpace&&(this.texts[t]=this.texts[t].replace(/\s+$/,"")),this.texts[t].match(/[^\s]/))return!1;return!0},T.prototype.measureText=function(t){for(var e=0;e<this.texts.length;e++)this.textMeasures.push({width:t.textMeasure.measureTextWidth(this.texts[e],this.contexts[e].attributeState),length:this.texts[e].length})},T.prototype.put=function(t,e){for(var r=[],i=[],n=[],s=this.originX,a=this.originY,o=s,l=s,h=0;h<this.textNodes.length;h++){var u,c=this.textNodes[h],f=this.contexts[h],p=this.textMeasures[h]||{width:t.textMeasure.measureTextWidth(this.texts[h],this.contexts[h].attributeState),length:this.texts[h].length},d=s,g=a;"#text"===c.nodeName||r.includes(c)||(r.push(c),null!==(u=c.getAttribute("dx"))&&(d+=k(u,f.attributeState.fontSize)),null!==(u=c.getAttribute("dy"))&&(g+=k(u,f.attributeState.fontSize))),i[h]=d,n[h]=g,s=d+p.width+p.length*e,a=g,o=Math.min(o,d),l=Math.max(l,s)}var m,y,b=0;switch(this.textAnchor){case"start":b=0;break;case"middle":b=(l-o)/2;break;case"end":b=l-o}for(h=0;h<this.textNodes.length;h++)c=this.textNodes[h],f=this.contexts[h],"#text"!==c.nodeName&&"hidden"===f.attributeState.visibility||(t.pdf.saveGraphicsState(),qt(f,t,c),m=f.attributeState.alignmentBaseline,y=pe(f.attributeState),t.pdf.text(this.texts[h],i[h]-b,n[h],{baseline:ht(m),angle:t.transform,renderingMode:"fill"===y?void 0:y,charSpace:0===e?void 0:e}),t.pdf.restoreGraphicsState());return[s,a]};var be,xe=T,ve=(e(F,be=Ut),F.prototype.processTSpans=function(t,e,r,i,n,s){for(var a=r.pdf.getFontSize(),o=r.attributeState.xmlSpace,l=!0,h=!1,u=0;u<e.childNodes.length;u++){var c,f,p=e.childNodes[u];p.textContent&&(f=p.textContent,"#text"===p.nodeName?(c=ge(c=de(f)),"default"===o&&(c=me(c),l&&c.match(/^\s/)&&(h=!0),c.match(/[^\s]/)&&(l=!1),s.prevText.match(/\s$/)&&(c=c.replace(/^\s+/,""))),c=ye(e,c,r),n.add(e,c,r),s.prevText=f,s.prevContext=r):m(p,"title")||m(p,"tspan")&&(null!==(f=(c=p).getAttribute("x"))&&(p=k(f,a),n=new xe(this,v(c,r.styleSheets,"text-anchor")||r.attributeState.textAnchor,p,0),i.push({type:"y",chunk:n})),null!==(f=c.getAttribute("y"))&&(p=k(f,a),n=new xe(this,v(c,r.styleSheets,"text-anchor")||r.attributeState.textAnchor,0,p),i.push({type:"x",chunk:n})),Dt(f=r.clone(),t,c),this.processTSpans(t,c,f,i,n,s)))}return h},F.prototype.renderCore=function(v){return d(this,void 0,void 0,function(){var i,n,s,a,o,l,h,u,c,f,p,d,g,m,y,b,x;return S(this,function(t){if(v.pdf.saveGraphicsState(),n=0,s=1,h=v.pdf.getFontSize(),a=k(this.element.getAttribute("x"),h),o=k(this.element.getAttribute("y"),h),l=k(this.element.getAttribute("dx"),h),h=k(this.element.getAttribute("dy"),h),u=parseFloat(this.element.getAttribute("textLength")||"0"),d=v.attributeState.visibility,0===this.element.childElementCount)c=this.element.textContent||"",e=c,r=v.attributeState,e=ge(e=de(e)),g=e="default"===r.xmlSpace?me(e=e.trim()):e,g=ye(this.element,g,v),i=v.textMeasure.getTextOffset(g,v.attributeState),0<u&&(f=v.textMeasure.measureTextWidth(g,v.attributeState),"default"===v.attributeState.xmlSpace&&c.match(/^\s/)&&(s=0),n=(u-f)/(g.length-s)||0),"visible"===d&&(c=v.attributeState.alignmentBaseline,f=pe(v.attributeState),v.pdf.text(g,a+l-i,o+h,{baseline:ht(c),angle:v.transform,renderingMode:"fill"===f?void 0:f,charSpace:0===n?void 0:n}));else{for(p=[],d=new xe(this,v.attributeState.textAnchor,a+l,o+h),p.push({type:"",chunk:d}),g=this.processTSpans(this,this.element,v,p,d,{prevText:" ",prevContext:v}),s=g?0:1,m=!0,y=p.length-1;0<=y;y--)m=m&&p[y].chunk.rightTrimText();0<u&&(x=b=0,p.forEach(function(t){t=t.chunk;t.measureText(v),t.textMeasures.forEach(function(t){var e=t.width,t=t.length;b+=e,x+=t})}),n=(u-b)/(x-s)),p.reduce(function(t,e){var r=e.type,e=e.chunk;return"x"===r?e.setX(t[0]):"y"===r&&e.setY(t[1]),e.put(v,n)},[0,0])}var e,r;return v.pdf.restoreGraphicsState(),[2]})})},F.prototype.isVisible=function(t,e){return a(this,t,e)},F.prototype.getBoundingBoxCore=function(t){return mt(this.element,t)},F.prototype.computeNodeTransformCore=function(t){return t.pdf.unitMatrix},F),Se={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0},we=[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279];function F(){return null!==be&&be.apply(this,arguments)||this}function T(t,e,r,i){this.textNode=t,this.texts=[],this.textNodes=[],this.contexts=[],this.textAnchor=e,this.originX=r,this.originY=i,this.textMeasures=[]}function ke(t){return 48<=t&&t<=57}function Me(t){this.index=0,this.path=t,this.max=t.length,this.result=[],this.param=0,this.err="",this.segmentStart=0,this.data=[]}function Ce(t){for(;t.index<t.max&&(10===(e=t.path.charCodeAt(t.index))||13===e||8232===e||8233===e||32===e||9===e||11===e||12===e||160===e||5760<=e&&0<=we.indexOf(e));)t.index++;var e}function Ae(t){var e,r=(e=t.path[t.segmentStart]).toLowerCase(),i=t.data;if("m"===r&&2<i.length&&(t.result.push([e,i[0],i[1]]),i=i.slice(2),r="l",e="m"===e?"l":"L"),"r"===r)t.result.push([e].concat(i));else for(;i.length>=Se[r]&&(t.result.push([e].concat(i.splice(0,Se[r]))),Se[r]););}function Fe(t){var e,r,i,n,s,a,o,l,h=t.max;if(t.segmentStart=t.index,r=97==(32|(e=t.path.charCodeAt(t.index))),function(){switch(32|e){case 109:case 122:case 108:case 104:case 118:case 99:case 115:case 113:case 116:case 97:case 114:return 1}}())if(n=Se[t.path[t.index].toLowerCase()],t.index++,Ce(t),t.data=[],n){for(i=!1;;){for(s=n;0<s;s--){if(!r||3!==s&&4!==s?function(t){var e,r,i=t.index,n=i,s=t.max,a=!1,o=!1,l=!1;if(s<=n)t.err="SvgPath: missed param (at pos "+n+")";else if(ke(e=43!==(e=t.path.charCodeAt(n))&&45!==e?e:++n<s?t.path.charCodeAt(n):0)||46===e){if(46!==e){if(r=48===e,e=++n<s?t.path.charCodeAt(n):0,r&&n<s&&e&&ke(e))return t.err="SvgPath: numbers started with `0` such as `09` are illegal (at pos "+i+")";for(;n<s&&ke(t.path.charCodeAt(n));)n++,a=!0;e=n<s?t.path.charCodeAt(n):0}if(46===e){for(l=!0,n++;ke(t.path.charCodeAt(n));)n++,o=!0;e=n<s?t.path.charCodeAt(n):0}if(101===e||69===e){if(l&&!a&&!o)return t.err="SvgPath: invalid float exponent (at pos "+n+")";if(43!==(e=++n<s?t.path.charCodeAt(n):0)&&45!==e||n++,!(n<s&&ke(t.path.charCodeAt(n))))return t.err="SvgPath: invalid float exponent (at pos "+n+")";for(;n<s&&ke(t.path.charCodeAt(n));)n++}t.index=n,t.param=parseFloat(t.path.slice(i,n))+0}else t.err="SvgPath: param should start with 0..9 or `.` (at pos "+n+")"}(t):(l=void 0,48===(l=(o=t).path.charCodeAt(o.index))?(o.param=0,o.index++):49===l?(o.param=1,o.index++):o.err="SvgPath: arc flag can be 0 or 1 only (at pos "+o.index+")"),t.err.length)return;t.data.push(t.param),Ce(t),i=!1,t.index<h&&44===t.path.charCodeAt(t.index)&&(t.index++,Ce(t),i=!0)}if(!i){if(t.index>=t.max)break;if(!(48<=(a=t.path.charCodeAt(t.index))&&a<=57||43===a||45===a||46===a))break}}Ae(t)}else Ae(t);else t.err="SvgPath: bad command "+t.path[t.index]+" (at pos "+t.index+")"}function P(){if(!(this instanceof P))return new P;this.queue=[],this.cache=null}P.prototype.matrix=function(t){return 1===t[0]&&0===t[1]&&0===t[2]&&1===t[3]&&0===t[4]&&0===t[5]||(this.cache=null,this.queue.push(t)),this},P.prototype.translate=function(t,e){return 0===t&&0===e||(this.cache=null,this.queue.push([1,0,0,1,t,e])),this},P.prototype.scale=function(t,e){return 1===t&&1===e||(this.cache=null,this.queue.push([t,0,0,e,0,0])),this},P.prototype.rotate=function(t,e,r){var i;return 0!==t&&(this.translate(e,r),t=t*Math.PI/180,i=Math.cos(t),t=Math.sin(t),this.queue.push([i,t,-t,i,0,0]),this.cache=null,this.translate(-e,-r)),this},P.prototype.skewX=function(t){return 0!==t&&(this.cache=null,this.queue.push([1,0,Math.tan(t*Math.PI/180),1,0,0])),this},P.prototype.skewY=function(t){return 0!==t&&(this.cache=null,this.queue.push([1,Math.tan(t*Math.PI/180),0,1,0,0])),this},P.prototype.toArray=function(){if(this.cache)return this.cache;if(!this.queue.length)return this.cache=[1,0,0,1,0,0],this.cache;if(this.cache=this.queue[0],1===this.queue.length)return this.cache;for(var t,e,r=1;r<this.queue.length;r++)this.cache=(t=this.cache,e=this.queue[r],[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]);return this.cache},P.prototype.calc=function(t,e,r){var i;return this.queue.length?(this.cache||(this.cache=this.toArray()),[t*(i=this.cache)[0]+e*i[2]+(r?0:i[4]),t*i[1]+e*i[3]+(r?0:i[5])]):[t,e]};var B=P,Te={matrix:!0,scale:!0,rotate:!0,translate:!0,skewX:!0,skewY:!0},Pe=/\s*(matrix|translate|scale|rotate|skewX|skewY)\s*\(\s*(.+?)\s*\)[\s,]*/,Be=/[\s,]+/,Ne=2*Math.PI;function Le(t,e,r,i){var n=t*r+e*i;return(n=1<n?1:n)<-1&&(n=-1),(t*i-e*r<0?-1:1)*Math.acos(n)}function Ee(t,e,r,i,n,s,a,o,l){var h=Math.sin(l*Ne/360),u=Math.cos(l*Ne/360),c=-h*(t-r)/2+u*(e-i)/2;if(0==(l=u*(t-r)/2+h*(e-i)/2)&&0==c)return[];if(0===a||0===o)return[];a=Math.abs(a),o=Math.abs(o);1<(l=l*l/(a*a)+c*c/(o*o))&&(a*=Math.sqrt(l),o*=Math.sqrt(l)),c=n,l=s,(v=(s=(n=a)*n)*(y=(f=o)*f)-s*(x=(m=-(p=h)*((t=t)-(r=r))/2+(d=u)*((e=e)-(i=i))/2)*m)-y*(b=(g=d*(t-r)/2+p*(e-i)/2)*g))<0&&(v=0),v/=s*x+y*b,s=(v=Math.sqrt(v)*(c===l?-1:1))*n/f*m,y=d*s-p*(x=v*-f/n*g)+(t+r)/2,b=p*s+d*x+(e+i)/2,t=(-g-s)/n,r=(-m-x)/f,p=Le(1,0,c=(g-s)/n,v=(m-x)/f),d=Le(c,v,t,r),0===l&&0<d&&(d-=Ne),1===l&&d<0&&(d+=Ne);var f,p,d,g,m,y,b,x,v,S=[y,b,p,d],w=[],k=S[2],M=S[3],C=Math.max(Math.ceil(Math.abs(M)/(Ne/4)),1);M/=C;for(var A,F,T,P,B,N,L=0;L<C;L++)w.push((A=k,F=M,N=B=P=T=void 0,T=4/3*Math.tan(F/4),P=Math.cos(A),B=Math.sin(A),N=Math.cos(A+F),A=Math.sin(A+F),[P,B,P-B*T,B+P*T,N+A*T,A-N*T,N,A])),k+=M;return w.map(function(t){for(var e=0;e<t.length;e+=2){var r=t[e+0],i=t[e+1],n=u*(r*=a)-h*(i*=o),r=h*r+u*i;t[e+0]=n+S[0],t[e+1]=r+S[1]}return t})}var Oe=Math.PI/180;function Ie(t,e,r){if(!(this instanceof Ie))return new Ie(t,e,r);this.rx=t,this.ry=e,this.ax=r}Ie.prototype.transform=function(t){var e=Math.cos(this.ax*Oe),r=Math.sin(this.ax*Oe),r=[this.rx*(t[0]*e+t[2]*r),this.rx*(t[1]*e+t[3]*r),this.ry*(-t[0]*r+t[2]*e),this.ry*(-t[1]*r+t[3]*e)],t=r[0]*r[0]+r[2]*r[2],e=r[1]*r[1]+r[3]*r[3],i=((r[0]-r[3])*(r[0]-r[3])+(r[2]+r[1])*(r[2]+r[1]))*((r[0]+r[3])*(r[0]+r[3])+(r[2]-r[1])*(r[2]-r[1])),n=(t+e)/2;if(i<1e-10*n)return this.rx=this.ry=Math.sqrt(n),this.ax=0,this;var r=r[0]*r[1]+r[2]*r[3],s=n+(i=Math.sqrt(i))/2,n=n-i/2;return this.ax=Math.abs(r)<1e-10&&Math.abs(s-e)<1e-10?90:180*Math.atan(Math.abs(r)>Math.abs(s-e)?(s-t)/r:r/(s-e))/Math.PI,0<=this.ax?(this.rx=Math.sqrt(s),this.ry=Math.sqrt(n)):(this.ax+=90,this.rx=Math.sqrt(n),this.ry=Math.sqrt(s)),this},Ie.prototype.isDegenerate=function(){return this.rx<1e-10*this.ry||this.ry<1e-10*this.rx};var _e=Ie;function N(r){if(!(this instanceof N))return new N(r);var t=function(){var t=new Me(r),e=t.max;for(Ce(t);t.index<e&&!t.err.length;)Fe(t);return t.err.length?t.result=[]:t.result.length&&("mM".indexOf(t.result[0][0])<0?(t.err="SvgPath: string should start with `M` or `m`",t.result=[]):t.result[0][0]="M"),{err:t.err,segments:t.result}}();this.segments=t.segments,this.err=t.err,this.__stack=[]}N.from=function(t){if("string"==typeof t)return new N(t);var e;if(t instanceof N)return(e=new N("")).err=t.err,e.segments=t.segments.map(function(t){return t.slice()}),e.__stack=t.__stack.map(function(t){return B().matrix(t.toArray())}),e;throw new Error("SvgPath.from: invalid param type "+t)},N.prototype.__matrix=function(h){var u,c=this;h.queue.length&&this.iterate(function(t,e,r,i){var n,s,a;switch(t[0]){case"v":s=0===(n=h.calc(0,t[1],!0))[0]?["v",n[1]]:["l",n[0],n[1]];break;case"V":s=(n=h.calc(r,t[1],!1))[0]===h.calc(r,i,!1)[0]?["V",n[1]]:["L",n[0],n[1]];break;case"h":s=0===(n=h.calc(t[1],0,!0))[1]?["h",n[0]]:["l",n[0],n[1]];break;case"H":s=(n=h.calc(t[1],i,!1))[1]===h.calc(r,i,!1)[1]?["H",n[0]]:["L",n[0],n[1]];break;case"a":case"A":var o=h.toArray(),l=_e(t[1],t[2],t[3]).transform(o);if(o[0]*o[3]-o[1]*o[2]<0&&(t[5]=t[5]?"0":"1"),n=h.calc(t[6],t[7],"a"===t[0]),"A"===t[0]&&t[6]===r&&t[7]===i||"a"===t[0]&&0===t[6]&&0===t[7]){s=["a"===t[0]?"l":"L",n[0],n[1]];break}s=l.isDegenerate()?["a"===t[0]?"l":"L",n[0],n[1]]:[t[0],l.rx,l.ry,l.ax,t[4],t[5],n[0],n[1]];break;case"m":s=["m",(n=h.calc(t[1],t[2],a=0<e))[0],n[1]];break;default:for(s=[o=t[0]],a=o.toLowerCase()===o,u=1;u<t.length;u+=2)n=h.calc(t[u],t[u+1],a),s.push(n[0],n[1])}c.segments[e]=s},!0)},N.prototype.__evaluateStack=function(){var t,e;if(this.__stack.length){if(1===this.__stack.length)return this.__matrix(this.__stack[0]),void(this.__stack=[]);for(t=B(),e=this.__stack.length;0<=--e;)t.matrix(this.__stack[e].toArray());this.__matrix(t),this.__stack=[]}},N.prototype.toString=function(){var t,e=[];this.__evaluateStack();for(var r=0;r<this.segments.length;r++)t=this.segments[r][0],t=0<r&&"m"!==t&&"M"!==t&&t===this.segments[r-1][0],e=e.concat(t?this.segments[r].slice(1):this.segments[r]);return e.join(" ").replace(/ ?([achlmqrstvz]) ?/gi,"$1").replace(/ \-/g,"-").replace(/zm/g,"z m")},N.prototype.translate=function(t,e){return this.__stack.push(B().translate(t,e||0)),this},N.prototype.scale=function(t,e){return this.__stack.push(B().scale(t,e||0===e?e:t)),this},N.prototype.rotate=function(t,e,r){return this.__stack.push(B().rotate(t,e||0,r||0)),this},N.prototype.skewX=function(t){return this.__stack.push(B().skewX(t)),this},N.prototype.skewY=function(t){return this.__stack.push(B().skewY(t)),this},N.prototype.matrix=function(t){return this.__stack.push(B().matrix(t)),this},N.prototype.transform=function(t){return t.trim()&&this.__stack.push((t=t,i=new B,t.split(Pe).forEach(function(t){if(t.length)if(void 0===Te[t])switch(r=t.split(Be).map(function(t){return+t||0}),e){case"matrix":return void(6===r.length&&i.matrix(r));case"scale":return void(1===r.length?i.scale(r[0],r[0]):2===r.length&&i.scale(r[0],r[1]));case"rotate":return void(1===r.length?i.rotate(r[0],0,0):3===r.length&&i.rotate(r[0],r[1],r[2]));case"translate":return void(1===r.length?i.translate(r[0],0):2===r.length&&i.translate(r[0],r[1]));case"skewX":return void(1===r.length&&i.skewX(r[0]));case"skewY":return void(1===r.length&&i.skewY(r[0]))}else e=t}),i)),this;var e,r,i},N.prototype.round=function(i){var e,n=0,s=0,a=0,o=0;return i=i||0,this.__evaluateStack(),this.segments.forEach(function(r){var t=r[0].toLowerCase()===r[0];switch(r[0]){case"H":case"h":return t&&(r[1]+=a),a=r[1]-r[1].toFixed(i),void(r[1]=+r[1].toFixed(i));case"V":case"v":return t&&(r[1]+=o),o=r[1]-r[1].toFixed(i),void(r[1]=+r[1].toFixed(i));case"Z":case"z":return a=n,void(o=s);case"M":case"m":return t&&(r[1]+=a,r[2]+=o),a=r[1]-r[1].toFixed(i),o=r[2]-r[2].toFixed(i),n=a,s=o,r[1]=+r[1].toFixed(i),void(r[2]=+r[2].toFixed(i));case"A":case"a":return t&&(r[6]+=a,r[7]+=o),a=r[6]-r[6].toFixed(i),o=r[7]-r[7].toFixed(i),r[1]=+r[1].toFixed(i),r[2]=+r[2].toFixed(i),r[3]=+r[3].toFixed(i+2),r[6]=+r[6].toFixed(i),void(r[7]=+r[7].toFixed(i));default:return e=r.length,t&&(r[e-2]+=a,r[e-1]+=o),a=r[e-2]-r[e-2].toFixed(i),o=r[e-1]-r[e-1].toFixed(i),void r.forEach(function(t,e){e&&(r[e]=+r[e].toFixed(i))})}}),this},N.prototype.iterate=function(n,t){var e,r,i,s=this.segments,a={},o=!1,l=0,h=0,u=0,c=0;if(t||this.__evaluateStack(),s.forEach(function(t,e){var r=n(t,e,l,h),i=(Array.isArray(r)&&(a[e]=r,o=!0),t[0]===t[0].toLowerCase());switch(t[0]){case"m":case"M":return l=t[1]+(i?l:0),h=t[2]+(i?h:0),u=l,void(c=h);case"h":case"H":return void(l=t[1]+(i?l:0));case"v":case"V":return void(h=t[1]+(i?h:0));case"z":case"Z":return l=u,void(h=c);default:l=t[t.length-2]+(i?l:0),h=t[t.length-1]+(i?h:0)}}),!o)return this;for(i=[],e=0;e<s.length;e++)if(void 0!==a[e])for(r=0;r<a[e].length;r++)i.push(a[e][r]);else i.push(s[e]);return this.segments=i,this},N.prototype.abs=function(){return this.iterate(function(t,e,r,i){var n,s=t[0],a=s.toUpperCase();if(s!==a)switch(t[0]=a,s){case"v":return void(t[1]+=i);case"a":return t[6]+=r,void(t[7]+=i);default:for(n=1;n<t.length;n++)t[n]+=n%2?r:i}},!0),this},N.prototype.rel=function(){return this.iterate(function(t,e,r,i){var n,s=t[0],a=s.toLowerCase();if(s!==a&&(0!==e||"M"!==s))switch(t[0]=a,s){case"V":return void(t[1]-=i);case"A":return t[6]-=r,void(t[7]-=i);default:for(n=1;n<t.length;n++)t[n]-=n%2?r:i}},!0),this},N.prototype.unarc=function(){return this.iterate(function(t,e,r,i){var n,s=[],a=t[0];return"A"!==a&&"a"!==a?null:(a="a"===a?(n=r+t[6],i+t[7]):(n=t[6],t[7]),0===(r=Ee(r,i,n,a,t[4],t[5],t[1],t[2],t[3])).length?[["a"===t[0]?"l":"L",t[6],t[7]]]:(r.forEach(function(t){s.push(["C",t[2],t[3],t[4],t[5],t[6],t[7]])}),s))}),this},N.prototype.unshort=function(){var o,l,h,u,c,f=this.segments;return this.iterate(function(t,e,r,i){var n,s=t[0],a=s.toUpperCase();e&&("T"===a?(l="Q"===(h=f[e-1])[0]?(o=h[1]-r,h[2]-i):"q"===h[0]?(o=h[1]-h[3],h[2]-h[4]):o=0,u=-o,c=-l,(n="t"===s)||(u+=r,c+=i),f[e]=[n?"q":"Q",u,c,t[1],t[2]]):"S"===a&&(l="C"===(h=f[e-1])[0]?(o=h[3]-r,h[4]-i):"c"===h[0]?(o=h[3]-h[5],h[4]-h[6]):o=0,u=-o,c=-l,(n="s"===s)||(u+=r,c+=i),f[e]=[n?"c":"C",u,c,t[1],t[2],t[3],t[4]]))}),this};var He,De,qe,Ve,je,Re,We,Ge,Ue,ze,Ye,Xe,Qe=N,$e=(e(gr,Xe=l),gr.prototype.computeNodeTransformCore=function(t){return t.pdf.unitMatrix},gr.prototype.isVisible=function(t,e){return s(this,t,e)},gr.prototype.getPath=function(t){var n,s,t=new Qe(v(this.element,t.styleSheets,"d")||"").unshort().unarc().abs(),a=new st;return t.iterate(function(t){var e=t[0];switch(e){case"M":a.moveTo(t[1],t[2]);break;case"L":a.lineTo(t[1],t[2]);break;case"H":a.lineTo(t[1],s);break;case"V":a.lineTo(n,t[1]);break;case"C":a.curveTo(t[1],t[2],t[3],t[4],t[5],t[6]);break;case"Q":var r=tt([n,s],[t[1],t[2]]),i=tt([t[3],t[4]],[t[1],t[2]]);a.curveTo(r[0],r[1],i[0],i[1],t[3],t[4]);break;case"Z":a.close()}switch(e){case"M":case"L":n=t[1],s=t[2];break;case"H":n=t[1];break;case"V":s=t[1];break;case"C":n=t[5],s=t[6];break;case"Q":n=t[3],s=t[4]}}),a},gr),Ke=/^\s*data:(([^/,;]+\/[^/,;]+)(?:;([^,;=]+=[^,;=]+))?)?(?:;(base64))?,(.*\s*)$/i,Ze=(e(O,Ye=Ut),O.prototype.renderCore=function(h){return d(this,void 0,void 0,function(){var e,r,i,n,s,a,o,l;return S(this,function(t){switch(t.label){case 0:return this.imageLoadingPromise?(h.pdf.setCurrentTransformationMatrix(h.transform),e=parseFloat(v(this.element,h.styleSheets,"width")||"0"),r=parseFloat(v(this.element,h.styleSheets,"height")||"0"),i=parseFloat(v(this.element,h.styleSheets,"x")||"0"),n=parseFloat(v(this.element,h.styleSheets,"y")||"0"),!isFinite(e)||e<=0||!isFinite(r)||r<=0?[2]:[4,this.imageLoadingPromise]):[2];case 1:return a=t.sent(),s=a.data,0!==(a=a.format).indexOf("svg")?[3,3]:(l=new DOMParser,l=l.parseFromString(s,"image/svg+xml").firstElementChild,(o=this.element.getAttribute("preserveAspectRatio"))&&!(o.indexOf("defer")<0)&&l.getAttribute("preserveAspectRatio")||l.setAttribute("preserveAspectRatio",o||""),l.setAttribute("x",String(i)),l.setAttribute("y",String(n)),l.setAttribute("width",String(e)),l.setAttribute("height",String(r)),[4,mr(l,o={}).render(new g(h.pdf,{refsHandler:new Z(o),styleSheets:h.styleSheets,viewport:new Qt(e,r),svg2pdfParameters:h.svg2pdfParameters}))]);case 2:return t.sent(),[2];case 3:l="data:image/"+a+";base64,"+btoa(s);try{h.pdf.addImage(l,"",i,n,e,r)}catch(t){"object"==typeof console&&console.warn&&console.warn("Could not load image "+this.imageUrl+".\n"+t)}t.label=4;case 4:return[2]}})})},O.prototype.getBoundingBoxCore=function(t){return mt(this.element,t)},O.prototype.computeNodeTransformCore=function(t){return t.pdf.unitMatrix},O.prototype.isVisible=function(t,e){return s(this,t,e)},O.fetchImageData=function(n){return d(this,void 0,void 0,function(){var e,r,i;return S(this,function(t){switch(t.label){case 0:if(!(r=n.match(Ke)))return[3,1];if(i=r[2],"image"!==(i=i.split("/"))[0])throw new Error("Unsupported image URL: "+n);return i=i[1],e=r[5],e=("base64"===r[4]?atob:decodeURIComponent)(e),[3,3];case 1:return[4,O.fetchImage(n)];case 2:e=t.sent(),i=n.substring(n.lastIndexOf(".")+1),t.label=3;case 3:return[2,{data:e,format:i}]}})})},O.fetchImage=function(s){return new Promise(function(i,t){var n=new XMLHttpRequest;n.open("GET",s,!0),n.responseType="arraybuffer",n.onload=function(){if(200!==n.status)throw new Error("Error "+n.status+": Failed to load image '"+s+"'");for(var t=new Uint8Array(n.response),e="",r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);i(e)},n.onerror=t,n.onabort=t,n.send(null)})},O.getMimeType=function(t){switch(t=t.toLowerCase()){case"jpg":case"jpeg":return"image/jpeg";default:return"image/"+t}},O),Ut=(e(E,ze=l),E.prototype.getPath=function(t){if(!this.element.hasAttribute("points")||""===this.element.getAttribute("points"))return null;var e=E.parsePointsString(this.element.getAttribute("points")),r=new st;if(e.length<1)return r;r.moveTo(e[0][0],e[0][1]);for(var i=1;i<e.length;i++)r.lineTo(e[i][0],e[i][1]);return this.closed&&r.close(),r},E.prototype.isVisible=function(t,e){return s(this,t,e)},E.prototype.computeNodeTransformCore=function(t){return t.pdf.unitMatrix},E.parsePointsString=function(t){for(var e=M(t),r=[],i=0;i<e.length-1;i+=2){var n=e[i],s=e[i+1];r.push([n,s])}return r},E),Je=(e(dr,Ue=Ut),dr),tr=(e(pr,Ge=t),pr.prototype.render=function(t){return Promise.resolve()},pr.prototype.getBoundingBoxCore=function(t){return[0,0,0,0]},pr.prototype.computeNodeTransformCore=function(t){return t.pdf.unitMatrix},pr.prototype.isVisible=function(t,e){return s(this,t,e)},pr),er=(e(fr,We=Mt),fr.prototype.apply=function(h){return d(this,void 0,void 0,function(){var a,o,l;return S(this,function(t){switch(t.label){case 0:o=this.computeNodeTransform(h),a=this.getBoundingBox(h),h.pdf.beginFormObject(a[0],a[1],a[2],a[3],o),e=a=new g(h.pdf,{refsHandler:h.refsHandler,styleSheets:h.styleSheets,viewport:h.viewport,svg2pdfParameters:h.svg2pdfParameters}),r=e.attributeState,e=e.pdf,n=i=1,i=(i*=r.fillOpacity)*r.opacity,r.fill instanceof c&&void 0!==r.fill.color.a&&(i*=r.fill.color.a),n=(n*=r.strokeOpacity)*r.opacity,r.stroke instanceof c&&void 0!==r.stroke.color.a&&(n*=r.stroke.color.a),(s={}).opacity=i,s["stroke-opacity"]=n,e.setGState(new u.GState(s)),r.fill&&r.fill instanceof c&&r.fill.color.ok?e.setFillColor(r.fill.color.r,r.fill.color.g,r.fill.color.b):e.setFillColor(0,0,0),e.setLineWidth(r.strokeWidth),r.stroke instanceof c?e.setDrawColor(r.stroke.color.r,r.stroke.color.g,r.stroke.color.b):e.setDrawColor(0,0,0),e.setLineCap(r.strokeLinecap),e.setLineJoin(r.strokeLinejoin),r.strokeDasharray?e.setLineDashPattern(r.strokeDasharray,r.strokeDashoffset):e.setLineDashPattern([],0),e.setLineMiterLimit(r.strokeMiterlimit),i=p.hasOwnProperty(r.fontFamily)?p[r.fontFamily]:r.fontFamily,r.fill&&r.fill instanceof c&&r.fill.color.ok?(n=r.fill.color,e.setTextColor(n.r,n.g,n.b)):e.setTextColor(0,0,0),s="","bold"===r.fontWeight&&(s="bold"),"italic"===r.fontStyle&&(s+="italic"),""===s&&(s="normal"),void 0!==i||void 0!==s?(void 0===i&&(i=p.hasOwnProperty(r.fontFamily)?p[r.fontFamily]:r.fontFamily),e.setFont(i,s)):e.setFont("helvetica",s),e.setFontSize(r.fontSize*e.internal.scaleFactor),o=0,l=this.children,t.label=1;case 1:return o<l.length?[4,l[o].render(a)]:[3,4];case 2:t.sent(),t.label=3;case 3:return o++,[3,1];case 4:return h.pdf.endFormObject(this.element.getAttribute("id")),[2]}var e,r,i,n,s})})},fr.prototype.getBoundingBoxCore=function(t){var e,r=this.element.getAttribute("viewBox");return[(e=r?M(r):e)&&e[0]||0,e&&e[1]||0,e&&e[2]||parseFloat(this.element.getAttribute("markerWidth")||"3"),e&&e[3]||parseFloat(this.element.getAttribute("markerHeight")||"3")]},fr.prototype.computeNodeTransformCore=function(t){var e,r=parseFloat(this.element.getAttribute("refX")||"0"),i=parseFloat(this.element.getAttribute("refY")||"0"),n=this.element.getAttribute("viewBox");return e=n?(n=M(n),e=yt(this.element,n,0,0,parseFloat(this.element.getAttribute("markerWidth")||"3"),parseFloat(this.element.getAttribute("markerHeight")||"3"),t,!0),t.pdf.matrixMult(t.pdf.Matrix(1,0,0,1,-r,-i),e)):t.pdf.Matrix(1,0,0,1,-r,-i)},fr.prototype.isVisible=function(t,e){return a(this,t,e)},fr),rr=(e(cr,Re=ae),cr.prototype.getR=function(t){var e;return null!=(e=this.r)?e:this.r=parseFloat(v(this.element,t.styleSheets,"r")||"0")},cr.prototype.getRx=function(t){return this.getR(t)},cr.prototype.getRy=function(t){return this.getR(t)},cr),ir=(e(ur,je=Ut),ur),l=(e(hr,Ve=Ct),hr.prototype.renderCore=function(i){return d(this,void 0,void 0,function(){var e,r;return S(this,function(t){switch(t.label){case 0:e=0,r=this.children,t.label=1;case 1:return e<r.length?[4,r[e].render(i)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})},hr.prototype.getBoundingBoxCore=function(t){return gt(t,this)},hr),nr=(e(L,qe=l),L.prototype.isVisible=function(t,e){return a(this,t,e)},L.prototype.render=function(a){return d(this,void 0,void 0,function(){var e,r,i,n,s;return S(this,function(t){switch(t.label){case 0:return this.isVisible("hidden"!==a.attributeState.visibility,a)?(e=this.getX(a),r=this.getY(a),i=this.getWidth(a),n=this.getHeight(a),a.pdf.saveGraphicsState(),s=a.transform,this.element.hasAttribute("transform")&&(s=a.pdf.matrixMult(bt(this.element.getAttribute("transform"),a),s)),a.pdf.setCurrentTransformationMatrix(s),a.withinUse||"visible"===v(this.element,a.styleSheets,"overflow")||a.pdf.rect(e,r,i,n).clip().discardPath(),[4,qe.prototype.render.call(this,a.clone({transform:a.pdf.unitMatrix,viewport:a.withinUse?a.viewport:new Qt(i,n)}))]):[2];case 1:return t.sent(),a.pdf.restoreGraphicsState(),[2]}})})},L.prototype.computeNodeTransform=function(t){return this.computeNodeTransformCore(t)},L.prototype.computeNodeTransformCore=function(t){if(t.withinUse)return t.pdf.unitMatrix;var e,r,i=this.getX(t),n=this.getY(t),s=this.getViewBox();return s?(e=this.getWidth(t),r=this.getHeight(t),yt(this.element,s,i,n,e,r,t)):t.pdf.Matrix(1,0,0,1,i,n)},L.prototype.getWidth=function(t){if(void 0!==this.width)return this.width;var e,r,i=t.svg2pdfParameters;return r=this.isOutermostSvg(t)?null!=i.width?i.width:(e=v(this.element,t.styleSheets,"width"))?parseFloat(e):(r=this.getViewBox())&&(null!=i.height||v(this.element,t.styleSheets,"height"))?(i=r[2]/r[3],this.getHeight(t)*i):Math.min(300,t.viewport.width,2*t.viewport.height):(e=v(this.element,t.styleSheets,"width"))?parseFloat(e):t.viewport.width,this.width=r},L.prototype.getHeight=function(t){if(void 0!==this.height)return this.height;var e,r=t.svg2pdfParameters;return r=this.isOutermostSvg(t)?null!=r.height?r.height:(e=v(this.element,t.styleSheets,"height"))?parseFloat(e):(r=this.getViewBox())?(r=r[2]/r[3],this.getWidth(t)/r):Math.min(150,t.viewport.width/2,t.viewport.height):(e=v(this.element,t.styleSheets,"height"))?parseFloat(e):t.viewport.height,this.height=r},L.prototype.getX=function(t){if(void 0!==this.x)return this.x;if(this.isOutermostSvg(t))return this.x=0;t=v(this.element,t.styleSheets,"x");return this.x=t?parseFloat(t):0},L.prototype.getY=function(t){if(void 0!==this.y)return this.y;if(this.isOutermostSvg(t))return this.y=0;t=v(this.element,t.styleSheets,"y");return this.y=t?parseFloat(t):0},L.prototype.getViewBox=function(){if(void 0!==this.viewBox)return this.viewBox;var t=this.element.getAttribute("viewBox");return this.viewBox=t?M(t):void 0},L.prototype.isOutermostSvg=function(t){return t.svg2pdfParameters.element===this.element},L),sr=(e(lr,De=l),lr.prototype.isVisible=function(t,e){return a(this,t,e)},lr.prototype.computeNodeTransformCore=function(t){return t.pdf.unitMatrix},lr),ar=(e(or,He=Mt),or.prototype.apply=function(n){return d(this,void 0,void 0,function(){var e,r,i;return S(this,function(t){switch(t.label){case 0:if(!this.isVisible(!0,n))return[2];e=n.pdf.matrixMult(this.computeNodeTransform(n),n.transform),n.pdf.setCurrentTransformationMatrix(e),r=0,i=this.children,t.label=1;case 1:return r<i.length?[4,i[r].render(new g(n.pdf,{refsHandler:n.refsHandler,styleSheets:n.styleSheets,viewport:n.viewport,withinClipPath:!0,svg2pdfParameters:n.svg2pdfParameters}))]:[3,4];case 2:t.sent(),t.label=3;case 3:return r++,[3,1];case 4:return n.pdf.clip().discardPath(),n.pdf.setCurrentTransformationMatrix(e.inversed()),[2]}})})},or.prototype.getBoundingBoxCore=function(t){return gt(t,this)},or.prototype.isVisible=function(t,e){return a(this,t,e)},or);function or(){return null!==He&&He.apply(this,arguments)||this}function lr(){return null!==De&&De.apply(this,arguments)||this}function L(){return null!==qe&&qe.apply(this,arguments)||this}function hr(){return null!==Ve&&Ve.apply(this,arguments)||this}function ur(t,e){return je.call(this,!1,t,e)||this}function cr(t,e){return Re.call(this,t,e)||this}function fr(){return null!==We&&We.apply(this,arguments)||this}function pr(){return null!==Ge&&Ge.apply(this,arguments)||this}function dr(t,e){return Ue.call(this,!0,t,e)||this}function E(t,e,r){e=ze.call(this,!0,e,r)||this;return e.closed=t,e}function O(t,e){t=Ye.call(this,t,e)||this;return t.imageLoadingPromise=null,t.imageUrl=t.element.getAttribute("xlink:href")||t.element.getAttribute("href"),t.imageUrl&&(t.imageLoadingPromise=O.fetchImageData(t.imageUrl)),t}function gr(t,e){return Xe.call(this,!0,t,e)||this}function mr(t,s){var e,r,a=[];switch(function(t){for(var e,r=[],i=0;i<t.childNodes.length;i++){var n=t.childNodes[i];"#"!==n.nodeName.charAt(0)&&r.push(n)}for(i=0;i<r.length;i++)e=r[i],a.push(mr(e,s))}(t),t.tagName.toLowerCase()){case"a":case"g":e=new sr(t,a);break;case"circle":e=new rr(t,a);break;case"clippath":e=new ar(t,a);break;case"ellipse":e=new oe(t,a);break;case"lineargradient":e=new At(t,a);break;case"image":e=new Ze(t,a);break;case"line":e=new re(t,a);break;case"marker":e=new er(t,a);break;case"path":e=new $e(t,a);break;case"pattern":e=new Pt(t,a);break;case"polygon":e=new Je(t,a);break;case"polyline":e=new ir(t,a);break;case"radialgradient":e=new Ft(t,a);break;case"rect":e=new se(t,a);break;case"svg":e=new nr(t,a);break;case"symbol":e=new ie(t,a);break;case"text":e=new ve(t,a);break;case"use":e=new ne(t,a);break;default:e=new tr(t,a)}return null!=s&&e.element.hasAttribute("id")&&(r=K(e.element.id,{isIdentifier:!0}),s[r]=s[r]||e),e.children.forEach(function(t){return t.setParent(e)}),e}function yr(l){var h=l,u={a:0,b:0,c:0},c=[],t=function(t,e){var r,i,n,s,a,o;if(t.test(h))for(i=0,n=(r=h.match(t)).length;i<n;i+=1)u[e]+=1,s=r[i],a=h.indexOf(s),o=s.length,c.push({selector:l.substr(a,o),type:e,index:a,length:o}),h=h.replace(s,Array(o+1).join(" "))};(s=function(t){var e,r,i,n;if(t.test(h))for(r=0,i=(e=h.match(t)).length;r<i;r+=1)n=e[r],h=h.replace(n,Array(n.length+1).join("A"))})(/\\[0-9A-Fa-f]{6}\s?/g),s(/\\[0-9A-Fa-f]{1,5}\s/g),s(/\\./g);var e,r,i,n,s=/{[^]*/gm;if(s.test(h))for(r=0,i=(e=h.match(s)).length;r<i;r+=1)n=e[r],h=h.replace(n,Array(n.length+1).join(" "));return t(/(\[[^\]]+\])/g,"b"),t(/(#[^\#\s\+>~\.\[:\)]+)/g,"a"),t(/(\.[^\s\+>~\.\[:\)]+)/g,"b"),t(/(::[^\s\+>~\.\[:]+|:first-line|:first-letter|:before|:after)/gi,"c"),t(/(:(?!not|global|local)[\w-]+\([^\)]*\))/gi,"b"),t(/(:(?!not|global|local)[^\s\+>~\.\[:]+)/g,"b"),h=(h=(h=(h=(h=(h=h.replace(/[\*\s\+>~]/g," ")).replace(/[#\.]/g," ")).replace(/:not/g,"    ")).replace(/:local/g,"      ")).replace(/:global/g,"       ")).replace(/[\(\)]/g," "),t(/([^\s\+>~\.\[:]+)/g,"c"),c.sort(function(t,e){return t.index-e.index}),{selector:l,specificity:"0,"+u.a.toString()+","+u.b.toString()+","+u.c.toString(),specificityArray:[0,u.a,u.b,u.c],parts:c}}I.prototype.load=function(){return d(this,void 0,void 0,function(){var e;return S(this,function(t){switch(t.label){case 0:return[4,this.collectStyleSheetTexts()];case 1:return e=t.sent(),this.parseCssSheets(e),[2]}})})},I.prototype.collectStyleSheetTexts=function(){return d(this,void 0,void 0,function(){var e,r,i,n,s;return S(this,function(t){switch(t.label){case 0:if(e=[],this.loadExternalSheets&&this.rootSvg.ownerDocument)for(n=0;n<this.rootSvg.ownerDocument.childNodes.length;n++)"xml-stylesheet"===(r=this.rootSvg.ownerDocument.childNodes[n]).nodeName&&"string"==typeof r.data&&e.push(I.loadSheet(r.data.match(/href=["'].*?["']/)[0].split("=")[1].slice(1,-1)));for(i=this.rootSvg.querySelectorAll("style,link"),n=0;n<i.length;n++)m(s=i[n],"style")?e.push(s.textContent):this.loadExternalSheets&&m(s,"link")&&"stylesheet"===s.getAttribute("rel")&&s.hasAttribute("href")&&e.push(I.loadSheet(s.getAttribute("href")));return[4,Promise.all(e)];case 1:return[2,t.sent().filter(function(t){return null!==t})]}})})},I.prototype.parseCssSheets=function(t){for(var e=document.implementation.createHTMLDocument(""),r=0,i=t;r<i.length;r++){var n=i[r],s=e.createElement("style"),a=(s.textContent=n,e.body.appendChild(s),s.sheet);if(a instanceof CSSStyleSheet){for(var o=a.cssRules.length-1;0<=o;o--){var l=a.cssRules[o];if(l instanceof CSSStyleRule){if(0<=l.selectorText.indexOf(",")){a.deleteRule(o);for(var h=l.cssText.substring(l.selectorText.length),u=I.splitSelectorAtCommas(l.selectorText),c=0;c<u.length;c++)a.insertRule(u[c]+h,o+c)}}else a.deleteRule(o)}this.styleSheets.push(a)}}},I.splitSelectorAtCommas=function(t){for(var e,r=/,|["']/g,i=/[^\\]["]/g,n=/[^\\][']/g,s=[],a="initial",o=-1,l=i,h=0;h<t.length;)switch(a){case"initial":r.lastIndex=h,h=(e=r.exec(t))?(","===e[0]?(s.push(t.substring(o+1,r.lastIndex-1).trim()),o=r.lastIndex-1):(a="withinQuotes",l='"'===e[0]?i:n),r.lastIndex):(s.push(t.substring(o+1).trim()),t.length);break;case"withinQuotes":l.lastIndex=h,(e=l.exec(t))&&(h=l.lastIndex,a="initial")}return s},I.loadSheet=function(i){return new Promise(function(t,e){var r=new XMLHttpRequest;r.open("GET",i,!0),r.responseType="text",r.onload=function(){200!==r.status&&e(new Error("Error "+r.status+": Failed to load '"+i+"'")),t(r.responseText)},r.onerror=e,r.onabort=e,r.send(null)}).catch(function(){return null})},I.prototype.getPropertyValue=function(t,a){for(var e=[],r=0,i=this.styleSheets;r<i.length;r++)for(var n=i[r],s=0;s<n.cssRules.length;s++){var o=n.cssRules[s];o.style.getPropertyValue(a)&&t.matches(o.selectorText)&&e.push(o)}if(0!==e.length)return e.reduce(function(t,e){return 1===function(t,e){var r,i,n,s=t.style.getPropertyPriority(a);if(s!==e.style.getPropertyPriority(a))return"important"===s?1:-1;s=t.selectorText,t=e.selectorText;if("string"==typeof s){if(-1!==s.indexOf(","))throw"Invalid CSS selector";r=yr(s).specificityArray}else{if(!Array.isArray(s))throw"Invalid CSS selector or specificity array";if(4!==s.filter(function(t){return"number"==typeof t}).length)throw"Invalid specificity array";r=s}if("string"==typeof t){if(-1!==t.indexOf(","))throw"Invalid CSS selector";i=yr(t).specificityArray}else{if(!Array.isArray(t))throw"Invalid CSS selector or specificity array";if(4!==t.filter(function(t){return"number"==typeof t}).length)throw"Invalid specificity array";i=t}for(n=0;n<4;n+=1){if(r[n]<i[n])return-1;if(r[n]>i[n])return 1}return 0}(t,e)?t:e}).style.getPropertyValue(a)||void 0};var br=I;function I(t,e){this.rootSvg=t,this.loadExternalSheets=e,this.styleSheets=[]}function xr(l,h,u){var c;return void 0===u&&(u={}),d(this,void 0,void 0,function(){var e,r,i,n,s,a,o;return S(this,function(t){switch(t.label){case 0:return e=null!=(c=u.x)?c:0,r=null!=(c=u.y)?c:0,s=null!=(c=u.loadExternalStyleSheets)&&c,n=new Z(i={}),[4,(s=new br(l,s)).load()];case 1:return t.sent(),a=new Qt(h.internal.pageSize.getWidth(),h.internal.pageSize.getHeight()),o=D(D({},u),{element:l}),a=new g(h,{refsHandler:n,styleSheets:s,viewport:a,svg2pdfParameters:o}),h.advancedAPI(),h.saveGraphicsState(),h.setCurrentTransformationMatrix(h.Matrix(1,0,0,1,e,r)),h.setLineWidth(a.attributeState.strokeWidth),o=a.attributeState.fill.color,h.setFillColor(o.r,o.g,o.b),h.setFont(a.attributeState.fontFamily),h.setFontSize(a.attributeState.fontSize*h.internal.scaleFactor),[4,mr(l,i).render(a)];case 2:return t.sent(),h.restoreGraphicsState(),h.compatAPI(),a.textMeasure.cleanupTextMeasuring(),[2,h]}})})}u.jsPDF.API.svg=function(t,e){return xr(t,this,e=void 0===e?{}:e)},_.svg2pdf=xr,Object.defineProperty(_,"__esModule",{value:!0})});